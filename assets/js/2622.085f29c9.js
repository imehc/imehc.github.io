"use strict";(self.webpackChunkanch=self.webpackChunkanch||[]).push([["2622"],{17798(e,t,r){r.d(t,{A:()=>s});var n=r(46781),o=r(89466),i=r(4599);let s=function(e){if(!(0,o.A)(e))throw new i.A("uri is required.");let t=new n(e);t.normalize();let r=t.path(),s=r.lastIndexOf("/");return -1!==s&&(r=r.substr(s+1)),r}},2083(e,t,r){let n;r.d(t,{A:()=>eg});var o=r(33107),i=r(99600),s=r(6963),l=r(5678),a=r(97234),u=r(24089),c=r(89466),f=r(4599),p=r(91395),h=r(17798),d=r(34270),g=r(48070),y=r(55082);function w(){this._cache={}}w.prototype.fromColor=function(e,t){if(!(0,c.A)(e))throw new f.A("color is required");if(!(0,c.A)(t))throw new f.A("size is required");return C(void 0,void 0,e,t,this._cache)},w.prototype.fromUrl=function(e,t,r){if(!(0,c.A)(e))throw new f.A("url is required");if(!(0,c.A)(t))throw new f.A("color is required");if(!(0,c.A)(r))throw new f.A("size is required");return C(e,void 0,t,r,this._cache)},w.prototype.fromMakiIconId=function(e,t,r){if(!(0,c.A)(e))throw new f.A("id is required");if(!(0,c.A)(t))throw new f.A("color is required");if(!(0,c.A)(r))throw new f.A("size is required");return C((0,d.A)(`Assets/Textures/maki/${encodeURIComponent(e)}.png`),void 0,t,r,this._cache)},w.prototype.fromText=function(e,t,r){if(!(0,c.A)(e))throw new f.A("text is required");if(!(0,c.A)(t))throw new f.A("color is required");if(!(0,c.A)(r))throw new f.A("size is required");return C(void 0,e,t,r,this._cache)};let A=new s.A;function m(e,t,r){let n=r/2.5,o=n,i=n;t.width>t.height?i=n*(t.height/t.width):t.width<t.height&&(o=n*(t.width/t.height));let l=Math.round((r-o)/2),a=Math.round(7/24*r-i/2);e.globalCompositeOperation="destination-out",e.drawImage(t,l-1,a,o,i),e.drawImage(t,l,a-1,o,i),e.drawImage(t,l+1,a,o,i),e.drawImage(t,l,a+1,o,i),e.globalCompositeOperation="destination-over",e.fillStyle=s.A.BLACK.toCssColorString(),e.fillRect(l-1,a-1,o+2,i+2),e.globalCompositeOperation="destination-out",e.drawImage(t,l,a,o,i),e.globalCompositeOperation="destination-over",e.fillStyle=s.A.WHITE.toCssColorString(),e.fillRect(l-1,a-2,o+2,i+2)}let b=[,,,,];function C(e,t,r,n,o){b[0]=e,b[1]=t,b[2]=r,b[3]=n;let i=JSON.stringify(b),s=o[i];if((0,c.A)(s))return s;let l=document.createElement("canvas");l.width=n,l.height=n;let a=l.getContext("2d");if(a.save(),a.scale(n/24,n/24),a.fillStyle=r.toCssColorString(),a.strokeStyle=r.brighten(.6,A).toCssColorString(),a.lineWidth=.846,a.beginPath(),a.moveTo(6.72,.422),a.lineTo(17.28,.422),a.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415),a.lineTo(19.577,10.973),a.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966),a.lineTo(14.386,14.008),a.lineTo(11.826,23.578),a.lineTo(9.614,14.008),a.lineTo(6.719,13.965),a.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972),a.lineTo(4.422,3.416),a.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423),a.closePath(),a.fill(),a.stroke(),a.restore(),(0,c.A)(e)){let t=g.A.createIfNeeded(e).fetchImage().then(function(e){return m(a,e,n),o[i]=l,l});return o[i]=t,t}return(0,c.A)(t)&&m(a,(0,y.A)(t,{font:`bold ${n}px sans-serif`}),n),o[i]=l,l}var P=r(78238),k=r(58065),v=r(15424),_=r(31634);function L(e){return e}function T(e,t){var r=t.id,n=t.bbox,o=null==t.properties?{}:t.properties,i=function(e,t){var r=function(e){if(null==e)return L;var t,r,n=e.scale[0],o=e.scale[1],i=e.translate[0],s=e.translate[1];return function(e,l){l||(t=r=0);var a=2,u=e.length,c=Array(u);for(c[0]=(t+=e[0])*n+i,c[1]=(r+=e[1])*o+s;a<u;)c[a]=e[a],++a;return c}}(e.transform),n=e.arcs;function o(e){return r(e)}function i(e){for(var t=[],o=0,i=e.length;o<i;++o)!function(e,t){t.length&&t.pop();for(var o=n[e<0?~e:e],i=0,s=o.length;i<s;++i)t.push(r(o[i],i));e<0&&function(e,t){for(var r,n=e.length,o=n-t;o<--n;)r=e[o],e[o++]=e[n],e[n]=r}(t,s)}(e[o],t);return t.length<2&&t.push(t[0]),t}function s(e){for(var t=i(e);t.length<4;)t.push(t[0]);return t}function l(e){return e.map(s)}return function e(t){var r,n=t.type;switch(n){case"GeometryCollection":return{type:n,geometries:t.geometries.map(e)};case"Point":r=o(t.coordinates);break;case"MultiPoint":r=t.coordinates.map(o);break;case"LineString":r=i(t.arcs);break;case"MultiLineString":r=t.arcs.map(i);break;case"Polygon":r=l(t.arcs);break;case"MultiPolygon":r=t.arcs.map(l);break;default:return null}return{type:n,coordinates:r}}(t)}(e,t);return null==r&&null==n?{type:"Feature",properties:o,geometry:i}:null==n?{type:"Feature",id:r,properties:o,geometry:i}:{type:"Feature",id:r,bbox:n,properties:o,geometry:i}}var S=r(25464),O=r(60694),x=r(38377),U=r(38582),M=r(49441),E=r(13569),I=r(54525),F=r(30615),j=r(55497),G=r(32561);function $(e){return i.A.fromDegrees(e[0],e[1],e[2])}let B={"urn:ogc:def:crs:OGC:1.3:CRS84":$,"EPSG:4326":$,"urn:ogc:def:crs:EPSG::4326":$},D={},R={},z=48,N=s.A.ROYALBLUE,Z=s.A.YELLOW,q=2,V=s.A.fromBytes(255,255,0,100),W=!1,H={small:24,medium:48,large:64},J=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function Y(e,t){var r;let n;return new O.A((r=function e(t,r){let n="";for(let o in t)if(t.hasOwnProperty(o)){if(o===r||-1!==J.indexOf(o))continue;let i=t[o];(0,c.A)(i)&&("object"==typeof i?n+=`<tr><th>${o}</th><td>${e(i)}</td></tr>`:n+=`<tr><th>${o}</th><td>${i}</td></tr>`)}return n.length>0&&(n=`<table class="cesium-infoBox-defaultTable"><tbody>${n}</tbody></table>`),n},function(o,i){return(0,c.A)(n)||(n=r(e,t)),n}),!0)}function X(e,t,r){let n=e.id;if((0,c.A)(n)&&"Feature"===e.type){let e=2,r=n;for(;(0,c.A)(t.getById(r));)r=`${n}_${e}`,e++;n=r}else n=(0,l.A)();let o=t.getOrCreateEntity(n),i=e.properties;if((0,c.A)(i)){let e;o.properties=i;let t=i.title;if((0,c.A)(t))o.name=t,e="title";else{let t=Number.MAX_VALUE;for(let r in i)if(i.hasOwnProperty(r)&&i[r]){let n=r.toLowerCase();if(t>1&&"title"===n){t=1,e=r;break}t>2&&"name"===n?(t=2,e=r):t>3&&/title/i.test(r)?(t=3,e=r):t>4&&/name/i.test(r)&&(t=4,e=r)}(0,c.A)(e)&&(o.name=i[e])}let n=i.description;null!==n&&(o.description=(0,c.A)(n)?new M.A(n):r(i,e))}return o}function K(e,t){let r=Array(e.length);for(let n=0;n<e.length;n++)r[n]=t(e[n]);return r}let Q={Feature:et,FeatureCollection:function(e,t,r,n,o){let i=t.features;for(let t=0,r=i.length;t<r;t++)et(e,i[t],void 0,n,o)},GeometryCollection:er,LineString:el,MultiLineString:ea,MultiPoint:ei,MultiPolygon:ef,Point:eo,Polygon:ec,Topology:ep},ee={GeometryCollection:er,LineString:el,MultiLineString:ea,MultiPoint:ei,MultiPolygon:ef,Point:eo,Polygon:ec,Topology:ep};function et(e,t,r,n,o){if(null===t.geometry)return void X(t,e._entityCollection,o.describe);if(!(0,c.A)(t.geometry))throw new k.A("feature.geometry is required.");let i=t.geometry.type,s=ee[i];if(!(0,c.A)(s))throw new k.A(`Unknown geometry type: ${i}`);s(e,t,t.geometry,n,o)}function er(e,t,r,n,o){let i=r.geometries;for(let r=0,s=i.length;r<s;r++){let s=i[r],l=s.type,a=ee[l];if(!(0,c.A)(a))throw new k.A(`Unknown geometry type: ${l}`);a(e,t,s,n,o)}}function en(e,t,r,n,o){let i,l=o.markerSymbol,a=o.markerColor,u=o.markerSize,f=t.properties;if((0,c.A)(f)){let e=f["marker-color"];(0,c.A)(e)&&(a=s.A.fromCssColorString(e)),u=H[f["marker-size"]]??u;let t=f["marker-symbol"];(0,c.A)(t)&&(l=t)}i=(0,c.A)(l)?1===l.length?e._pinBuilder.fromText(l.toUpperCase(),a,u):e._pinBuilder.fromMakiIconId(l,a,u):e._pinBuilder.fromColor(a,u);let p=new S.A;p.verticalOrigin=new M.A(_.A.BOTTOM),2===n.length&&o.clampToGround&&(p.heightReference=v.Ay.CLAMP_TO_GROUND);let h=X(t,e._entityCollection,o.describe);h.billboard=p,h.position=new U.A(r(n));let d=Promise.resolve(i).then(function(e){p.image=new M.A(e)}).catch(function(){p.image=new M.A(e._pinBuilder.fromColor(a,u))});e._promises.push(d)}function eo(e,t,r,n,o){en(e,t,n,r.coordinates,o)}function ei(e,t,r,n,o){let i=r.coordinates;for(let r=0;r<i.length;r++)en(e,t,n,i[r],o)}function es(e,t,r,n,i){let l=i.strokeMaterialProperty,a=i.strokeWidthProperty,u=t.properties;if((0,c.A)(u)){let e,t=u["stroke-width"];(0,c.A)(t)&&(a=new M.A(t));let r=u.stroke;(0,c.A)(r)&&(e=s.A.fromCssColorString(r));let n=u["stroke-opacity"];(0,c.A)(n)&&1!==n&&((0,c.A)(e)||(e=l.color.getValue().clone()),e.alpha=n),(0,c.A)(e)&&(l=new x.A(e))}let f=X(t,e._entityCollection,i.describe),p=new G.A;f.polyline=p,p.clampToGround=i.clampToGround,p.material=l,p.width=a,p.positions=new M.A(K(n,r)),p.arcType=o.A.RHUMB}function el(e,t,r,n,o){es(e,t,n,r.coordinates,o)}function ea(e,t,r,n,o){let i=r.coordinates;for(let r=0;r<i.length;r++)es(e,t,n,i[r],o)}function eu(e,t,r,n,i){if(0===n.length||0===n[0].length)return;let l=i.strokeMaterialProperty.color,a=i.fillMaterialProperty,u=i.strokeWidthProperty,f=t.properties;if((0,c.A)(f)){let e,t,r=f["stroke-width"];(0,c.A)(r)&&(u=new M.A(r));let n=f.stroke;(0,c.A)(n)&&(e=s.A.fromCssColorString(n));let o=f["stroke-opacity"];(0,c.A)(o)&&1!==o&&((0,c.A)(e)||(e=l.getValue().clone()),e.alpha=o),(0,c.A)(e)&&(l=new M.A(e));let i=f.fill,p=a.color.getValue();(0,c.A)(i)&&((t=s.A.fromCssColorString(i)).alpha=p.alpha),o=f["fill-opacity"],(0,c.A)(o)&&o!==p.alpha&&((0,c.A)(t)||(t=p.clone()),t.alpha=o),(0,c.A)(t)&&(a=new x.A(t))}let p=new j.A;p.outline=new M.A(!0),p.outlineColor=l,p.outlineWidth=u,p.material=a,p.arcType=o.A.RHUMB;let h=[];for(let e=1,t=n.length;e<t;e++)h.push(new P.A(K(n[e],r)));let d=n[0];p.hierarchy=new M.A(new P.A(K(d,r),h)),d[0].length>2?p.perPositionHeight=new M.A(!0):i.clampToGround||(p.height=0),X(t,e._entityCollection,i.describe).polygon=p}function ec(e,t,r,n,o){eu(e,t,n,r.coordinates,o)}function ef(e,t,r,n,o){let i=r.coordinates;for(let r=0;r<i.length;r++)eu(e,t,n,i[r],o)}function ep(e,t,r,n,o){for(let t in r.objects)if(r.objects.hasOwnProperty(t)){let i=function(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return T(e,t)})}:T(e,t)}(r,r.objects[t]);(0,Q[i.type])(e,i,i,n,o)}}function eh(e){this._name=e,this._changed=new p.A,this._error=new p.A,this._isLoading=!1,this._loading=new p.A,this._entityCollection=new F.A(this),this._promises=[],this._pinBuilder=new w,this._entityCluster=new I.A,this._credit=void 0,this._resourceCredits=[]}function ed(e,t,r,o){if(!(0,c.A)(t))throw new f.A("data is required.");E.A.setLoading(e,!0);let i=(r=r??u.A.EMPTY_OBJECT).credit;"string"==typeof i&&(i=new a.A(i)),e._credit=i;let s=t,l=r.sourceUri;if("string"==typeof t||t instanceof g.A){s=(t=g.A.createIfNeeded(t)).fetchJson(),l=l??t.getUrlComponent();let r=e._resourceCredits,n=t.credits;if((0,c.A)(n)){let e=n.length;for(let t=0;t<e;t++)r.push(n[t])}}return r={describe:r.describe??Y,markerSize:r.markerSize??z,markerSymbol:r.markerSymbol??n,markerColor:r.markerColor??N,strokeWidthProperty:new M.A(r.strokeWidth??q),strokeMaterialProperty:new x.A(r.stroke??Z),fillMaterialProperty:new x.A(r.fill??V),clampToGround:r.clampToGround??W},Promise.resolve(s).then(function(t){return function(e,t,r,n,o){let i;(0,c.A)(n)&&(i=(0,h.A)(n)),(0,c.A)(i)&&e._name!==i&&(e._name=i,e._changed.raiseEvent(e));let s=Q[t.type];if(!(0,c.A)(s))throw new k.A(`Unsupported GeoJSON object type: ${t.type}`);let l=t.crs,a=null!==l?$:null;if((0,c.A)(l)){if(!(0,c.A)(l.properties))throw new k.A("crs.properties is undefined.");let e=l.properties;if("name"===l.type){if(a=B[e.name],!(0,c.A)(a))throw new k.A(`Unknown crs name: ${e.name}`)}else if("link"===l.type){let t=D[e.href];if((0,c.A)(t)||(t=R[e.type]),!(0,c.A)(t))throw new k.A(`Unable to resolve crs link: ${JSON.stringify(e)}`);a=t(e)}else if("EPSG"===l.type){if(a=B[`EPSG:${e.code}`],!(0,c.A)(a))throw new k.A(`Unknown crs EPSG code: ${e.code}`)}else throw new k.A(`Unknown crs type: ${l.type}`)}return Promise.resolve(a).then(function(n){return o&&e._entityCollection.removeAll(),null!==n&&s(e,t,t,n,r),Promise.all(e._promises).then(function(){return e._promises.length=0,E.A.setLoading(e,!1),e})})}(e,t,r,l,o)}).catch(function(t){throw E.A.setLoading(e,!1),e._error.raiseEvent(e,t),t})}eh.load=function(e,t){return new eh().load(e,t)},Object.defineProperties(eh,{markerSize:{get:function(){return z},set:function(e){z=e}},markerSymbol:{get:function(){return n},set:function(e){n=e}},markerColor:{get:function(){return N},set:function(e){N=e}},stroke:{get:function(){return Z},set:function(e){Z=e}},strokeWidth:{get:function(){return q},set:function(e){q=e}},fill:{get:function(){return V},set:function(e){V=e}},clampToGround:{get:function(){return W},set:function(e){W=e}},crsNames:{get:function(){return B}},crsLinkHrefs:{get:function(){return D}},crsLinkTypes:{get:function(){return R}}}),Object.defineProperties(eh.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!(0,c.A)(e))throw new f.A("value must be defined.");this._entityCluster=e}},credit:{get:function(){return this._credit}}}),eh.prototype.load=function(e,t){return ed(this,e,t,!0)},eh.prototype.process=function(e,t){return ed(this,e,t,!1)},eh.prototype.update=function(e){return!0};let eg=eh},87327(e,t,r){r.d(t,{Ay:()=>M});var n,o=r(10829),i=()=>new DecompressionStream("deflate-raw");try{i(),n=async e=>{let t=i(),r=t.writable.getWriter(),n=t.readable.getReader(),o,s=[],l=0,a=0,u;for(r.write(e),r.close();!(u=await n.read()).done;)o=u.value,s.push(o),l+=o.length;return!s[1]&&o||(o=new Uint8Array(l),s.map(e=>(o.set(e,a),a+=e.length))),o}}catch{}var s=new TextDecoder,l=e=>{throw Error("but-unzip~"+e)},a=e=>s.decode(e);let u=/.+\.(shp|dbf|json|prj|cpg)$/i,c=async e=>{let t={},r=[];for(let o of function*(e,t=n){let r=e.length-20,o=Math.max(r-65516,2);for(;-1!==(r=e.lastIndexOf(80,r-1))&&(75!==e[r+1]||5!==e[r+2]||6!==e[r+3])&&r>o;);-1===r&&l(2);let i=(t,n)=>e.subarray(r+=t,r+=n),s=new DataView(e.buffer,e.byteOffset),u=e=>s.getUint16(e+r,!0),c=e=>s.getUint32(e+r,!0),f=u(10);for(f!==u(8)&&l(3),r=c(16);f--;){let e=u(10),n=u(30),o=u(32),s=c(20),f=c(42),p=a(i(46,u(28))),h=a(i(n,o)),d=r,g;r=f,g=i(30+u(26)+u(28),s),yield{filename:p,comment:h,read:()=>8&e?t(g):e?l(1):g},r=d}}(e))u.test(o.filename)&&r.push(Promise.resolve(o.read()).then(e=>t[o.filename]=e));await Promise.all(r);let o={},i=new TextDecoder;for(let[e,r]of Object.entries(t))"shp"===e.slice(-3).toLowerCase()||"dbf"===e.slice(-3).toLowerCase()?o[e]=new DataView(r.buffer,r.byteOffset,r.byteLength):o[e]=i.decode(r);return o},f=globalThis.URL;async function p(e,t){let r=((e,t)=>{if(!t)return e;let r=new f(e);return r.pathname=`${r.pathname}.${t}`,r.href})(e,t),n="prj"===t||"cpg"===t;try{let e=await fetch(r);if(e.status>399)throw Error(e.statusText);if(n)return e.text();let t=await e.arrayBuffer();return new DataView(t)}catch(e){if(n||"dbf"===t)return!1;throw e}}function h(e,t){return!(e.bbox[0]>t.bbox[0])&&!(e.bbox[1]>t.bbox[1])&&!(e.bbox[2]<t.bbox[2])&&!(e.bbox[3]<t.bbox[3])}g.prototype.parsePoint=function(e){return{type:"Point",coordinates:this.parseCoord(e,0)}},g.prototype.parseZPoint=function(e){let t=this.parsePoint(e);return t.coordinates.push(e.getFloat64(16,!0)),t},g.prototype.parsePointArray=function(e,t,r){let n=[],o=0;for(;o<r;)n.push(this.parseCoord(e,t)),t+=16,o++;return n},g.prototype.parseZPointArray=function(e,t,r,n){let o=0;for(;o<r;)n[o].push(e.getFloat64(t,!0)),o++,t+=8;return n},g.prototype.parseArrayGroup=function(e,t,r,n,o){let i,s,l=[],a=0,u=0;for(;a<n;)a++,r+=4,i=u,(s=(u=a===n?o:e.getInt32(r,!0))-i)&&(l.push(this.parsePointArray(e,t,s)),t+=s<<4);return l},g.prototype.parseZArrayGroup=function(e,t,r,n){let o=0;for(;o<r;)n[o]=this.parseZPointArray(e,t,n[o].length,n[o]),t+=n[o].length<<3,o++;return n},g.prototype.parseMultiPoint=function(e){let t={},r=e.getInt32(32,!0);if(!r)return null;let n=this.parseCoord(e,0),o=this.parseCoord(e,16);return t.bbox=[n[0],n[1],o[0],o[1]],1===r?(t.type="Point",t.coordinates=this.parseCoord(e,36)):(t.type="MultiPoint",t.coordinates=this.parsePointArray(e,36,r)),t},g.prototype.parseZMultiPoint=function(e){let t,r=this.parseMultiPoint(e);return r?"Point"===r.type?(r.coordinates.push(e.getFloat64(72,!0)),r):(t=r.coordinates.length,r.coordinates=this.parseZPointArray(e,52+(t<<4),t,r.coordinates),r):null},g.prototype.parsePolyline=function(e){let t,r={},n=e.getInt32(32,!0);if(!n)return null;let o=this.parseCoord(e,0),i=this.parseCoord(e,16);r.bbox=[o[0],o[1],i[0],i[1]];let s=e.getInt32(36,!0);return 1===n?(r.type="LineString",t=44,r.coordinates=this.parsePointArray(e,t,s)):(r.type="MultiLineString",t=40+(n<<2),r.coordinates=this.parseArrayGroup(e,t,40,n,s)),r},g.prototype.parseZPolyline=function(e){let t,r=this.parsePolyline(e);if(!r)return null;let n=r.coordinates.length;return"LineString"===r.type?(t=60+(n<<4),r.coordinates=this.parseZPointArray(e,t,n,r.coordinates)):(t=56+(r.coordinates.reduce(function(e,t){return e+t.length},0)<<4)+(n<<2),r.coordinates=this.parseZArrayGroup(e,t,n,r.coordinates)),r},g.prototype.polyFuncs=function(e){return e&&("LineString"===e.type?(e.type="Polygon",e.coordinates=[e.coordinates]):(e.coordinates=function e(t,r=!1){let n=[],o=[];for(let e of t){let t=function(e){let t,r,n=0,o=1,i=e.length,s=[e[0][0],e[0][1],e[0][0],e[0][1]];for(;o<i;)t=r||e[0],n+=((r=e[o])[0]-t[0])*(r[1]+t[1]),o++,r[0]<s[0]&&(s[0]=r[0]),r[1]<s[1]&&(s[1]=r[1]),r[0]>s[2]&&(s[2]=r[0]),r[1]>s[3]&&(s[3]=r[1]);return{ring:e,clockWise:n>0,bbox:s,children:[]}}(e);t.clockWise!==r?n.push(t):o.push(t)}let i=[];for(let e of o){let t;for(let r of n)h(r,e)&&(t?h(t,r)&&(t=r):t=r);t?t.children.push(e.ring):i.push(e)}if(r)return{outers:n,orphens:i};if(i.length&&!r){let r=e(t,!0);if(0===r.orphens.length){let e=[];for(let t of r.outers)e.push([t.ring.toReversed()].concat(t.children.map(e=>e.toReversed())));return e}}let s=[];for(let e of n)s.push([e.ring].concat(e.children));return s}(e.coordinates),1===e.coordinates.length)?(e.type="Polygon",e.coordinates=e.coordinates[0]):e.type="MultiPolygon"),e},g.prototype.parsePolygon=function(e){return this.polyFuncs(this.parsePolyline(e))},g.prototype.parseZPolygon=function(e){return this.polyFuncs(this.parseZPolyline(e))};let d={1:"parsePoint",3:"parsePolyline",5:"parsePolygon",8:"parseMultiPoint",11:"parseZPoint",13:"parseZPolyline",15:"parseZPolygon",18:"parseZMultiPoint"};function g(e,t){if(!(this instanceof g))return new g(e,t);this.buffer=e,this.headers=this.parseHeader(),this.shpFuncs(t),this.rows=this.getRows()}function y(e,t){return new g(e,t).rows}g.prototype.shpFuncs=function(e){let t=this.headers.shpCode;if(t>20&&(t-=20),!(t in d))throw Error(`I don't know shp type "${t}"`);this.parseFunc=this[d[t]],this.parseCoord=e?function(t,r){let n=[t.getFloat64(r,!0),t.getFloat64(r+8,!0)];return e.inverse(n)}:function(e,t){return[e.getFloat64(t,!0),e.getFloat64(t+8,!0)]}},g.prototype.getShpCode=function(){return this.parseHeader().shpCode},g.prototype.parseHeader=function(){let e=this.buffer;return{length:e.getInt32(24)<<1,version:e.getInt32(28,!0),shpCode:e.getInt32(32,!0),bbox:[e.getFloat64(36,!0),e.getFloat64(44,!0),e.getFloat64(52,!0),e.getFloat64(60,!0)]}},g.prototype.getRows=function(){let e,t=100,r=this.buffer.byteLength-8,n=[];for(;t<=r&&(e=this.getRow(t));)t+=8,t+=e.len,e.type?n.push(this.parseFunc(e.data)):n.push(null);return n},g.prototype.getRow=function(e){let t=this.buffer.getInt32(e),r=this.buffer.getInt32(e+4)<<1;return 0===r?{id:t,len:r,type:0}:e+r+8>this.buffer.byteLength?void 0:{id:t,len:r,data:new DataView(this.buffer.buffer,this.buffer.byteOffset+e+12,r-4),type:this.buffer.getInt32(e+8,!0)}};var w=/^(?:ANSI\s)?(\d+)$/m;function A(e,t){for(var r,n=function e(t,r){if(!t)return o;try{new TextDecoder(t.trim())}catch(o){var n=w.exec(t);if(n&&!r)return e("windows-"+n[1],!0);t=void 0}return o;function o(e){var r=new TextDecoder(t||void 0);return(r.decode(e,{stream:!0})+r.decode()).replace(/\0/g,"").trim()}}(t),o=((r={}).lastUpdated=new Date(e.getUint8(1)+1900,e.getUint8(2),e.getUint8(3)),r.records=e.getUint32(4,!0),r.headerLen=e.getUint16(8,!0),r.recLen=e.getUint16(10,!0),r),i=function(e,t,r){for(var n=[],o=32;o<t&&(n.push({name:r(new Uint8Array(e.buffer.slice(e.byteOffset+o,e.byteOffset+o+11))),dataType:String.fromCharCode(e.getUint8(o+11)),len:e.getUint8(o+16),decimal:e.getUint8(o+17)}),13!==e.getUint8(o+32));)o+=32;return n}(e,o.headerLen-1,n),s=(i.length+1<<5)+2,l=o.recLen,a=o.records,u=[];a;)u.push(function(e,t,r,n){for(var o,i,s={},l=0,a=r.length;l<a;)o=function(e,t,r,n,o){var i=o(new Uint8Array(e.buffer.slice(e.byteOffset+t,e.byteOffset+t+r)));switch(n){case"N":case"F":case"O":return parseFloat(i,10);case"D":return new Date(i.slice(0,4),parseInt(i.slice(4,6),10)-1,i.slice(6,8));case"L":return"y"===i.toLowerCase()||"t"===i.toLowerCase();default:return i}}(e,t,(i=r[l]).len,i.dataType,n),t+=i.len,void 0!==o&&(s[i.name]=o),l++;return s}(e,s,i,n)),s+=l,a--;return u}let m=globalThis.URL,b=new TextDecoder,C=e=>{if(e){if("string"==typeof e)return e;if(k(e)||ArrayBuffer.isView(e)||v(e))return b.decode(e)}},P=e=>{if(!e)throw Error("forgot to pass buffer");if(v(e))return e;if(k(e))return new DataView(e);if(k(e.buffer))return new DataView(e.buffer,e.byteOffset,e.byteLength);throw Error("invalid buffer like object")};function k(e){return e instanceof globalThis.ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e)}function v(e){return e instanceof globalThis.DataView||"[object DataView]"===Object.prototype.toString.call(e)}let _=function([e,t]){let r={};r.type="FeatureCollection",r.features=[];let n=0,o=e.length;for(t||(t=[]);n<o;)r.features.push({type:"Feature",geometry:e[n],properties:t[n]||{}}),n++;return r},L=async function(e,t){let r;e=(e=>{if(!e)throw Error("forgot to pass buffer");if(k(e))return new Uint8Array(e);if(k(e.buffer))return 1===e.BYTES_PER_ELEMENT?e:new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("invalid buffer like object")})(e);let n=await c(e),i=[];for(r in t=t||[],n)-1===r.indexOf("__MACOSX")&&(".shp"===r.slice(-4).toLowerCase()?(i.push(r.slice(0,-4)),n[r.slice(0,-3)+r.slice(-3).toLowerCase()]=n[r]):".prj"===r.slice(-4).toLowerCase()?n[r.slice(0,-3)+r.slice(-3).toLowerCase()]=(0,o.A)(n[r]):".json"===r.slice(-5).toLowerCase()||t.indexOf(r.split(".").pop())>-1?i.push(r.slice(0,-3)+r.slice(-3).toLowerCase()):(".dbf"===r.slice(-4).toLowerCase()||".cpg"===r.slice(-4).toLowerCase())&&(n[r.slice(0,-3)+r.slice(-3).toLowerCase()]=n[r]));if(!i.length)throw Error("no layers founds");let s=i.map(function(e){let r,o,i=e.lastIndexOf(".");return i>-1&&e.slice(i).indexOf("json")>-1?(r=JSON.parse(n[e])).fileName=e.slice(0,i):t.indexOf(e.slice(i+1))>-1?(r=n[e]).fileName=e:(n[e+".dbf"]&&(o=A(n[e+".dbf"],n[e+".cpg"])),(r=_([y(n[e+".shp"],n[e+".prj"]),o])).fileName=e),r});return 1===s.length?s[0]:s};async function T(e,t){return L(await p(e),t)}let S=async e=>{let t=await Promise.all([p(e,"shp"),p(e,"prj")]),r=!1;try{t[1]&&(r=(0,o.A)(t[1]))}catch(e){r=!1}return y(t[0],r)},O=async e=>{let[t,r]=await Promise.all([p(e,"dbf"),p(e,"cpg")]);if(t)return A(t,r)},x=(e,t)=>new m(e,globalThis?.document?.location).pathname.slice(-4).toLowerCase()===t,U=function(e,t){if(e=P(e),"string"==typeof(t=C(t)))try{t=(0,o.A)(t)}catch(e){t=!1}return y(e,t)},M=async function(e,t){if("string"!=typeof e){if(k(e)||ArrayBuffer.isView(e)||v(e))return L(e);if(e.shp)return(({shp:e,dbf:t,cpg:r,prj:n})=>{var o,i;let s=[U(e,n)];return t&&s.push((o=t,i=r,A(o=P(o),i=C(i)))),_(s)})(e);throw TypeError("must be a string, some sort of Buffer, or an object with at least a .shp property")}return x(e,".zip")?T(e,t):(x(e,".shp")&&(e=e.slice(0,-4)),_(await Promise.all([S(e),O(e)])))}}}]);