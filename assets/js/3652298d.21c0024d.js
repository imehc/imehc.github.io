"use strict";(self.webpackChunkanch=self.webpackChunkanch||[]).push([["867"],{11531(e,n,t){t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>c});var s=t(2490),r=t(35656),a=t(56610);let l={title:"\u524D\u7AEF\u4E0B\u8F7D\u6587\u4EF6\u8E29\u5751",date:"2024-11-18",tags:["Vue"],draft:!1,summary:"\u524D\u7AEF\u5904\u7406\u6587\u4EF6\u4E0B\u8F7D\u65F6\u6CE8\u610F\u4E8B\u9879"},o,i={authorsImageUrls:[]},c=[{value:"\u521B\u5EFA\u670D\u52A1\u7AEF",id:"\u521B\u5EFA\u670D\u52A1\u7AEF",level:2},{value:"\u521B\u5EFA\u5BA2\u6237\u7AEF",id:"\u521B\u5EFA\u5BA2\u6237\u7AEF",level:2},{value:"\u603B\u7ED3",id:"\u603B\u7ED3",level:2}];function d(e){let n={blockquote:"blockquote",code:"code",h2:"h2",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["\u670D\u52A1\u7AEF\u63D0\u4F9B\u501F\u53E3\uFF0C\u8FD4\u56DE\u6587\u4EF6\u6D41\uFF0C\u6D4F\u89C8\u5668\u80FD\u89E6\u53D1\u4E0B\u8F7D\uFF0C\u4F46\u662F\u4F7F\u7528",(0,r.jsx)(n.code,{children:"file-saver"}),"\u4E0B\u8F7D\u62A5\u9519\u6216\u65E0\u6CD5\u6253\u5F00"]}),"\n",(0,r.jsx)(n.h2,{id:"\u521B\u5EFA\u670D\u52A1\u7AEF",children:"\u521B\u5EFA\u670D\u52A1\u7AEF"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u521B\u5EFA\u4E00\u4E2A\u63A5\u53E3\u63D0\u4F9B\u6587\u4EF6\u4E0B\u8F7D,\u8FD9\u91CC\u4F7F\u7528",(0,r.jsx)(n.code,{children:"nestjs"}),",\u4FEE\u6539",(0,r.jsx)(n.code,{children:"app.module.ts"}),",\u5E76\u5728\u6839\u76EE\u5F55\u4E0B\u5B58\u653E\u4E00\u4E2A\u540D\u4E3A",(0,r.jsx)(n.code,{children:"download.xlsx"}),"\u7684\u6587\u4EF6"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"import { Controller, Get, Header, Res, StreamableFile } from '@nestjs/common';\nimport { AppService } from './app.service';\nimport { createReadStream } from 'fs';\nimport { join } from 'path';\n\n@Controller()\nexport class AppController {\n  constructor(private readonly appService: AppService) {}\n\n  @Get('get-file')\n  @Header(\n    'Content-Type',\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  )\n  @Header('Content-Disposition', 'attachment; filename=download.xlsx')\n  getFile(@Res({ passthrough: true }) res: Response): StreamableFile {\n    const file = createReadStream(join(process.cwd(), 'download.xlsx'));\n    return new StreamableFile(file);\n  }\n}\n\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u521B\u5EFA\u5BA2\u6237\u7AEF",children:"\u521B\u5EFA\u5BA2\u6237\u7AEF"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u4EE5",(0,r.jsx)(n.code,{children:"vue"}),"\u4F5C\u4E3A\u524D\u7AEF,\u4FEE\u6539",(0,r.jsx)(n.code,{children:"App.vue"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-vue",children:"<script lang=\"ts\" setup>\nimport axios from 'axios'\nimport { saveAs } from 'file-saver'\n\n// \u63D0\u4F9B\u670D\u52A1\u7684\u7AEF\u53E3\uFF0C\u5B9E\u9645\u7AEF\u53E3\u4EE5\u670D\u52A1\u63D0\u4F9B\u7AEF\u53E3\u4E3A\u51C6\nconst handleGetFile = async () => {\n  // \u4F7F\u7528fetch\n  // const response = await fetch('http://127.0.0.1:3000/get-file')\n  // const data = await response.blob()// \u6CE8\u610F\u9700\u8981\u8BBE\u7F6E\u54CD\u5E94\u7C7B\u578B!!!\n  // \u4F7F\u7528axios\n  const { data } = await axios.get('http://127.0.0.1:3000/get-file', {\n    method: 'GET',\n    responseType: 'blob', // \u6CE8\u610F\u9700\u8981\u8BBE\u7F6E\u54CD\u5E94\u7C7B\u578B!!!\n  })\n  saveAs(data, 'download.xlsx')\n}\n<\/script>\n\n<template>\n  <button type=\"button\" @click=\"handleGetFile\">\u4FDD\u5B58\u6587\u4EF6</button>\n</template>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u603B\u7ED3",children:"\u603B\u7ED3"}),"\n",(0,r.jsx)(n.p,{children:"\u4E0B\u8F7D\u6587\u4EF6\u65F6\u524D\u7AEF\u4E5F\u9700\u8981\u8BBE\u7F6E\u54CD\u5E94\u7C7B\u578B"})]})}function p(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},2490(e){e.exports=JSON.parse('{"permalink":"/blog/\u4E0B\u8F7D\u6587\u4EF6\u8E29\u5751","source":"@site/blog/\u4E0B\u8F7D\u6587\u4EF6\u8E29\u5751.md","title":"\u524D\u7AEF\u4E0B\u8F7D\u6587\u4EF6\u8E29\u5751","description":"\u670D\u52A1\u7AEF\u63D0\u4F9B\u501F\u53E3\uFF0C\u8FD4\u56DE\u6587\u4EF6\u6D41\uFF0C\u6D4F\u89C8\u5668\u80FD\u89E6\u53D1\u4E0B\u8F7D\uFF0C\u4F46\u662F\u4F7F\u7528file-saver\u4E0B\u8F7D\u62A5\u9519\u6216\u65E0\u6CD5\u6253\u5F00","date":"2024-11-18T00:00:00.000Z","tags":[{"inline":true,"label":"Vue","permalink":"/blog/tags/vue"}],"readingTime":1.08,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"\u524D\u7AEF\u4E0B\u8F7D\u6587\u4EF6\u8E29\u5751","date":"2024-11-18","tags":["Vue"],"draft":false,"summary":"\u524D\u7AEF\u5904\u7406\u6587\u4EF6\u4E0B\u8F7D\u65F6\u6CE8\u610F\u4E8B\u9879"},"unlisted":false,"prevItem":{"title":"WebRTC \u89C6\u9891\u6D41\u670D\u52A1\u7AEFDEMO","permalink":"/blog/WebRTC\u670D\u52A1\u7AEFDEMO"},"nextItem":{"title":"Nestjs\u57FA\u7840\u4ECB\u7ECD\u4E0E\u6587\u4EF6\u8BF4\u660E","permalink":"/blog/nestjs\u57FA\u7840\u4ECB\u7ECD\u4E0E\u6587\u4EF6\u8BF4\u660E"}}')}}]);