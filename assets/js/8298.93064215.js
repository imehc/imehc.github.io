(self.webpackChunkanch=self.webpackChunkanch||[]).push([["8298"],{82390(e,t,r){"use strict";r.d(t,{p:()=>o}),r(57140);var n=r(67199),l=r(3355);let i=0,o=(0,l.v)(e=>(n.h_9.onStart=(t,r,n)=>{e({active:!0,item:t,loaded:r,total:n,progress:(r-i)/(n-i)*100})},n.h_9.onLoad=()=>{e({active:!1})},n.h_9.onError=t=>e(e=>({errors:[...e.errors,t]})),n.h_9.onProgress=(t,r,n)=>{r===n&&(i=n),e({active:!0,item:t,loaded:r,total:n,progress:(r-i)/(n-i)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}))},1560(e,t,r){"use strict";r.d(t,{U:()=>s});var n=r(57140),l=r(54600),i=r(15697),o=r.n(i);function a(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}function s({showPanel:e=0,className:t,parent:r}){let i=function(e,t=[],r){let[l,i]=n.useState();return n.useLayoutEffect(()=>{let t=e();return i(t),a(void 0,t),()=>a(void 0,null)},t),l}(()=>new(o()),[]);return n.useEffect(()=>{if(i){let n=r&&r.current||document.body;i.showPanel(e),null==n||n.appendChild(i.dom);let o=(null!=t?t:"").split(" ").filter(e=>e);o.length&&i.dom.classList.add(...o);let a=(0,l.j)(()=>i.begin()),s=(0,l.k)(()=>i.end());return()=>{o.length&&i.dom.classList.remove(...o),null==n||n.removeChild(i.dom),a(),s()}}},[r,i,t,e]),null}},30119(e,t,r){"use strict";let n,l;r.d(t,{E:()=>g});var i=r(44320),o=r(57140),a=r(84668),s=r(67199),c=r(54600);let u=new s.Pq0,d=new s.Pq0,f=new s.Pq0,m=new s.I9Y;function h(e,t,r){let n=u.setFromMatrixPosition(e.matrixWorld);n.project(t);let l=r.width/2,i=r.height/2;return[n.x*l+l,-(n.y*i)+i]}let p=e=>1e-10>Math.abs(e)?0:e;function x(e,t,r=""){let n="matrix3d(";for(let r=0;16!==r;r++)n+=p(t[r]*e.elements[r])+(15!==r?",":")");return r+n}let v=(n=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>x(e,n)),y=(l=e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1],(e,t)=>x(e,l(t),"translate(-50%,-50%)")),g=o.forwardRef(({children:e,eps:t=.001,style:r,className:n,prepend:l,center:x,fullscreen:g,portal:M,distanceFactor:P,sprite:b=!1,transform:w=!1,occlude:S,onOcclude:E,castShadow:R,receiveShadow:W,material:$,geometry:k,zIndexRange:z=[0x1000037,0],calculatePosition:C=h,as:T="div",wrapperClass:A,pointerEvents:I="auto",...F},j)=>{let{gl:L,camera:H,scene:D,size:q,raycaster:N,events:_,viewport:B}=(0,c.C)(),[O]=o.useState(()=>document.createElement(T)),U=o.useRef(null),V=o.useRef(null),G=o.useRef(0),J=o.useRef([0,0]),Y=o.useRef(null),Z=o.useRef(null),K=(null==M?void 0:M.current)||_.connected||L.domElement.parentNode,Q=o.useRef(null),X=o.useRef(!1),ee=o.useMemo(()=>{var e;return S&&"blending"!==S||Array.isArray(S)&&S.length&&(e=S[0])&&"object"==typeof e&&"current"in e},[S]);o.useLayoutEffect(()=>{let e=L.domElement;S&&"blending"===S?(e.style.zIndex=`${Math.floor(z[0]/2)}`,e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)},[S]),o.useLayoutEffect(()=>{if(V.current){let e=U.current=a.createRoot(O);if(D.updateMatrixWorld(),w)O.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{let e=C(V.current,H,q);O.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${e[0]}px,${e[1]}px,0);transform-origin:0 0;`}return K&&(l?K.prepend(O):K.appendChild(O)),()=>{K&&K.removeChild(O),e.unmount()}}},[K,w]),o.useLayoutEffect(()=>{A&&(O.className=A)},[A]);let et=o.useMemo(()=>w?{position:"absolute",top:0,left:0,width:q.width,height:q.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:x?"translate3d(-50%,-50%,0)":"none",...g&&{top:-q.height/2,left:-q.width/2,width:q.width,height:q.height},...r},[r,x,g,q,w]),er=o.useMemo(()=>({position:"absolute",pointerEvents:I}),[I]);o.useLayoutEffect(()=>{var t,l;X.current=!1,w?null==(t=U.current)||t.render(o.createElement("div",{ref:Y,style:et},o.createElement("div",{ref:Z,style:er},o.createElement("div",{ref:j,className:n,style:r,children:e})))):null==(l=U.current)||l.render(o.createElement("div",{ref:j,style:et,className:n,children:e}))});let en=o.useRef(!0);(0,c.D)(e=>{if(V.current){H.updateMatrixWorld(),V.current.updateWorldMatrix(!0,!1);let e=w?J.current:C(V.current,H,q);if(w||Math.abs(G.current-H.zoom)>t||Math.abs(J.current[0]-e[0])>t||Math.abs(J.current[1]-e[1])>t){var r;let t,n,l,i,o=(r=V.current,t=u.setFromMatrixPosition(r.matrixWorld),n=d.setFromMatrixPosition(H.matrixWorld),l=t.sub(n),i=H.getWorldDirection(f),l.angleTo(i)>Math.PI/2),a=!1;ee&&(Array.isArray(S)?a=S.map(e=>e.current):"blending"!==S&&(a=[D]));let c=en.current;a?en.current=function(e,t,r,n){let l=u.setFromMatrixPosition(e.matrixWorld),i=l.clone();i.project(t),m.set(i.x,i.y),r.setFromCamera(m,t);let o=r.intersectObjects(n,!0);if(o.length){let e=o[0].distance;return l.distanceTo(r.ray.origin)<e}return!0}(V.current,H,N,a)&&!o:en.current=!o,c!==en.current&&(E?E(!en.current):O.style.display=en.current?"block":"none");let h=Math.floor(z[0]/2),x=S?ee?[z[0],h]:[h-1,0]:z;if(O.style.zIndex=`${function(e,t,r){if(t instanceof s.ubm||t instanceof s.qUd){let n=u.setFromMatrixPosition(e.matrixWorld),l=d.setFromMatrixPosition(t.matrixWorld),i=n.distanceTo(l),o=(r[1]-r[0])/(t.far-t.near),a=r[1]-o*t.far;return Math.round(o*i+a)}}(V.current,H,x)}`,w){let[e,t]=[q.width/2,q.height/2],r=H.projectionMatrix.elements[5]*t,{isOrthographicCamera:n,top:l,left:i,bottom:o,right:a}=H,s=v(H.matrixWorldInverse),c=n?`scale(${r})translate(${p(-(a+i)/2)}px,${p((l+o)/2)}px)`:`translateZ(${r}px)`,u=V.current.matrixWorld;b&&((u=H.matrixWorldInverse.clone().transpose().copyPosition(u).scale(V.current.scale)).elements[3]=u.elements[7]=u.elements[11]=0,u.elements[15]=1),O.style.width=q.width+"px",O.style.height=q.height+"px",O.style.perspective=n?"":`${r}px`,Y.current&&Z.current&&(Y.current.style.transform=`${c}${s}translate(${e}px,${t}px)`,Z.current.style.transform=y(u,1/((P||10)/400)))}else{let t=void 0===P?1:function(e,t){if(t instanceof s.qUd)return t.zoom;if(!(t instanceof s.ubm))return 1;{let r=u.setFromMatrixPosition(e.matrixWorld),n=d.setFromMatrixPosition(t.matrixWorld);return 1/(2*Math.tan(t.fov*Math.PI/180/2)*r.distanceTo(n))}}(V.current,H)*P;O.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}J.current=e,G.current=H.zoom}}if(!ee&&Q.current&&!X.current)if(w){if(Y.current){let e=Y.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){let{isOrthographicCamera:t}=H;if(t||k)F.scale&&(Array.isArray(F.scale)?F.scale instanceof s.Pq0?Q.current.scale.copy(F.scale.clone().divideScalar(1)):Q.current.scale.set(1/F.scale[0],1/F.scale[1],1/F.scale[2]):Q.current.scale.setScalar(1/F.scale));else{let t=(P||10)/400,r=e.clientWidth*t,n=e.clientHeight*t;Q.current.scale.set(r,n,1)}X.current=!0}}}else{let t=O.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){let e=1/B.factor,r=t.clientWidth*e,n=t.clientHeight*e;Q.current.scale.set(r,n,1),X.current=!0}Q.current.lookAt(e.camera.position)}});let el=o.useMemo(()=>({vertexShader:w?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[w]);return o.createElement("group",(0,i.A)({},F,{ref:V}),S&&!ee&&o.createElement("mesh",{castShadow:R,receiveShadow:W,ref:Q},k||o.createElement("planeGeometry",null),$||o.createElement("shaderMaterial",{side:s.$EB,vertexShader:el.vertexShader,fragmentShader:el.fragmentShader})))})},15697(e){var t;(t=function(){function e(e){return l.appendChild(e.dom),e}function r(e){for(var t=0;t<l.children.length;t++)l.children[t].style.display=t===e?"block":"none";n=e}var n=0,l=document.createElement("div");l.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",l.addEventListener("click",function(e){e.preventDefault(),r(++n%l.children.length)},!1);var i=(performance||Date).now(),o=i,a=0,s=e(new t.Panel("FPS","#0ff","#002")),c=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=e(new t.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:l,addPanel:e,showPanel:r,begin:function(){i=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(c.update(e-i,200),e>o+1e3&&(s.update(1e3*a/(e-o),100),o=e,a=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){i=this.end()},domElement:l,setMode:r}}).Panel=function(e,t,r){var n=1/0,l=0,i=Math.round,o=i(window.devicePixelRatio||1),a=80*o,s=48*o,c=3*o,u=2*o,d=3*o,f=15*o,m=74*o,h=30*o,p=document.createElement("canvas");p.width=a,p.height=s,p.style.cssText="width:80px;height:48px";var x=p.getContext("2d");return x.font="bold "+9*o+"px Helvetica,Arial,sans-serif",x.textBaseline="top",x.fillStyle=r,x.fillRect(0,0,a,s),x.fillStyle=t,x.fillText(e,c,u),x.fillRect(d,f,m,h),x.fillStyle=r,x.globalAlpha=.9,x.fillRect(d,f,m,h),{dom:p,update:function(s,v){n=Math.min(n,s),l=Math.max(l,s),x.fillStyle=r,x.globalAlpha=1,x.fillRect(0,0,a,f),x.fillStyle=t,x.fillText(i(s)+" "+e+" ("+i(n)+"-"+i(l)+")",c,u),x.drawImage(p,d+o,f,m-o,h,d,f,m-o,h),x.fillRect(d+m-o,f,o,h),x.fillStyle=r,x.globalAlpha=.9,x.fillRect(d+m-o,f,o,i((1-s/v)*h))}}},e.exports=t},3355(e,t,r){"use strict";r.d(t,{v:()=>o});var n=r(57140),l=r(13347);let i=e=>{let t=(0,l.y)(e),r=e=>(function(e,t=e=>e){let r=n.useSyncExternalStore(e.subscribe,n.useCallback(()=>t(e.getState()),[e,t]),n.useCallback(()=>t(e.getInitialState()),[e,t]));return n.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},o=e=>e?i(e):i}}]);