"use strict";(self.webpackChunkanch=self.webpackChunkanch||[]).push([["5965"],{53069(e,t,r){r.r(t),r.d(t,{metadata:()=>n,default:()=>w,frontMatter:()=>b,contentTitle:()=>g,toc:()=>j,assets:()=>x});var n=JSON.parse('{"id":"web/three/advanced/d3-map","title":"D3Map","description":"\u6838\u5FC3\u6982\u5FF5","source":"@site/docs/web/three/advanced/17-d3-map.mdx","sourceDirName":"web/three/advanced","slug":"/web/three/advanced/d3-map","permalink":"/web/three/advanced/d3-map","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Javascript","permalink":"/tags/javascript"}],"version":"current","lastUpdatedBy":"dependabot[bot]","lastUpdatedAt":1769387863000,"sidebarPosition":17,"frontMatter":{"sidebar_position":17,"title":"D3Map","tags":["Javascript"]},"sidebar":"webSidebar","previous":{"title":"\u52A0\u8F7D\u672C\u5730\u6A21\u578B","permalink":"/web/three/advanced/preview-model"},"next":{"title":"Theatre \u7F16\u8F91\u5668","permalink":"/web/three/advanced/theatre-editor"}}'),a=r(35656),s=r(86145),l=r(74915),i=r(65708),o=r(46571),d=r(54600),c=r(99396),u=r(57140),p=r(67199),h=r(82044);let f=()=>{let{scene:e}=(0,d.C)(),t=(0,u.useMemo)(()=>(0,c.bAh)().center([116.412318,39.909843]).translate([0,0]),[]),r=(0,d.G)(p.Y9S,"https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json"),n=(0,u.useMemo)(()=>new p.B69,[]),s=(0,u.useCallback)((e,t)=>{let r=new p.ypk;e.forEach((e,t)=>{let[n,a]=[e[0],e[1]];0===t&&r.moveTo(n,-a),r.lineTo(n,-a)});let n=new p.QCA(r,{depth:10,bevelEnabled:!1}),a=new p.V9B({color:t,transparent:!0,opacity:.5});return new p.eaF(n,a)},[]),l=(0,u.useCallback)((e,r)=>{let n=new p.LoY,a=[];e.forEach(e=>{let[r,n]=t(e);a.push(new p.Pq0(r,-n,9))}),n.setFromPoints(a);let s=new p.mrM({color:r});return new p.N1A(n,s)},[t]);return(0,u.useMemo)(()=>{r&&(JSON.parse(r).features.forEach(e=>{let t=new p.B69;t.properties=e.properties.name;let r=["\u91CD\u5E86\u5E02","\u4E0A\u6D77\u5E02"].includes(e.properties.name)?"blue":"yellow";"MultiPolygon"===e.geometry.type&&e.geometry.coordinates.forEach(e=>{e.forEach(e=>{let n=s(e,r),a=l(e,r);t.add(a),t.add(n)})}),"Polygon"===e.geometry.type&&e.geometry.coordinates.forEach(e=>{let n=s(e,r),a=l(e,r);t.add(a),t.add(n)}),n.add(t)}),e.add(n))},[s,l,r,n,e]),(0,a.jsx)("primitive",{object:new p.IzY(100)})},m=()=>(0,a.jsx)(h.A,{children:(0,a.jsx)(o.Hl,{children:(0,a.jsxs)(u.Suspense,{fallback:null,children:[(0,a.jsx)(l.N,{}),(0,a.jsx)(i.u,{fov:40,aspect:2,far:1e4,lookAt:()=>[0,0,0],position:[0,0,300]}),(0,a.jsx)("ambientLight",{color:0xffffff,intensity:1}),(0,a.jsx)(f,{})]})})}),b={sidebar_position:17,title:"D3Map",tags:["Javascript"]},g="D3Map",x={},j=[{value:"\u6838\u5FC3\u6982\u5FF5",id:"\u6838\u5FC3\u6982\u5FF5",level:2}];function v(e){let t={h1:"h1",h2:"h2",header:"header",li:"li",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"d3map",children:"D3Map"})}),"\n",(0,a.jsx)(m,{}),"\n",(0,a.jsx)(t.h2,{id:"\u6838\u5FC3\u6982\u5FF5",children:"\u6838\u5FC3\u6982\u5FF5"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"D3.js geoMercator"}),": \u5730\u7406\u6295\u5F71\u51FD\u6570\uFF0C\u5C06\u7ECF\u7EAC\u5EA6\u5750\u6807\u8F6C\u6362\u4E3A\u5E73\u9762\u5750\u6807"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"ExtrudeGeometry"}),": \u5C06 2D \u5F62\u72B6\u62C9\u4F38\u6210 3D \u7ACB\u4F53\u51E0\u4F55\u4F53"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"GeoJSON"}),": \u5730\u7406\u4FE1\u606F\u7F16\u7801\u683C\u5F0F\uFF0C\u5305\u542B\u591A\u8FB9\u5F62\u548C\u70B9\u4F4D\u7B49\u5730\u7406\u6570\u636E"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"MultiPolygon vs Polygon"}),": \u5730\u7406\u6570\u636E\u7684\u4E24\u79CD\u7C7B\u578B\uFF0C\u9700\u8981\u5206\u522B\u5904\u7406"]}),"\n"]})]})}function w(e={}){let{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(v,{...e})}):v(e)}},61796(e,t,r){r.d(t,{j:()=>l});var n=r(57140),a=r(67199),s=r(54600);function l(e,t,r){let l=(0,s.C)(e=>e.size),i=(0,s.C)(e=>e.viewport),o="number"==typeof e?e:l.width*i.dpr,d="number"==typeof t?t:l.height*i.dpr,c=("number"==typeof e?r:e)||{},{samples:u=0,depth:p,...h}=c,f=null!=p?p:c.depthBuffer,m=n.useMemo(()=>{let e=new a.nWS(o,d,{minFilter:a.k6q,magFilter:a.k6q,type:a.ix0,...h});return f&&(e.depthTexture=new a.VCu(o,d,a.RQf)),e.samples=u,e},[]);return n.useLayoutEffect(()=>{m.setSize(o,d),u&&(m.samples=u)},[u,m,o,d]),n.useEffect(()=>()=>m.dispose(),[]),m}},65708(e,t,r){r.d(t,{u:()=>i});var n=r(44320),a=r(57140),s=r(54600),l=r(61796);let i=a.forwardRef(({envMap:e,resolution:t=256,frames:r=1/0,makeDefault:i,children:o,...d},c)=>{let u=(0,s.C)(({set:e})=>e),p=(0,s.C)(({camera:e})=>e),h=(0,s.C)(({size:e})=>e),f=a.useRef(null);a.useImperativeHandle(c,()=>f.current,[]);let m=a.useRef(null),b=(0,l.j)(t);a.useLayoutEffect(()=>{d.manual||(f.current.aspect=h.width/h.height)},[h,d]),a.useLayoutEffect(()=>{f.current.updateProjectionMatrix()});let g=0,x=null,j="function"==typeof o;return(0,s.D)(t=>{j&&(r===1/0||g<r)&&(m.current.visible=!1,t.gl.setRenderTarget(b),x=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,f.current),t.scene.background=x,t.gl.setRenderTarget(null),m.current.visible=!0,g++)}),a.useLayoutEffect(()=>{if(i)return u(()=>({camera:f.current})),()=>u(()=>({camera:p}))},[f,i,u]),a.createElement(a.Fragment,null,a.createElement("perspectiveCamera",(0,n.A)({ref:f},d),!j&&o),a.createElement("group",{ref:m},j&&o(b.texture)))})}}]);