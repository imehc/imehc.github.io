"use strict";(self.webpackChunkanch=self.webpackChunkanch||[]).push([["7873"],{46830(e,t,r){r.r(t),r.d(t,{metadata:()=>n,default:()=>$,frontMatter:()=>G,contentTitle:()=>I,toc:()=>F,assets:()=>W});var n=JSON.parse('{"id":"web/three/advanced/scene-background","title":"\u573A\u666F\u80CC\u666F\u5207\u6362","description":"\u6838\u5FC3\u6982\u5FF5","source":"@site/docs/web/three/advanced/19-scene-background.mdx","sourceDirName":"web/three/advanced","slug":"/web/three/advanced/scene-background","permalink":"/web/three/advanced/scene-background","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Javascript","permalink":"/tags/javascript"}],"version":"current","lastUpdatedBy":"semantic-release-bot","lastUpdatedAt":1768387969000,"sidebarPosition":19,"frontMatter":{"sidebar_position":19,"title":"\u573A\u666F\u80CC\u666F\u5207\u6362","tags":["Javascript"]},"sidebar":"webSidebar","previous":{"title":"Theatre \u7F16\u8F91\u5668","permalink":"/web/three/advanced/theatre-editor"},"next":{"title":"Globe.gl","permalink":"/web/three/advanced/globe.gl"}}'),a=r(35656),i=r(56610),l=r(16743),s=r(54484),o=r(47436),c=r(57140),u=r(46975),d=r(67199),p=r(9188),m=r(53220);let h=c.createContext({}),g=2*Math.PI,f=new d.B69,x=new d.kn4,[w,b]=[new d.PTz,new d.PTz],j=new d.Pq0,v=new d.Pq0,y=({alignment:e="bottom-right",margin:t=[80,80],renderPriority:r=1,onUpdate:n,onTarget:a,children:i})=>{let l=(0,u.C)(e=>e.size),s=(0,u.C)(e=>e.camera),o=(0,u.C)(e=>e.controls),y=(0,u.C)(e=>e.invalidate),E=c.useRef(null),k=c.useRef(null),P=c.useRef(!1),S=c.useRef(0),A=c.useRef(new d.Pq0(0,0,0)),R=c.useRef(new d.Pq0(0,0,0));c.useEffect(()=>{R.current.copy(s.up),f.up.copy(s.up)},[s]);let C=c.useCallback(e=>{P.current=!0,(o||a)&&(A.current=(null==a?void 0:a())||("getTarget"in o?o.getTarget(A.current):null==o?void 0:o.target)),S.current=s.position.distanceTo(j),w.copy(s.quaternion),v.copy(e).multiplyScalar(S.current).add(j),f.lookAt(v),b.copy(f.quaternion),y()},[o,s,a,y]);(0,u.D)((e,t)=>{if(k.current&&E.current){var r;P.current&&(.01>w.angleTo(b)?(P.current=!1,"minPolarAngle"in o&&s.up.copy(R.current)):(w.rotateTowards(b,t*g),s.position.set(0,0,1).applyQuaternion(w).multiplyScalar(S.current).add(A.current),s.up.set(0,1,0).applyQuaternion(w).normalize(),s.quaternion.copy(w),"getTarget"in o&&o.setPosition(s.position.x,s.position.y,s.position.z),n?n():o&&o.update(t),y())),x.copy(s.matrix).invert(),null==(r=E.current)||r.quaternion.setFromRotationMatrix(x)}});let T=c.useMemo(()=>({tweenCamera:C}),[C]),[z,M]=t,B=e.endsWith("-center")?0:e.endsWith("-left")?-l.width/2+z:l.width/2-z,N=e.startsWith("center-")?0:e.startsWith("top-")?l.height/2-M:-l.height/2+M;return c.createElement(m.Y,{renderPriority:r},c.createElement(h.Provider,{value:T},c.createElement(p.q,{makeDefault:!0,ref:k,position:[0,0,200]}),c.createElement("group",{ref:E,position:[B,N,0]},i)))};var E=r(44320);function k({scale:e=[.8,.05,.05],color:t,rotation:r}){return c.createElement("group",{rotation:r},c.createElement("mesh",{position:[.4,0,0]},c.createElement("boxGeometry",{args:e}),c.createElement("meshBasicMaterial",{color:t,toneMapped:!1})))}function P({onClick:e,font:t,disabled:r,arcStyle:n,label:a,labelColor:i,axisHeadScale:l=1,...s}){let o=(0,u.C)(e=>e.gl),p=c.useMemo(()=>{let e=document.createElement("canvas");e.width=64,e.height=64;let r=e.getContext("2d");return r.beginPath(),r.arc(32,32,16,0,2*Math.PI),r.closePath(),r.fillStyle=n,r.fill(),a&&(r.font=t,r.textAlign="center",r.fillStyle=i,r.fillText(a,32,41)),new d.GOR(e)},[n,a,i,t]),[m,h]=c.useState(!1),g=(a?1:.75)*(m?1.2:1)*l;return c.createElement("sprite",(0,E.A)({scale:g,onPointerOver:r?void 0:e=>{e.stopPropagation(),h(!0)},onPointerOut:r?void 0:e||(e=>{e.stopPropagation(),h(!1)})},s),c.createElement("spriteMaterial",{map:p,"map-anisotropy":o.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:a?1:.75,toneMapped:!1}))}let S=({hideNegativeAxes:e,hideAxisHeads:t,disabled:r,font:n="18px Inter var, Arial, sans-serif",axisColors:a=["#ff2060","#20df80","#2080ff"],axisHeadScale:i=1,axisScale:l,labels:s=["X","Y","Z"],labelColor:o="#000",onClick:u,...d})=>{let[p,m,g]=a,{tweenCamera:f}=c.useContext(h),x={font:n,disabled:r,labelColor:o,onClick:u,axisHeadScale:i,onPointerDown:r?void 0:e=>{f(e.object.position),e.stopPropagation()}};return c.createElement("group",(0,E.A)({scale:40},d),c.createElement(k,{color:p,rotation:[0,0,0],scale:l}),c.createElement(k,{color:m,rotation:[0,0,Math.PI/2],scale:l}),c.createElement(k,{color:g,rotation:[0,-Math.PI/2,0],scale:l}),!t&&c.createElement(c.Fragment,null,c.createElement(P,(0,E.A)({arcStyle:p,position:[1,0,0],label:s[0]},x)),c.createElement(P,(0,E.A)({arcStyle:m,position:[0,1,0],label:s[1]},x)),c.createElement(P,(0,E.A)({arcStyle:g,position:[0,0,1],label:s[2]},x)),!e&&c.createElement(c.Fragment,null,c.createElement(P,(0,E.A)({arcStyle:p,position:[-1,0,0]},x)),c.createElement(P,(0,E.A)({arcStyle:m,position:[0,-1,0]},x)),c.createElement(P,(0,E.A)({arcStyle:g,position:[0,0,-1]},x)))))};var A=r(89181),R=r(82044),C=r(79457);function T(e,{path:t}){let[r]=(0,u.G)(d.ScU,[e],e=>e.setPath(t));return r}T.preload=(e,{path:t})=>u.G.preload(d.ScU,[e],e=>e.setPath(t));var z=r(19125);let M=({url:e})=>{let{scene:t}=(0,u.C)(),r=T([`${e}/posx.jpg`,`${e}/negx.jpg`,`${e}/posy.jpg`,`${e}/negy.jpg`,`${e}/posz.jpg`,`${e}/negz.jpg`],{path:"/textures/skyBox/"});return(0,c.useEffect)(()=>{z.Ay.to(t,{duration:1,onUpdate:()=>{t.background=r}})},[r,t]),null};var B=r(85604),N=r(55444);let q=()=>{let{scene:e}=(0,B.p)("/models/monkey.glb");return(0,a.jsx)(c.Suspense,{fallback:(0,a.jsx)(N.o,{children:(0,a.jsx)(l.E,{children:"\u52A0\u8F7D\u4E2D"})}),children:(0,a.jsx)("primitive",{object:e})})},L=["skyBox1","skyBox2","skyBox3","skyBox4","skyBox5","skyBox6"],D=()=>{let[e,t]=(0,c.useState)("skyBox5"),[r,n]=(0,c.useState)(1.5);return(0,c.useEffect)(()=>{if("undefined"!=typeof window){n(window.innerWidth/window.innerHeight);let e=()=>{n(window.innerWidth/window.innerHeight)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}},[]),(0,a.jsxs)(R.A,{children:[(0,a.jsx)("div",{className:"tw:absolute tw:bg-[rgba(96,165,250,.7)] tw:left-0 tw:p-1 tw:rounded-br-lg tw:top-0 tw:z-1",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:"\u80CC\u666F\uFF1A"}),(0,a.jsx)("select",{onChange:e=>t(e.target.value),defaultValue:e,children:L.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})}),(0,a.jsx)(A.Hl,{gl:{preserveDrawingBuffer:!0},children:(0,a.jsxs)(c.Suspense,{fallback:(0,a.jsx)(l.E,{className:"flex h-full items-center justify-center w-full",children:(0,a.jsx)(C.A,{})}),children:[(0,a.jsxs)("group",{children:[(0,a.jsx)(s.N,{makeDefault:!0}),(0,a.jsx)("directionalLight",{position:[0,0,10]}),(0,a.jsx)("pointLight",{position:[0,0,10]}),(0,a.jsx)(o.u,{fov:75,aspect:r,near:.1,far:1e3,position:[2,3,2],lookAt:()=>[0,0,0]}),(0,a.jsx)(M,{url:e}),(0,a.jsx)(y,{alignment:"bottom-right",margin:[80,80],children:(0,a.jsx)(S,{})})]}),(0,a.jsx)("group",{children:(0,a.jsx)(q,{})})]})})]})},G={sidebar_position:19,title:"\u573A\u666F\u80CC\u666F\u5207\u6362",tags:["Javascript"]},I="\u573A\u666F\u80CC\u666F\u5207\u6362",W={},F=[{value:"\u6838\u5FC3\u6982\u5FF5",id:"\u6838\u5FC3\u6982\u5FF5",level:2}];function H(e){let t={h1:"h1",h2:"h2",header:"header",li:"li",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"\u573A\u666F\u80CC\u666F\u5207\u6362",children:"\u573A\u666F\u80CC\u666F\u5207\u6362"})}),"\n",(0,a.jsx)(D,{}),"\n",(0,a.jsx)(t.h2,{id:"\u6838\u5FC3\u6982\u5FF5",children:"\u6838\u5FC3\u6982\u5FF5"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"useCubeTexture"}),": \u52A0\u8F7D 6 \u5F20\u56FE\u7247\u7EC4\u6210\u7684\u7ACB\u65B9\u4F53\u7EB9\u7406\uFF0C\u7528\u4E8E\u521B\u5EFA\u73AF\u5883\u80CC\u666F"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"scene.background"}),": Three.js \u573A\u666F\u7684\u80CC\u666F\u7EB9\u7406\u5C5E\u6027"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"GSAP \u52A8\u753B"}),": \u4F7F\u7528 GSAP \u5E93\u5B9E\u73B0\u5E73\u6ED1\u7684\u80CC\u666F\u5207\u6362\u8FC7\u6E21\u6548\u679C"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"GizmoHelper"}),": \u663E\u793A\u5750\u6807\u7CFB\u548C\u89C6\u89D2\u5FEB\u6377\u6309\u94AE\uFF0C\u65B9\u4FBF\u8C03\u8BD5\u548C\u4EA4\u4E92"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Suspense"}),": React \u5F02\u6B65\u52A0\u8F7D\u673A\u5236\uFF0C\u7528\u4E8E\u5904\u7406\u6A21\u578B\u52A0\u8F7D\u7684\u5F02\u6B65\u64CD\u4F5C"]}),"\n"]})]})}function $(e={}){let{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(H,{...e})}):H(e)}},55444(e,t,r){r.d(t,{o:()=>l});var n=r(44320),a=r(67199),i=r(57140);let l=i.forwardRef(function({children:e,object:t,disable:r,disableX:l,disableY:s,disableZ:o,left:c,right:u,top:d,bottom:p,front:m,back:h,onCentered:g,precise:f=!0,cacheKey:x=0,...w},b){let j=i.useRef(null),v=i.useRef(null),y=i.useRef(null),[E]=i.useState(()=>new a.NRn),[k]=i.useState(()=>new a.Pq0),[P]=i.useState(()=>new a.iyt);return i.useLayoutEffect(()=>{v.current.matrixWorld.identity(),E.setFromObject(null!=t?t:y.current,f);let e=E.max.x-E.min.x,n=E.max.y-E.min.y,a=E.max.z-E.min.z;E.getCenter(k),E.getBoundingSphere(P);let i=d?n/2:p?-n/2:0,x=c?-e/2:u?e/2:0,w=m?a/2:h?-a/2:0;v.current.position.set(r||l?0:-k.x+x,r||s?0:-k.y+i,r||o?0:-k.z+w),null==g||g({parent:j.current.parent,container:j.current,width:e,height:n,depth:a,boundingBox:E,boundingSphere:P,center:k,verticalAlignment:i,horizontalAlignment:x,depthAlignment:w})},[x,g,d,c,m,r,l,s,o,t,f,u,p,h,E,k,P]),i.useImperativeHandle(b,()=>j.current,[]),i.createElement("group",(0,n.A)({ref:j},w),i.createElement("group",{ref:v},i.createElement("group",{ref:y},e)))})},47436(e,t,r){r.d(t,{u:()=>s});var n=r(44320),a=r(57140),i=r(46975),l=r(84644);let s=a.forwardRef(({envMap:e,resolution:t=256,frames:r=1/0,makeDefault:s,children:o,...c},u)=>{let d=(0,i.C)(({set:e})=>e),p=(0,i.C)(({camera:e})=>e),m=(0,i.C)(({size:e})=>e),h=a.useRef(null);a.useImperativeHandle(u,()=>h.current,[]);let g=a.useRef(null),f=(0,l.j)(t);a.useLayoutEffect(()=>{c.manual||(h.current.aspect=m.width/m.height)},[m,c]),a.useLayoutEffect(()=>{h.current.updateProjectionMatrix()});let x=0,w=null,b="function"==typeof o;return(0,i.D)(t=>{b&&(r===1/0||x<r)&&(g.current.visible=!1,t.gl.setRenderTarget(f),w=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,h.current),t.scene.background=w,t.gl.setRenderTarget(null),g.current.visible=!0,x++)}),a.useLayoutEffect(()=>{if(s)return d(()=>({camera:h.current})),()=>d(()=>({camera:p}))},[h,s,d]),a.createElement(a.Fragment,null,a.createElement("perspectiveCamera",(0,n.A)({ref:h},c),!b&&o),a.createElement("group",{ref:g},b&&o(f.texture)))})},79457(e,t,r){r.d(t,{A:()=>a});var n=r(35656);function a({loadText:e="Loading..."}){return(0,n.jsxs)("div",{className:"tw:absolute tw:left-1/2 tw:top-1/2 tw:-translate-1/2",children:[(0,n.jsxs)("div",{className:"tw:flex tw:flex-col tw:items-center tw:justify-center",children:[(0,n.jsxs)("div",{className:"tw:relative tw:w-20 tw:h-20 tw:mb-6",children:[(0,n.jsx)("div",{className:"tw:absolute tw:inset-0 tw:border-4 tw:border-primary tw:border-t-transparent tw:rounded-full tw:animate-spin"}),(0,n.jsx)("div",{className:"tw:absolute tw:inset-2 tw:border-4 tw:border-secondary tw:border-b-transparent tw:rounded-full animate-spin-reverse"})]}),(0,n.jsx)("div",{className:"tw:text-base-content tw:text-opacity-80 tw:text-sm tw:mb-1",children:e})]}),(0,n.jsx)("style",{children:`
					@keyframes spin-reverse {
						from {
							transform: rotate(360deg);
						}
						to {
							transform: rotate(0deg);
						}
					}
					.animate-spin-reverse {
						animation: spin-reverse 1.5s linear infinite;
					}
				`})]})}},39868(e,t,r){r.d(t,{r:()=>n});let n=parseInt(r(67199).sPf.replace(/\D+/g,""))}}]);