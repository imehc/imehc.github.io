import{a as t}from"./chunk-X2JOWFTB.js";import{a as e,b as i}from"./chunk-KIJM7B3H.js";import{a as n}from"./chunk-P44F6KLE.js";import{i as o}from"./chunk-IB27QQGF.js";import{a as r,b as s}from"./chunk-RGFEE67W.js";import{b as a,c as l}from"./chunk-KCR7AORG.js";import{a as c}from"./chunk-QDJTHWTA.js";import{a as p,b as h}from"./chunk-HTSQLHXI.js";import{e as f}from"./chunk-JDAHMWM5.js";var u=new r;function d(t,e){if(h.defined("origin",t),!f(t=(e=e??l.default).scaleToGeodeticSurface(t)))throw new p("origin must not be at the center of the ellipsoid.");let i=o.eastNorthUpToFixedFrame(t,e);this._ellipsoid=e,this._origin=t,this._xAxis=c.fromCartesian4(s.getColumn(i,0,u)),this._yAxis=c.fromCartesian4(s.getColumn(i,1,u));let r=c.fromCartesian4(s.getColumn(i,2,u));this._plane=n.fromPointNormal(t,r)}Object.defineProperties(d.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var m=new t;d.fromPoints=function(e,i){return h.defined("cartesians",e),new d(t.fromPoints(e,m).center,i)};var g=new e,_=new c;d.prototype.projectPointOntoPlane=function(t,e){h.defined("cartesian",t),g.origin=t,c.normalize(t,g.direction);let n=i.rayPlane(g,this._plane,_);if(f(n)||(c.negate(g.direction,g.direction),n=i.rayPlane(g,this._plane,_)),f(n)){let t=c.subtract(n,this._origin,n),i=c.dot(this._xAxis,t),o=c.dot(this._yAxis,t);return f(e)?(e.x=i,e.y=o,e):new a(i,o)}},d.prototype.projectPointsOntoPlane=function(t,e){h.defined("cartesians",t),f(e)||(e=[]);let i=0,n=t.length;for(let o=0;o<n;o++){let n=this.projectPointOntoPlane(t[o],e[i]);f(n)&&(e[i]=n,i++)}return e.length=i,e},d.prototype.projectPointToNearestOnPlane=function(t,e){h.defined("cartesian",t),f(e)||(e=new a),g.origin=t,c.clone(this._plane.normal,g.direction);let n=i.rayPlane(g,this._plane,_);f(n)||(c.negate(g.direction,g.direction),n=i.rayPlane(g,this._plane,_));let o=c.subtract(n,this._origin,n),r=c.dot(this._xAxis,o),s=c.dot(this._yAxis,o);return e.x=r,e.y=s,e},d.prototype.projectPointsToNearestOnPlane=function(t,e){h.defined("cartesians",t),f(e)||(e=[]);let i=t.length;e.length=i;for(let n=0;n<i;n++)e[n]=this.projectPointToNearestOnPlane(t[n],e[n]);return e};var y=new c;d.prototype.projectPointOntoEllipsoid=function(t,e){h.defined("cartesian",t),f(e)||(e=new c);let i=this._ellipsoid,n=this._origin,o=this._xAxis,r=this._yAxis;return c.multiplyByScalar(o,t.x,y),e=c.add(n,y,e),c.multiplyByScalar(r,t.y,y),c.add(e,y,e),i.scaleToGeocentricSurface(e,e),e},d.prototype.projectPointsOntoEllipsoid=function(t,e){h.defined("cartesians",t);let i=t.length;f(e)?e.length=i:e=Array(i);for(let n=0;n<i;++n)e[n]=this.projectPointOntoEllipsoid(t[n],e[n]);return e};var x=d;export{x as a};