import{a as e,c as a}from"./chunk-MRH6LWHV.js";import{a as t}from"./chunk-2A2JFXXO.js";import{h as r}from"./chunk-IB27QQGF.js";import{a as n,b as l}from"./chunk-QDJTHWTA.js";import{a as o}from"./chunk-2YWR3G22.js";import{e as i}from"./chunk-JDAHMWM5.js";var s={},u=new n,c=new n,y=new n,m=new n,d=[new n,new n],p=new n,g=new n,h=new n,f=new n,z=new n,w=new n,A=new n,x=new n,B=new n,E=new n,S=new r,D=new l;function b(a,t,i,s,y){let m,d=n.angleBetween(n.subtract(t,a,u),n.subtract(i,a,c)),p=s===e.BEVELED?1:Math.ceil(d/o.toRadians(5))+1,g=3*p,h=Array(g);h[g-3]=i.x,h[g-2]=i.y,h[g-1]=i.z,m=y?l.fromQuaternion(r.fromAxisAngle(n.negate(a,u),d/p,S),D):l.fromQuaternion(r.fromAxisAngle(a,d/p,S),D);let f=0;t=n.clone(t,u);for(let e=0;e<p;e++)t=l.multiplyByVector(m,t,t),h[f++]=t.x,h[f++]=t.y,h[f++]=t.z;return h}function N(e,a,t,r){let l=u;return r||(a=n.negate(a,a)),[(l=n.add(e,a,l)).x,l.y,l.z,t.x,t.y,t.z]}function P(e,a,t,r){let l=Array(e.length),o=Array(e.length),i=n.multiplyByScalar(a,t,u),s=n.negate(i,c),d=0,p=e.length-1;for(let a=0;a<e.length;a+=3){let t=n.fromArray(e,a,y),r=n.add(t,s,m);l[d++]=r.x,l[d++]=r.y,l[d++]=r.z;let u=n.add(t,i,m);o[p--]=u.z,o[p--]=u.y,o[p--]=u.x}return r.push(l,o),r}s.addAttribute=function(e,a,t,r){let n=a.x,l=a.y,o=a.z;i(t)&&(e[t]=n,e[t+1]=l,e[t+2]=o),i(r)&&(e[r]=o,e[r-1]=l,e[r-2]=n)};var R=new n,v=new n;s.computePositions=function(r){var l;let i,s,c,y,m,S,D,O,j=r.granularity,k=r.positions,M=r.ellipsoid,L=r.width/2,Q=r.cornerType,U=r.saveAttributes,V=p,H=g,T=h,W=f,G=z,I=w,J=A,F=x,X=B,q=E,Y=[],C=U?[]:void 0,K=U?[]:void 0,Z=k[0],$=k[1];H=n.normalize(n.subtract($,Z,H),H),V=M.geodeticSurfaceNormal(Z,V),W=n.normalize(n.cross(V,H,W),W),U&&(C.push(W.x,W.y,W.z),K.push(V.x,V.y,V.z)),J=n.clone(Z,J),Z=$,T=n.negate(H,T);let _=[],ee,ea=k.length;for(ee=1;ee<ea-1;ee++){V=M.geodeticSurfaceNormal(Z,V),$=k[ee+1],H=n.normalize(n.subtract($,Z,H),H);let r=n.multiplyByScalar(V,n.dot(H,V),R);n.subtract(H,r,r),n.normalize(r,r);let l=n.multiplyByScalar(V,n.dot(T,V),v);if(n.subtract(T,l,l),n.normalize(l,l),!o.equalsEpsilon(Math.abs(n.dot(r,l)),1,o.EPSILON7)){G=n.normalize(n.add(H,T,G),G),G=n.cross(G,V,G),G=n.cross(V,G,G),G=n.normalize(G,G);let r=L/Math.max(.25,n.magnitude(n.cross(G,T,u))),l=a.angleIsGreaterThanPi(H,T,Z,M);G=n.multiplyByScalar(G,r,G),l?(F=n.add(Z,G,F),q=n.add(F,n.multiplyByScalar(W,L,q),q),X=n.add(F,n.multiplyByScalar(W,2*L,X),X),d[0]=n.clone(J,d[0]),d[1]=n.clone(q,d[1]),Y=P(t.generateArc({positions:d,granularity:j,ellipsoid:M}),W,L,Y),U&&(C.push(W.x,W.y,W.z),K.push(V.x,V.y,V.z)),I=n.clone(X,I),W=n.normalize(n.cross(V,H,W),W),X=n.add(F,n.multiplyByScalar(W,2*L,X),X),J=n.add(F,n.multiplyByScalar(W,L,J),J),Q===e.ROUNDED||Q===e.BEVELED?_.push({leftPositions:b(F,I,X,Q,l)}):_.push({leftPositions:N(Z,n.negate(G,G),X,l)})):(X=n.add(Z,G,X),q=n.add(X,n.negate(n.multiplyByScalar(W,L,q),q),q),F=n.add(X,n.negate(n.multiplyByScalar(W,2*L,F),F),F),d[0]=n.clone(J,d[0]),d[1]=n.clone(q,d[1]),Y=P(t.generateArc({positions:d,granularity:j,ellipsoid:M}),W,L,Y),U&&(C.push(W.x,W.y,W.z),K.push(V.x,V.y,V.z)),I=n.clone(F,I),W=n.normalize(n.cross(V,H,W),W),F=n.add(X,n.negate(n.multiplyByScalar(W,2*L,F),F),F),J=n.add(X,n.negate(n.multiplyByScalar(W,L,J),J),J),Q===e.ROUNDED||Q===e.BEVELED?_.push({rightPositions:b(X,I,F,Q,l)}):_.push({rightPositions:N(Z,G,F,l)})),T=n.negate(H,T)}Z=$}return V=M.geodeticSurfaceNormal(Z,V),d[0]=n.clone(J,d[0]),d[1]=n.clone(Z,d[1]),Y=P(t.generateArc({positions:d,granularity:j,ellipsoid:M}),W,L,Y),U&&(C.push(W.x,W.y,W.z),K.push(V.x,V.y,V.z)),Q===e.ROUNDED&&(l=Y,i=p,s=g,c=h,y=l[1],s=n.fromArray(l[1],y.length-3,s),c=n.fromArray(l[0],0,c),m=b(i=n.midpoint(s,c,i),s,c,e.ROUNDED,!1),S=l.length-1,D=l[S-1],y=l[S],s=n.fromArray(D,D.length-3,s),c=n.fromArray(y,0,c),O=[m,b(i=n.midpoint(s,c,i),s,c,e.ROUNDED,!1)]),{positions:Y,corners:_,lefts:C,normals:K,endPositions:O}};var O=s;export{O as a};