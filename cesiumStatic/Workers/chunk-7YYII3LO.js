import{a as e,c as a}from"./chunk-KSAXP2ON.js";import{a as t}from"./chunk-JZMSTCXO.js";import{h as r}from"./chunk-4NDD6KRQ.js";import{a as n,b as l}from"./chunk-G2EMNOST.js";import{a as o}from"./chunk-4VFKVGYI.js";import{e as i}from"./chunk-XCN226AA.js";var s={},u=new n,c=new n,y=new n,m=new n,d=[new n,new n],p=new n,g=new n,h=new n,f=new n,z=new n,w=new n,A=new n,x=new n,S=new n,B=new n,E=new r,D=new l;function N(a,t,i,s,y){let m,d=n.angleBetween(n.subtract(t,a,u),n.subtract(i,a,c)),p=s===e.BEVELED?1:Math.ceil(d/o.toRadians(5))+1,g=3*p,h=Array(g);h[g-3]=i.x,h[g-2]=i.y,h[g-1]=i.z,m=y?l.fromQuaternion(r.fromAxisAngle(n.negate(a,u),d/p,E),D):l.fromQuaternion(r.fromAxisAngle(a,d/p,E),D);let f=0;t=n.clone(t,u);for(let e=0;e<p;e++)t=l.multiplyByVector(m,t,t),h[f++]=t.x,h[f++]=t.y,h[f++]=t.z;return h}function b(e,a,t,r){let l=u;return r||(a=n.negate(a,a)),[(l=n.add(e,a,l)).x,l.y,l.z,t.x,t.y,t.z]}function O(e,a,t,r){let l=Array(e.length),o=Array(e.length),i=n.multiplyByScalar(a,t,u),s=n.negate(i,c),d=0,p=e.length-1;for(let a=0;a<e.length;a+=3){let t=n.fromArray(e,a,y),r=n.add(t,s,m);l[d++]=r.x,l[d++]=r.y,l[d++]=r.z;let u=n.add(t,i,m);o[p--]=u.z,o[p--]=u.y,o[p--]=u.x}return r.push(l,o),r}s.addAttribute=function(e,a,t,r){let n=a.x,l=a.y,o=a.z;i(t)&&(e[t]=n,e[t+1]=l,e[t+2]=o),i(r)&&(e[r]=o,e[r-1]=l,e[r-2]=n)};var P=new n,v=new n;s.computePositions=function(r){var l;let i,s,c,y,m,E,D,R,j=r.granularity,k=r.positions,V=r.ellipsoid,M=r.width/2,U=r.cornerType,L=r.saveAttributes,T=p,G=g,I=h,K=f,Q=z,X=w,C=A,q=x,F=S,J=B,Y=[],Z=L?[]:void 0,H=L?[]:void 0,W=k[0],$=k[1];G=n.normalize(n.subtract($,W,G),G),T=V.geodeticSurfaceNormal(W,T),K=n.normalize(n.cross(T,G,K),K),L&&(Z.push(K.x,K.y,K.z),H.push(T.x,T.y,T.z)),C=n.clone(W,C),W=$,I=n.negate(G,I);let _=[],ee,ea=k.length;for(ee=1;ee<ea-1;ee++){T=V.geodeticSurfaceNormal(W,T),$=k[ee+1],G=n.normalize(n.subtract($,W,G),G);let r=n.multiplyByScalar(T,n.dot(G,T),P);n.subtract(G,r,r),n.normalize(r,r);let l=n.multiplyByScalar(T,n.dot(I,T),v);if(n.subtract(I,l,l),n.normalize(l,l),!o.equalsEpsilon(Math.abs(n.dot(r,l)),1,o.EPSILON7)){Q=n.normalize(n.add(G,I,Q),Q),Q=n.cross(Q,T,Q),Q=n.cross(T,Q,Q),Q=n.normalize(Q,Q);let r=M/Math.max(.25,n.magnitude(n.cross(Q,I,u))),l=a.angleIsGreaterThanPi(G,I,W,V);Q=n.multiplyByScalar(Q,r,Q),l?(q=n.add(W,Q,q),J=n.add(q,n.multiplyByScalar(K,M,J),J),F=n.add(q,n.multiplyByScalar(K,2*M,F),F),d[0]=n.clone(C,d[0]),d[1]=n.clone(J,d[1]),Y=O(t.generateArc({positions:d,granularity:j,ellipsoid:V}),K,M,Y),L&&(Z.push(K.x,K.y,K.z),H.push(T.x,T.y,T.z)),X=n.clone(F,X),K=n.normalize(n.cross(T,G,K),K),F=n.add(q,n.multiplyByScalar(K,2*M,F),F),C=n.add(q,n.multiplyByScalar(K,M,C),C),U===e.ROUNDED||U===e.BEVELED?_.push({leftPositions:N(q,X,F,U,l)}):_.push({leftPositions:b(W,n.negate(Q,Q),F,l)})):(F=n.add(W,Q,F),J=n.add(F,n.negate(n.multiplyByScalar(K,M,J),J),J),q=n.add(F,n.negate(n.multiplyByScalar(K,2*M,q),q),q),d[0]=n.clone(C,d[0]),d[1]=n.clone(J,d[1]),Y=O(t.generateArc({positions:d,granularity:j,ellipsoid:V}),K,M,Y),L&&(Z.push(K.x,K.y,K.z),H.push(T.x,T.y,T.z)),X=n.clone(q,X),K=n.normalize(n.cross(T,G,K),K),q=n.add(F,n.negate(n.multiplyByScalar(K,2*M,q),q),q),C=n.add(F,n.negate(n.multiplyByScalar(K,M,C),C),C),U===e.ROUNDED||U===e.BEVELED?_.push({rightPositions:N(F,X,q,U,l)}):_.push({rightPositions:b(W,Q,q,l)})),I=n.negate(G,I)}W=$}return T=V.geodeticSurfaceNormal(W,T),d[0]=n.clone(C,d[0]),d[1]=n.clone(W,d[1]),Y=O(t.generateArc({positions:d,granularity:j,ellipsoid:V}),K,M,Y),L&&(Z.push(K.x,K.y,K.z),H.push(T.x,T.y,T.z)),U===e.ROUNDED&&(l=Y,i=p,s=g,c=h,y=l[1],s=n.fromArray(l[1],y.length-3,s),c=n.fromArray(l[0],0,c),m=N(i=n.midpoint(s,c,i),s,c,e.ROUNDED,!1),E=l.length-1,D=l[E-1],y=l[E],s=n.fromArray(D,D.length-3,s),c=n.fromArray(y,0,c),R=[m,N(i=n.midpoint(s,c,i),s,c,e.ROUNDED,!1)]),{positions:Y,corners:_,lefts:Z,normals:H,endPositions:R}};var R=s;export{R as a};