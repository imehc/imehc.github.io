import{a as t}from"./chunk-SI3KZUTO.js";import{a as e}from"./chunk-HVWI7BO6.js";import{b as n,c as a}from"./chunk-BNHFHP3L.js";import{a as r}from"./chunk-4UHVCH4T.js";import{j as o}from"./chunk-4NDD6KRQ.js";import{b as i}from"./chunk-5ELDAYCN.js";import{a as s,b as c,c as u}from"./chunk-ICY67TC6.js";import{a as l,b as d}from"./chunk-G2EMNOST.js";import{a as h}from"./chunk-4VFKVGYI.js";import{a as m,b as f}from"./chunk-3WJNS2B6.js";import{e as w}from"./chunk-XCN226AA.js";function p(t,e){this.center=l.clone(t??l.ZERO),this.halfAxes=d.clone(e??d.ZERO)}p.packedLength=l.packedLength+d.packedLength,p.pack=function(t,e,n){return f.typeOf.object("value",t),f.defined("array",e),n=n??0,l.pack(t.center,e,n),d.pack(t.halfAxes,e,n+l.packedLength),e},p.unpack=function(t,e,n){return f.defined("array",t),e=e??0,w(n)||(n=new p),l.unpack(t,e,n.center),d.unpack(t,e+l.packedLength,n.halfAxes),n};var x=new l,b=new l,y=new l,g=new l,M=new l,O=new l,N=new d,A={unitary:new d,diagonal:new d};p.fromPoints=function(t,e){if(w(e)||(e=new p),!w(t)||0===t.length)return e.halfAxes=d.ZERO,e.center=l.ZERO,e;let n,a=t.length,r=l.clone(t[0],x);for(n=1;n<a;n++)l.add(r,t[n],r);let o=1/a;l.multiplyByScalar(r,o,r);let i=0,s=0,c=0,u=0,h=0,m=0,f;for(n=0;n<a;n++)i+=(f=l.subtract(t[n],r,b)).x*f.x,s+=f.x*f.y,c+=f.x*f.z,u+=f.y*f.y,h+=f.y*f.z,m+=f.z*f.z;i*=o,s*=o,c*=o,u*=o,h*=o,m*=o,N[0]=i,N[1]=s,N[2]=c,N[3]=s,N[4]=u,N[5]=h,N[6]=c,N[7]=h,N[8]=m;let C=d.computeEigenDecomposition(N,A),T=d.clone(C.unitary,e.halfAxes),P=d.getColumn(T,0,g),R=d.getColumn(T,1,M),U=d.getColumn(T,2,O),L=-Number.MAX_VALUE,S=-Number.MAX_VALUE,E=-Number.MAX_VALUE,I=Number.MAX_VALUE,j=Number.MAX_VALUE,k=Number.MAX_VALUE;for(n=0;n<a;n++)f=t[n],L=Math.max(l.dot(P,f),L),S=Math.max(l.dot(R,f),S),E=Math.max(l.dot(U,f),E),I=Math.min(l.dot(P,f),I),j=Math.min(l.dot(R,f),j),k=Math.min(l.dot(U,f),k);P=l.multiplyByScalar(P,.5*(I+L),P),R=l.multiplyByScalar(R,.5*(j+S),R),U=l.multiplyByScalar(U,.5*(k+E),U);let q=l.add(P,R,e.center);return l.add(q,U,q),y.x=L-I,y.y=S-j,y.z=E-k,l.multiplyByScalar(y,.5,y),d.multiplyByScale(e.halfAxes,y,e.halfAxes),e};var C=new l,T=new l;function P(t,e,n,a,r,o,i,s,c,u,h){if(!w(r)||!w(o)||!w(i)||!w(s)||!w(c)||!w(u))throw new m("all extents (minimum/maximum X/Y/Z) are required.");w(h)||(h=new p);let f=h.halfAxes;d.setColumn(f,0,e,f),d.setColumn(f,1,n,f),d.setColumn(f,2,a,f);let x=C;x.x=(r+o)/2,x.y=(i+s)/2,x.z=(c+u)/2,T.x=(o-r)/2,T.y=(s-i)/2,T.z=(u-c)/2;let b=h.center;return x=d.multiplyByVector(f,x,x),l.add(t,x,b),d.multiplyByScale(f,T,f),h}var R=new s,U=new l,L=new s,S=new s,E=new s,I=new s,j=new s,k=new l,q=new l,z=new l,B=new l,_=new l,v=new c,V=new c,W=new c,D=new c,X=new c,Z=new l,Y=new l,H=new l,G=new l,K=new c,F=new l,J=new l,Q=new l,$=new e(l.UNIT_X,0);p.fromRectangle=function(n,a,r,i,c){let d,f,p,x,b,y,g;if(!w(n))throw new m("rectangle is required");if(n.width<0||n.width>h.TWO_PI)throw new m("Rectangle width must be between 0 and 2 * pi");if(n.height<0||n.height>h.PI)throw new m("Rectangle height must be between 0 and pi");if(w(i)&&!h.equalsEpsilon(i.radii.x,i.radii.y,h.EPSILON15))throw new m("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");if(a=a??0,r=r??0,i=i??u.default,n.width<=h.PI){let u=o.center(n,R),l=new t(i.cartographicToCartesian(u,U),i);g=l.plane;let h=u.longitude,m=n.south<0&&n.north>0?0:u.latitude,w=s.fromRadians(h,n.north,r,L),M=s.fromRadians(n.west,n.north,r,S),O=s.fromRadians(n.west,m,r,E),N=s.fromRadians(n.west,n.south,r,I),A=s.fromRadians(h,n.south,r,j),C=i.cartographicToCartesian(w,k),T=i.cartographicToCartesian(M,q),Z=i.cartographicToCartesian(O,z),Y=i.cartographicToCartesian(N,B),H=i.cartographicToCartesian(A,_),G=l.projectPointToNearestOnPlane(C,v),K=l.projectPointToNearestOnPlane(T,V),F=l.projectPointToNearestOnPlane(Z,W),J=l.projectPointToNearestOnPlane(Y,D),Q=l.projectPointToNearestOnPlane(H,X);return f=-(d=Math.min(K.x,F.x,J.x)),x=Math.max(K.y,G.y),p=Math.min(J.y,Q.y),M.height=N.height=a,T=i.cartographicToCartesian(M,q),Y=i.cartographicToCartesian(N,B),b=Math.min(e.getPointDistance(g,T),e.getPointDistance(g,Y)),y=r,P(l.origin,l.xAxis,l.yAxis,l.zAxis,d,f,p,x,b,y,c)}let M=n.south>0,O=n.north<0,N=M?n.south:O?n.north:0,A=o.center(n,R).longitude,C=l.fromRadians(A,N,r,i,Z);C.z=0;let T=Math.abs(C.x)<h.EPSILON10&&Math.abs(C.y)<h.EPSILON10?l.UNIT_X:l.normalize(C,Y),tt=l.UNIT_Z,te=l.cross(T,tt,H);g=e.fromPointNormal(C,T,$);let tn=l.fromRadians(A+h.PI_OVER_TWO,N,r,i,G);d=-(f=l.dot(e.projectPointOntoPlane(g,tn,K),te)),x=l.fromRadians(0,n.north,O?a:r,i,F).z,p=l.fromRadians(0,n.south,M?a:r,i,J).z;let ta=l.fromRadians(n.east,N,r,i,Q);return P(C,te,tt,T,d,f,p,x,b=e.getPointDistance(g,ta),y=0,c)},p.fromTransformation=function(t,e){return f.typeOf.object("transformation",t),w(e)||(e=new p),e.center=i.getTranslation(t,e.center),e.halfAxes=i.getMatrix3(t,e.halfAxes),e.halfAxes=d.multiplyByScalar(e.halfAxes,.5,e.halfAxes),e},p.clone=function(t,e){if(w(t))return w(e)?(l.clone(t.center,e.center),d.clone(t.halfAxes,e.halfAxes),e):new p(t.center,t.halfAxes)},p.intersectPlane=function(t,e){if(!w(t))throw new m("box is required.");if(!w(e))throw new m("plane is required.");let n=t.center,a=e.normal,o=t.halfAxes,i=a.x,s=a.y,c=a.z,u=Math.abs(i*o[d.COLUMN0ROW0]+s*o[d.COLUMN0ROW1]+c*o[d.COLUMN0ROW2])+Math.abs(i*o[d.COLUMN1ROW0]+s*o[d.COLUMN1ROW1]+c*o[d.COLUMN1ROW2])+Math.abs(i*o[d.COLUMN2ROW0]+s*o[d.COLUMN2ROW1]+c*o[d.COLUMN2ROW2]),h=l.dot(a,n)+e.distance;return h<=-u?r.OUTSIDE:h>=u?r.INSIDE:r.INTERSECTING};var tt=new l,te=new l,tn=new l,ta=new l,tr=new l,to=new l;p.distanceSquaredTo=function(t,e){if(!w(t))throw new m("box is required.");if(!w(e))throw new m("cartesian is required.");let n=l.subtract(e,t.center,C),a=t.halfAxes,r=d.getColumn(a,0,tt),o=d.getColumn(a,1,te),i=d.getColumn(a,2,tn),s=l.magnitude(r),c=l.magnitude(o),u=l.magnitude(i),f=!0,p=!0,x=!0;s>0?l.divideByScalar(r,s,r):f=!1,c>0?l.divideByScalar(o,c,o):p=!1,u>0?l.divideByScalar(i,u,i):x=!1;let b=!f+!p+!x,y,g,M;if(1===b){let t=r;y=o,g=i,p?x||(t=i,g=r):(t=o,y=r),M=l.cross(y,g,tr),t===r?r=M:t===o?o=M:t===i&&(i=M)}else if(2===b){y=r,p?y=o:x&&(y=i);let t=l.UNIT_Y;t.equalsEpsilon(y,h.EPSILON3)&&(t=l.UNIT_X),g=l.cross(y,t,ta),l.normalize(g,g),M=l.cross(y,g,tr),l.normalize(M,M),y===r?(o=g,i=M):y===o?(i=g,r=M):y===i&&(r=g,o=M)}else 3===b&&(r=l.UNIT_X,o=l.UNIT_Y,i=l.UNIT_Z);to.x=l.dot(n,r),to.y=l.dot(n,o),to.z=l.dot(n,i);let O=0,N;return to.x<-s?O+=(N=to.x+s)*N:to.x>s&&(O+=(N=to.x-s)*N),to.y<-c?O+=(N=to.y+c)*N:to.y>c&&(O+=(N=to.y-c)*N),to.z<-u?O+=(N=to.z+u)*N:to.z>u&&(O+=(N=to.z-u)*N),O};var ti=new l,ts=new l;p.computePlaneDistances=function(t,e,a,r){if(!w(t))throw new m("box is required.");if(!w(e))throw new m("position is required.");if(!w(a))throw new m("direction is required.");w(r)||(r=new n);let o=1/0,i=-1/0,s=t.center,c=t.halfAxes,u=d.getColumn(c,0,tt),h=d.getColumn(c,1,te),f=d.getColumn(c,2,tn),p=l.add(u,h,ti);l.add(p,f,p),l.add(p,s,p);let x=l.subtract(p,e,ts),b=l.dot(a,x);return o=Math.min(b,o),i=Math.max(b,i),l.add(s,u,p),l.add(p,h,p),l.subtract(p,f,p),l.subtract(p,e,x),o=Math.min(b=l.dot(a,x),o),i=Math.max(b,i),l.add(s,u,p),l.subtract(p,h,p),l.add(p,f,p),l.subtract(p,e,x),o=Math.min(b=l.dot(a,x),o),i=Math.max(b,i),l.add(s,u,p),l.subtract(p,h,p),l.subtract(p,f,p),l.subtract(p,e,x),o=Math.min(b=l.dot(a,x),o),i=Math.max(b,i),l.subtract(s,u,p),l.add(p,h,p),l.add(p,f,p),l.subtract(p,e,x),o=Math.min(b=l.dot(a,x),o),i=Math.max(b,i),l.subtract(s,u,p),l.add(p,h,p),l.subtract(p,f,p),l.subtract(p,e,x),o=Math.min(b=l.dot(a,x),o),i=Math.max(b,i),l.subtract(s,u,p),l.subtract(p,h,p),l.add(p,f,p),l.subtract(p,e,x),o=Math.min(b=l.dot(a,x),o),i=Math.max(b,i),l.subtract(s,u,p),l.subtract(p,h,p),l.subtract(p,f,p),l.subtract(p,e,x),o=Math.min(b=l.dot(a,x),o),i=Math.max(b,i),r.start=o,r.stop=i,r};var tc=new l,tu=new l,tl=new l;p.computeCorners=function(t,e){f.typeOf.object("box",t),w(e)||(e=[new l,new l,new l,new l,new l,new l,new l,new l]);let n=t.center,a=t.halfAxes,r=d.getColumn(a,0,tc),o=d.getColumn(a,1,tu),i=d.getColumn(a,2,tl);return l.clone(n,e[0]),l.subtract(e[0],r,e[0]),l.subtract(e[0],o,e[0]),l.subtract(e[0],i,e[0]),l.clone(n,e[1]),l.subtract(e[1],r,e[1]),l.subtract(e[1],o,e[1]),l.add(e[1],i,e[1]),l.clone(n,e[2]),l.subtract(e[2],r,e[2]),l.add(e[2],o,e[2]),l.subtract(e[2],i,e[2]),l.clone(n,e[3]),l.subtract(e[3],r,e[3]),l.add(e[3],o,e[3]),l.add(e[3],i,e[3]),l.clone(n,e[4]),l.add(e[4],r,e[4]),l.subtract(e[4],o,e[4]),l.subtract(e[4],i,e[4]),l.clone(n,e[5]),l.add(e[5],r,e[5]),l.subtract(e[5],o,e[5]),l.add(e[5],i,e[5]),l.clone(n,e[6]),l.add(e[6],r,e[6]),l.add(e[6],o,e[6]),l.subtract(e[6],i,e[6]),l.clone(n,e[7]),l.add(e[7],r,e[7]),l.add(e[7],o,e[7]),l.add(e[7],i,e[7]),e};var td=new d;p.computeTransformation=function(t,e){f.typeOf.object("box",t),w(e)||(e=new i);let n=t.center,a=d.multiplyByUniformScale(t.halfAxes,2,td);return i.fromRotationTranslation(a,n,e)};var th=new a;p.isOccluded=function(t,e){if(!w(t))throw new m("box is required.");if(!w(e))throw new m("occluder is required.");let n=a.fromOrientedBoundingBox(t,th);return!e.isBoundingSphereVisible(n)},p.prototype.intersectPlane=function(t){return p.intersectPlane(this,t)},p.prototype.distanceSquaredTo=function(t){return p.distanceSquaredTo(this,t)},p.prototype.computePlaneDistances=function(t,e,n){return p.computePlaneDistances(this,t,e,n)},p.prototype.computeCorners=function(t){return p.computeCorners(this,t)},p.prototype.computeTransformation=function(t){return p.computeTransformation(this,t)},p.prototype.isOccluded=function(t){return p.isOccluded(this,t)},p.equals=function(t,e){return t===e||w(t)&&w(e)&&l.equals(t.center,e.center)&&d.equals(t.halfAxes,e.halfAxes)},p.prototype.clone=function(t){return p.clone(this,t)},p.prototype.equals=function(t){return p.equals(this,t)};var tm=p;export{tm as a};