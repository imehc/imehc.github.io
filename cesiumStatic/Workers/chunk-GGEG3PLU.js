import{a as t}from"./chunk-MABAS5D2.js";import{a as e}from"./chunk-PXD6ATBI.js";import{a as i}from"./chunk-GSMLTRAL.js";import{a as n}from"./chunk-IUX576XK.js";import{b as a,c as r,d as o}from"./chunk-UIGT6VOJ.js";import{c as m}from"./chunk-XO2FNJZK.js";import{a as s}from"./chunk-KXT7EZPS.js";import{b as c,c as u}from"./chunk-KCR7AORG.js";import{a as l,c as f}from"./chunk-QDJTHWTA.js";import{a as p}from"./chunk-2YWR3G22.js";import{a as h}from"./chunk-HTSQLHXI.js";import{e as _}from"./chunk-JDAHMWM5.js";var d,k=new l,A=new l,y=new l,w=new l,P=new l,x=new l(1,1,1),v=Math.cos,C=Math.sin;function b(t){let i=(t=t??f.EMPTY_OBJECT).radii??x,n=t.innerRadii??i,a=t.minimumClock??0,r=t.maximumClock??p.TWO_PI,o=t.minimumCone??0,m=t.maximumCone??p.PI,s=Math.round(t.stackPartitions??64),c=Math.round(t.slicePartitions??64),u=t.vertexFormat??e.DEFAULT;if(c<3)throw new h("options.slicePartitions cannot be less than three.");if(s<3)throw new h("options.stackPartitions cannot be less than three.");this._radii=l.clone(i),this._innerRadii=l.clone(n),this._minimumClock=a,this._maximumClock=r,this._minimumCone=o,this._maximumCone=m,this._stackPartitions=s,this._slicePartitions=c,this._vertexFormat=e.clone(u),this._offsetAttribute=t.offsetAttribute,this._workerName="createEllipsoidGeometry"}b.packedLength=2*l.packedLength+e.packedLength+7,b.pack=function(t,i,n){if(!_(t))throw new h("value is required");if(!_(i))throw new h("array is required");return n=n??0,l.pack(t._radii,i,n),n+=l.packedLength,l.pack(t._innerRadii,i,n),n+=l.packedLength,e.pack(t._vertexFormat,i,n),n+=e.packedLength,i[n++]=t._minimumClock,i[n++]=t._maximumClock,i[n++]=t._minimumCone,i[n++]=t._maximumCone,i[n++]=t._stackPartitions,i[n++]=t._slicePartitions,i[n]=t._offsetAttribute??-1,i};var g=new l,T=new l,L=new e,F={radii:g,innerRadii:T,vertexFormat:L,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};b.unpack=function(t,i,n){if(!_(t))throw new h("array is required");i=i??0;let a=l.unpack(t,i,g);i+=l.packedLength;let r=l.unpack(t,i,T);i+=l.packedLength;let o=e.unpack(t,i,L);i+=e.packedLength;let m=t[i++],s=t[i++],c=t[i++],u=t[i++],f=t[i++],p=t[i++],d=t[i];return _(n)?(n._radii=l.clone(a,n._radii),n._innerRadii=l.clone(r,n._innerRadii),n._vertexFormat=e.clone(o,n._vertexFormat),n._minimumClock=m,n._maximumClock=s,n._minimumCone=c,n._maximumCone=u,n._stackPartitions=f,n._slicePartitions=p,n._offsetAttribute=-1===d?void 0:d,n):(F.minimumClock=m,F.maximumClock=s,F.minimumCone=c,F.maximumCone=u,F.stackPartitions=f,F.slicePartitions=p,F.offsetAttribute=-1===d?void 0:d,new b(F))},b.createGeometry=function(e){let f,h,d,x,b=e._radii;if(b.x<=0||b.y<=0||b.z<=0)return;let g=e._innerRadii;if(g.x<=0||g.y<=0||g.z<=0)return;let T=e._minimumClock,L=e._maximumClock,F=e._minimumCone,I=e._maximumCone,O=e._vertexFormat,M=e._slicePartitions+1,D=e._stackPartitions+1;M=Math.round(M*Math.abs(L-T)/p.TWO_PI),D=Math.round(D*Math.abs(I-F)/p.PI),M<2&&(M=2),D<2&&(D=2);let j,z,E=0,N=[F],R=[T];for(j=0;j<D;j++)N.push(F+j*(I-F)/(D-1));for(N.push(I),z=0;z<M;z++)R.push(T+z*(L-T)/(M-1));R.push(L);let G=N.length,S=R.length,U=0,W=1,X=g.x!==b.x||g.y!==b.y||g.z!==b.z,B=!1,J=!1,K=!1;X&&(W=2,F>0&&(B=!0,U+=M-1),I<Math.PI&&(J=!0,U+=M-1),(L-T)%p.TWO_PI?(K=!0,U+=(D-1)*2+1):U+=1);let H=S*G*W,Y=new Float64Array(3*H),q=Array(H).fill(!1),Z=Array(H).fill(!1),Q=M*D*W,V=6*(Q+U+1-(M+D)*W),$=i.createTypedArray(Q,V),tt=O.normal?new Float32Array(3*H):void 0,te=O.tangent?new Float32Array(3*H):void 0,ti=O.bitangent?new Float32Array(3*H):void 0,tn=O.st?new Float32Array(2*H):void 0,ta=Array(G),tr=Array(G);for(j=0;j<G;j++)ta[j]=C(N[j]),tr[j]=v(N[j]);let to=Array(S),tm=Array(S);for(z=0;z<S;z++)tm[z]=v(R[z]),to[z]=C(R[z]);for(j=0;j<G;j++)for(z=0;z<S;z++)Y[E++]=b.x*ta[j]*tm[z],Y[E++]=b.y*ta[j]*to[z],Y[E++]=b.z*tr[j];let ts=H/2;if(X)for(j=0;j<G;j++)for(z=0;z<S;z++)Y[E++]=g.x*ta[j]*tm[z],Y[E++]=g.y*ta[j]*to[z],Y[E++]=g.z*tr[j],q[ts]=!0,j>0&&j!==G-1&&0!==z&&z!==S-1&&(Z[ts]=!0),ts++;for(j=1,E=0;j<G-2;j++)for(f=j*S,h=(j+1)*S,z=1;z<S-2;z++)$[E++]=h+z,$[E++]=h+z+1,$[E++]=f+z+1,$[E++]=h+z,$[E++]=f+z+1,$[E++]=f+z;if(X){let t=G*S;for(j=1;j<G-2;j++)for(f=t+j*S,h=t+(j+1)*S,z=1;z<S-2;z++)$[E++]=h+z,$[E++]=f+z,$[E++]=f+z+1,$[E++]=h+z,$[E++]=f+z+1,$[E++]=h+z+1}if(X){if(B)for(x=G*S,j=1;j<S-2;j++)$[E++]=j,$[E++]=j+1,$[E++]=x+j+1,$[E++]=j,$[E++]=x+j+1,$[E++]=x+j;if(J)for(d=G*S-S,x=G*S*W-S,j=1;j<S-2;j++)$[E++]=d+j+1,$[E++]=d+j,$[E++]=x+j,$[E++]=d+j+1,$[E++]=x+j,$[E++]=x+j+1}if(K){for(j=1;j<G-2;j++)x=S*G+S*j,d=S*j,$[E++]=x,$[E++]=d+S,$[E++]=d,$[E++]=x,$[E++]=x+S,$[E++]=d+S;for(j=1;j<G-2;j++)x=S*G+S*(j+1)-1,d=S*(j+1)-1,$[E++]=d+S,$[E++]=x,$[E++]=d,$[E++]=d+S,$[E++]=x+S,$[E++]=x}let tc=new n;O.position&&(tc.position=new o({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:Y}));let tu=0,tl=0,tf=0,tp=0,th=H/2,t_,td=u.fromCartesian3(b),tk=u.fromCartesian3(g);if(O.st||O.normal||O.tangent||O.bitangent){for(j=0;j<H;j++){t_=q[j]?tk:td;let t=l.fromArray(Y,3*j,k),e=t_.geodeticSurfaceNormal(t,A);if(Z[j]&&l.negate(e,e),O.st){let t=c.negate(e,P);tn[tu++]=Math.atan2(t.y,t.x)/p.TWO_PI+.5,tn[tu++]=Math.asin(e.z)/Math.PI+.5}if(O.normal&&(tt[tl++]=e.x,tt[tl++]=e.y,tt[tl++]=e.z),O.tangent||O.bitangent){let t=0,i;if(q[j]&&(t=th),i=!B&&j>=t&&j<t+2*S?l.UNIT_X:l.UNIT_Z,l.cross(i,e,y),l.normalize(y,y),O.tangent&&(te[tf++]=y.x,te[tf++]=y.y,te[tf++]=y.z),O.bitangent){let t=l.cross(e,y,w);l.normalize(t,t),ti[tp++]=t.x,ti[tp++]=t.y,ti[tp++]=t.z}}}O.st&&(tc.st=new o({componentDatatype:s.FLOAT,componentsPerAttribute:2,values:tn})),O.normal&&(tc.normal=new o({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:tt})),O.tangent&&(tc.tangent=new o({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:te})),O.bitangent&&(tc.bitangent=new o({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:ti}))}if(_(e._offsetAttribute)){let i=Y.length,n=+(e._offsetAttribute!==t.NONE),a=new Uint8Array(i/3).fill(n);tc.applyOffset=new o({componentDatatype:s.UNSIGNED_BYTE,componentsPerAttribute:1,values:a})}return new r({attributes:tc,indices:$,primitiveType:a.TRIANGLES,boundingSphere:m.fromEllipsoid(td),offsetAttribute:e._offsetAttribute})},b.getUnitEllipsoid=function(){return _(d)||(d=b.createGeometry(new b({radii:new l(1,1,1),vertexFormat:e.POSITION_ONLY}))),d};var I=b;export{I as a};