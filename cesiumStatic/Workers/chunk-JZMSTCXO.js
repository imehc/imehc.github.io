import{a as e}from"./chunk-YX3VGNCD.js";import{a as t}from"./chunk-6L5NM26F.js";import{b as r}from"./chunk-SPC72PTY.js";import{a as a}from"./chunk-HVWI7BO6.js";import{b as n}from"./chunk-5ELDAYCN.js";import{a as i,c as o}from"./chunk-ICY67TC6.js";import{a as c}from"./chunk-G2EMNOST.js";import{a as l}from"./chunk-4VFKVGYI.js";import{a as s}from"./chunk-3WJNS2B6.js";import{e as u}from"./chunk-XCN226AA.js";var h={};h.numberOfPoints=function(e,t,r){return Math.ceil(c.distance(e,t)/r)},h.numberOfPointsRhumbLine=function(e,t,r){return Math.max(1,Math.ceil(Math.sqrt((Math.pow(e.longitude-t.longitude,2)+Math.pow(e.latitude-t.latitude,2))/(r*r))))};var f=new i;h.extractHeights=function(e,t){let r=e.length,a=Array(r);for(let n=0;n<r;n++){let r=e[n];a[n]=t.cartesianToCartographic(r,f).height}return a};var g=new n,p=new c,m=new c,d=new a(c.UNIT_X,0),T=new c,w=new a(c.UNIT_X,0),y=new c,A=new c,C=[];function P(e,t,r){let a;if(C.length=e,t===r){for(a=0;a<e;a++)C[a]=t;return C}let n=(r-t)/e;for(a=0;a<e;a++){let e=t+a*n;C[a]=e}return C}var k=new i,N=new i,S=new c,D=new c,b=new c,E=new e,R=new t;h.wrapLongitude=function(e,t){let i=[],o=[];if(u(e)&&e.length>0){t=t??n.IDENTITY;let l=n.inverseTransformation(t,g),s=n.multiplyByPoint(l,c.ZERO,p),h=c.normalize(n.multiplyByPointAsVector(l,c.UNIT_Y,m),m),f=a.fromPointNormal(s,h,d),C=c.normalize(n.multiplyByPointAsVector(l,c.UNIT_X,T),T),P=a.fromPointNormal(s,C,w),k=1;i.push(c.clone(e[0]));let N=i[0],S=e.length;for(let t=1;t<S;++t){let n=e[t];if(0>a.getPointDistance(P,N)||0>a.getPointDistance(P,n)){let e=r.lineSegmentPlane(N,n,f,y);if(u(e)){let t=c.multiplyByScalar(h,5e-9,A);0>a.getPointDistance(f,N)&&c.negate(t,t),i.push(c.add(e,t,new c)),o.push(k+1),c.negate(t,t),i.push(c.add(e,t,new c)),k=1}}i.push(c.clone(e[t])),k++,N=n}o.push(k)}return{positions:i,lengths:o}},h.generateArc=function(e){u(e)||(e={});let t=e.positions;if(!u(t))throw new s("options.positions is required.");let r=t.length,a=e.ellipsoid??o.default,n=e.height??0,i=Array.isArray(n);if(r<1)return[];if(1===r){let e=a.scaleToGeodeticSurface(t[0],D);if(0!==(n=i?n[0]:n)){let t=a.geodeticSurfaceNormal(e,S);c.multiplyByScalar(t,n,t),c.add(e,t,e)}return[e.x,e.y,e.z]}let f=e.minDistance;if(!u(f)){let t=e.granularity??l.RADIANS_PER_DEGREE;f=l.chordLength(t,a.maximumRadius)}let g=0,p;for(p=0;p<r-1;p++)g+=h.numberOfPoints(t[p],t[p+1],f);let m=(g+1)*3,d=Array(m),T=0;for(p=0;p<r-1;p++)T=function(e,t,r,a,n,i,o,l){let s=a.scaleToGeodeticSurface(e,D),u=a.scaleToGeodeticSurface(t,b),f=h.numberOfPoints(e,t,r),g=a.cartesianToCartographic(s,k),p=a.cartesianToCartographic(u,N),m=P(f,n,i);E.setEndPoints(g,p);let d=E.surfaceDistance/f,T=l;g.height=n;let w=a.cartographicToCartesian(g,S);c.pack(w,o,T),T+=3;for(let e=1;e<f;e++){let t=E.interpolateUsingSurfaceDistance(e*d,N);t.height=m[e],w=a.cartographicToCartesian(t,S),c.pack(w,o,T),T+=3}return T}(t[p],t[p+1],f,a,i?n[p]:n,i?n[p+1]:n,d,T);C.length=0;let w=t[r-1],y=a.cartesianToCartographic(w,k);y.height=i?n[r-1]:n;let A=a.cartographicToCartesian(y,S);return c.pack(A,d,m-3),d};var I=new i,j=new i;h.generateRhumbArc=function(e){u(e)||(e={});let r=e.positions;if(!u(r))throw new s("options.positions is required.");let a=r.length,n=e.ellipsoid??o.default,f=e.height??0,g=Array.isArray(f);if(a<1)return[];if(1===a){let e=n.scaleToGeodeticSurface(r[0],D);if(0!==(f=g?f[0]:f)){let t=n.geodeticSurfaceNormal(e,S);c.multiplyByScalar(t,f,t),c.add(e,t,e)}return[e.x,e.y,e.z]}let p=e.granularity??l.RADIANS_PER_DEGREE,m=0,d,T=n.cartesianToCartographic(r[0],I),w;for(d=0;d<a-1;d++)w=n.cartesianToCartographic(r[d+1],j),m+=h.numberOfPointsRhumbLine(T,w,p),T=i.clone(w,I);let y=(m+1)*3,A=Array(y),b=0;for(d=0;d<a-1;d++)b=function(e,r,a,n,i,o,l,s){let u=n.cartesianToCartographic(e,k),f=n.cartesianToCartographic(r,N),g=h.numberOfPointsRhumbLine(u,f,a);u.height=0,f.height=0;let p=P(g,i,o);R.ellipsoid.equals(n)||(R=new t(void 0,void 0,n)),R.setEndPoints(u,f);let m=R.surfaceDistance/g,d=s;u.height=i;let T=n.cartographicToCartesian(u,S);c.pack(T,l,d),d+=3;for(let e=1;e<g;e++){let t=R.interpolateUsingSurfaceDistance(e*m,N);t.height=p[e],T=n.cartographicToCartesian(t,S),c.pack(T,l,d),d+=3}return d}(r[d],r[d+1],p,n,g?f[d]:f,g?f[d+1]:f,A,b);C.length=0;let E=r[a-1],v=n.cartesianToCartographic(E,k);v.height=g?f[a-1]:f;let G=n.cartographicToCartesian(v,S);return c.pack(G,A,y-3),A},h.generateCartesianArc=function(e){let t=h.generateArc(e),r=t.length/3,a=Array(r);for(let e=0;e<r;e++)a[e]=c.unpack(t,3*e);return a},h.generateCartesianRhumbArc=function(e){let t=h.generateRhumbArc(e),r=t.length/3,a=Array(r);for(let e=0;e<r;e++)a[e]=c.unpack(t,3*e);return a};var v=h;export{v as a};