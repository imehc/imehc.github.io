import{a as e}from"./chunk-JZMSTCXO.js";import{a as t}from"./chunk-SI3KZUTO.js";import{h as r,i as n}from"./chunk-4NDD6KRQ.js";import{a as o,b as a}from"./chunk-5ELDAYCN.js";import{a as l,b as i}from"./chunk-ICY67TC6.js";import{a as s,b as c}from"./chunk-G2EMNOST.js";import{a as u}from"./chunk-4VFKVGYI.js";import{a as d}from"./chunk-3WJNS2B6.js";import{e as m}from"./chunk-XCN226AA.js";var h=Object.freeze({ROUNDED:0,MITERED:1,BEVELED:2}),g={};function y(e,t){if(!m(e))throw new d("identifier is required.");m(g[e])||(g[e]=!0,console.warn(t??e))}y.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",y.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",y.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",y.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var f=y,p=[new s,new s],w=new s,E=new s,x=new s,b=new s,B=new s,S=new s,T=new s,z=new s,A=new s,D=new s,P=new s,j={},v=new l;function O(e,t,r,n){let o=e[0],a=e[1],l=Math.ceil(s.angleBetween(o,a)/n),i=Array(l),c;if(t===r){for(c=0;c<l;c++)i[c]=t;return i.push(r),i}let u=(r-t)/l;for(c=1;c<l;c++){let e=t+c*u;i[c]=e}return i[0]=t,i.push(r),i}var R=new s,N=new s,I=new s(-1,0,0),k=new a,G=new a,V=new c,M=c.IDENTITY.clone(),C=new s,H=new o,L=new s;function q(e,r,o,l,u,d,m,h){var g;let y,f,p,w,E=C,x=H;k=n.eastNorthUpToFixedFrame(e,u,k),E=a.multiplyByPointAsVector(k,I,E);let b=(g=E=s.normalize(E,E),f=(y=new t(e,u)).projectPointOntoPlane(s.add(e,g,R),R),p=y.projectPointOntoPlane(s.add(e,r,N),N),w=i.angleBetween(f,p),p.x*f.y-p.y*f.x>=0?-w:w);V=c.fromRotationZ(b,V),L.z=d,k=a.multiplyTransformation(k,a.fromRotationTranslation(V,L,G),k),M[0]=m;for(let e=0;e<h;e++)for(let e=0;e<o.length;e+=3)x=s.fromArray(o,e,x),x=c.multiplyByVector(M,x,x),x=a.multiplyByPoint(k,x,x),l.push(x.x,x.y,x.z);return l}var F=new s;function U(e,t,r,n,o,a,l){for(let i=0;i<e.length;i+=3)n=q(s.fromArray(e,i,F),t,r,n,o,a[i/3],l,1);return n}function Y(e,t){let r=e.length,n=Array(3*r),o=0,a=t.x+t.width/2,l=t.y+t.height/2;for(let t=0;t<r;t++)n[o++]=e[t].x-a,n[o++]=0,n[o++]=e[t].y-l;return n}var Z=new r,K=new s,Q=new c;function _(e,t,n,o,a,l,i,d,m,g){let y,f=s.angleBetween(s.subtract(t,e,D),s.subtract(n,e,P)),p=o===h.BEVELED?0:Math.ceil(f/u.toRadians(5)),w;if(w=a?c.fromQuaternion(r.fromAxisAngle(s.negate(e,D),f/(p+1),Z),Q):c.fromQuaternion(r.fromAxisAngle(e,f/(p+1),Z),Q),t=s.clone(t,K),p>0){let r=g?2:1;for(let n=0;n<p;n++)t=c.multiplyByVector(w,t,t),y=s.subtract(t,e,D),y=s.normalize(y,y),a||(y=s.negate(y,y)),i=q(l.scaleToGeodeticSurface(t,P),y,d,i,l,m,1,r)}else y=s.subtract(t,e,D),y=s.normalize(y,y),a||(y=s.negate(y,y)),i=q(l.scaleToGeodeticSurface(t,P),y,d,i,l,m,1,1),n=s.clone(n,K),y=s.subtract(n,e,D),y=s.normalize(y,y),a||(y=s.negate(y,y)),i=q(l.scaleToGeodeticSurface(n,P),y,d,i,l,m,1,1);return i}j.removeDuplicatesFromShape=function(e){let t=e.length,r=[];for(let n=t-1,o=0;o<t;n=o++){let t=e[n],a=e[o];i.equals(t,a)||r.push(a)}return r},j.angleIsGreaterThanPi=function(e,r,n,o){let a=new t(n,o),l=a.projectPointOntoPlane(s.add(n,e,R),R),i=a.projectPointOntoPlane(s.add(n,r,N),N);return i.x*l.y-i.y*l.x>=0};var J=new s,X=new s;j.computePositions=function(t,r,n,o,a){let l,i=o._ellipsoid,c=function(e,t){let r=Array(e.length);for(let n=0;n<e.length;n++){let o=e[n];v=t.cartesianToCartographic(o,v),r[n]=v.height,e[n]=t.scaleToGeodeticSurface(o,o)}return r}(t,i),d=o._granularity,m=o._cornerType,g=a?function(e,t){let r=e.length,n=Array(6*r),o=0,a=t.x+t.width/2,l=t.y+t.height/2,i=e[0];n[o++]=i.x-a,n[o++]=0,n[o++]=i.y-l;for(let t=1;t<r;t++){let r=(i=e[t]).x-a,s=i.y-l;n[o++]=r,n[o++]=0,n[o++]=s,n[o++]=r,n[o++]=0,n[o++]=s}return i=e[0],n[o++]=i.x-a,n[o++]=0,n[o++]=i.y-l,n}(r,n):Y(r,n),y=a?Y(r,n):void 0,P=n.height/2,R=n.width/2,N=t.length,I=[],k=a?[]:void 0,G=w,V=E,M=x,C=b,H=B,L=S,F=T,Z=z,K=A,Q=t[0],W=t[1];C=i.geodeticSurfaceNormal(Q,C),G=s.subtract(W,Q,G),G=s.normalize(G,G),Z=s.cross(C,G,Z),Z=s.normalize(Z,Z);let $=c[0],ee=c[1];a&&(k=q(Q,Z,y,k,i,$+P,1,1)),K=s.clone(Q,K),Q=W,V=s.negate(G,V);for(let r=1;r<N-1;r++){let n=a?2:1;if(W=t[r+1],Q.equals(W)){f("Positions are too close and are considered equivalent with rounding error.");continue}G=s.subtract(W,Q,G),G=s.normalize(G,G),C=i.geodeticSurfaceNormal(Q,C);let o=s.multiplyByScalar(C,s.dot(G,C),J);s.subtract(G,o,o),s.normalize(o,o);let y=s.multiplyByScalar(C,s.dot(V,C),X);if(s.subtract(V,y,y),s.normalize(y,y),u.equalsEpsilon(Math.abs(s.dot(o,y)),1,u.EPSILON7))I=q(K,Z,g,I,i,$+P,1,1),K=Q;else{M=s.add(G,V,M),M=s.normalize(M,M),M=s.cross(M,C,M),M=s.cross(C,M,M),M=s.normalize(M,M);let t=1/Math.max(.25,s.magnitude(s.cross(M,V,D))),r=j.angleIsGreaterThanPi(G,V,Q,i);r?(H=s.add(Q,s.multiplyByScalar(M,t*R,M),H),L=s.add(H,s.multiplyByScalar(Z,R,L),L),p[0]=s.clone(K,p[0]),p[1]=s.clone(L,p[1]),l=O(p,$+P,ee+P,d),I=U(e.generateArc({positions:p,granularity:d,ellipsoid:i}),Z,g,I,i,l,1),Z=s.cross(C,G,Z),Z=s.normalize(Z,Z),F=s.add(H,s.multiplyByScalar(Z,R,F),F),m===h.ROUNDED||m===h.BEVELED?_(H,L,F,m,r,i,I,g,ee+P,a):I=q(Q,M=s.negate(M,M),g,I,i,ee+P,t,n)):(H=s.add(Q,s.multiplyByScalar(M,t*R,M),H),L=s.add(H,s.multiplyByScalar(Z,-R,L),L),p[0]=s.clone(K,p[0]),p[1]=s.clone(L,p[1]),l=O(p,$+P,ee+P,d),I=U(e.generateArc({positions:p,granularity:d,ellipsoid:i}),Z,g,I,i,l,1),Z=s.cross(C,G,Z),Z=s.normalize(Z,Z),F=s.add(H,s.multiplyByScalar(Z,-R,F),F),m===h.ROUNDED||m===h.BEVELED?_(H,L,F,m,r,i,I,g,ee+P,a):I=q(Q,M,g,I,i,ee+P,t,n)),K=s.clone(F,K),V=s.negate(G,V)}$=ee,ee=c[r+1],Q=W}p[0]=s.clone(K,p[0]),p[1]=s.clone(Q,p[1]),l=O(p,$+P,ee+P,d),I=U(e.generateArc({positions:p,granularity:d,ellipsoid:i}),Z,g,I,i,l,1),a&&(k=q(Q,Z,y,k,i,ee+P,1,1)),N=I.length;let et=new Float64Array(a?N+k.length:N);return et.set(I),a&&et.set(k,N),et};var W=j;export{h as a,f as b,W as c};