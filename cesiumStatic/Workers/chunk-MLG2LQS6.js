import{h as t}from"./chunk-4NDD6KRQ.js";import{a as e,b as r}from"./chunk-G2EMNOST.js";import{a as a}from"./chunk-4VFKVGYI.js";var o={},i=new e,l=new e,n=new t,s=new r;function y(a,o,y,c,m,u,h,x,z,f){let O=a+o;e.multiplyByScalar(c,Math.cos(O),i),e.multiplyByScalar(y,Math.sin(O),l),e.add(i,l,i);let _=Math.cos(a);_*=_;let p=Math.sin(a);p*=p;let d=u/Math.sqrt(h*_+m*p)/x;return t.fromAxisAngle(i,d,n),r.fromQuaternion(n,s),r.multiplyByVector(s,z,f),e.normalize(f,f),e.multiplyByScalar(f,x,f),f}var c=new e,m=new e,u=new e,h=new e;o.raisePositionsToHeight=function(t,r,a){let o=r.ellipsoid,i=r.height,l=r.extrudedHeight,n=new Float64Array(3*(a?t.length/3*2:t.length/3)),s=t.length,y=a?s:0;for(let r=0;r<s;r+=3){let s=r+1,x=r+2,z=e.fromArray(t,r,c);o.scaleToGeodeticSurface(z,z);let f=e.clone(z,m),O=o.geodeticSurfaceNormal(z,h),_=e.multiplyByScalar(O,i,u);e.add(z,_,z),a&&(e.multiplyByScalar(O,l,_),e.add(f,_,f),n[r+y]=f.x,n[s+y]=f.y,n[x+y]=f.z),n[r]=z.x,n[s]=z.y,n[x]=z.z}return n};var x=new e,z=new e,f=new e;o.computeEllipsePositions=function(t,r,o){let i=t.semiMinorAxis,l=t.semiMajorAxis,n=t.rotation,s=t.center,h=8*t.granularity,O=i*i,_=l*l,p=l*i,d=e.magnitude(s),P=e.normalize(s,x),M=e.cross(e.UNIT_Z,s,z);M=e.normalize(M,M);let w=e.cross(P,M,f),I=1+Math.ceil(a.PI_OVER_TWO/h),T=a.PI_OVER_TWO/(I-1),V=a.PI_OVER_TWO-I*T;V<0&&(I-=Math.ceil(Math.abs(V)/T));let g=I*(I+2)*2,E=r?Array(3*g):void 0,R=0,A=c,S=m,W=4*I*3,v=W-1,B=0,j=o?Array(W):void 0,N,k,G,D,F;for(A=y(V=a.PI_OVER_TWO,n,w,M,O,p,_,d,P,A),r&&(E[R++]=A.x,E[R++]=A.y,E[R++]=A.z),o&&(j[v--]=A.z,j[v--]=A.y,j[v--]=A.x),V=a.PI_OVER_TWO-T,N=1;N<I+1;++N){if(A=y(V,n,w,M,O,p,_,d,P,A),S=y(Math.PI-V,n,w,M,O,p,_,d,P,S),r){for(E[R++]=A.x,E[R++]=A.y,E[R++]=A.z,G=2*N+2,k=1;k<G-1;++k)D=k/(G-1),F=e.lerp(A,S,D,u),E[R++]=F.x,E[R++]=F.y,E[R++]=F.z;E[R++]=S.x,E[R++]=S.y,E[R++]=S.z}o&&(j[v--]=A.z,j[v--]=A.y,j[v--]=A.x,j[B++]=S.x,j[B++]=S.y,j[B++]=S.z),V=a.PI_OVER_TWO-(N+1)*T}for(N=I;N>1;--N){if(A=y(-(V=a.PI_OVER_TWO-(N-1)*T),n,w,M,O,p,_,d,P,A),S=y(V+Math.PI,n,w,M,O,p,_,d,P,S),r){for(E[R++]=A.x,E[R++]=A.y,E[R++]=A.z,G=2*(N-1)+2,k=1;k<G-1;++k)D=k/(G-1),F=e.lerp(A,S,D,u),E[R++]=F.x,E[R++]=F.y,E[R++]=F.z;E[R++]=S.x,E[R++]=S.y,E[R++]=S.z}o&&(j[v--]=A.z,j[v--]=A.y,j[v--]=A.x,j[B++]=S.x,j[B++]=S.y,j[B++]=S.z)}A=y(-(V=a.PI_OVER_TWO),n,w,M,O,p,_,d,P,A);let H={};return r&&(E[R++]=A.x,E[R++]=A.y,E[R++]=A.z,H.positions=E,H.numPts=I),o&&(j[v--]=A.z,j[v--]=A.y,j[v--]=A.x,H.outerPositions=j),H};var O=o;export{O as a};