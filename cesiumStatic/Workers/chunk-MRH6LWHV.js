import{a as e}from"./chunk-2A2JFXXO.js";import{a as t}from"./chunk-33M5C4LG.js";import{h as r,i as n}from"./chunk-IB27QQGF.js";import{a as o,b as a}from"./chunk-RGFEE67W.js";import{a as l,b as i}from"./chunk-KCR7AORG.js";import{a as s,b as c}from"./chunk-QDJTHWTA.js";import{a as u}from"./chunk-2YWR3G22.js";import{a as d}from"./chunk-HTSQLHXI.js";import{e as m}from"./chunk-JDAHMWM5.js";var h=Object.freeze({ROUNDED:0,MITERED:1,BEVELED:2}),g={};function y(e,t){if(!m(e))throw new d("identifier is required.");m(g[e])||(g[e]=!0,console.warn(t??e))}y.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",y.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",y.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",y.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var f=y,p=[new s,new s],w=new s,E=new s,x=new s,b=new s,B=new s,A=new s,z=new s,T=new s,R=new s,S=new s,D=new s,P={},j=new l;function v(e,t,r,n){let o=e[0],a=e[1],l=Math.ceil(s.angleBetween(o,a)/n),i=Array(l),c;if(t===r){for(c=0;c<l;c++)i[c]=t;return i.push(r),i}let u=(r-t)/l;for(c=1;c<l;c++){let e=t+c*u;i[c]=e}return i[0]=t,i.push(r),i}var O=new s,G=new s,I=new s(-1,0,0),H=new a,k=new a,M=new c,N=c.IDENTITY.clone(),F=new s,L=new o,V=new s;function Q(e,r,o,l,u,d,m,h){var g;let y,f,p,w,E=F,x=L;H=n.eastNorthUpToFixedFrame(e,u,H),E=a.multiplyByPointAsVector(H,I,E);let b=(g=E=s.normalize(E,E),f=(y=new t(e,u)).projectPointOntoPlane(s.add(e,g,O),O),p=y.projectPointOntoPlane(s.add(e,r,G),G),w=i.angleBetween(f,p),p.x*f.y-p.y*f.x>=0?-w:w);M=c.fromRotationZ(b,M),V.z=d,H=a.multiplyTransformation(H,a.fromRotationTranslation(M,V,k),H),N[0]=m;for(let e=0;e<h;e++)for(let e=0;e<o.length;e+=3)x=s.fromArray(o,e,x),x=c.multiplyByVector(N,x,x),x=a.multiplyByPoint(H,x,x),l.push(x.x,x.y,x.z);return l}var q=new s;function U(e,t,r,n,o,a,l){for(let i=0;i<e.length;i+=3)n=Q(s.fromArray(e,i,q),t,r,n,o,a[i/3],l,1);return n}function W(e,t){let r=e.length,n=Array(3*r),o=0,a=t.x+t.width/2,l=t.y+t.height/2;for(let t=0;t<r;t++)n[o++]=e[t].x-a,n[o++]=0,n[o++]=e[t].y-l;return n}var C=new r,J=new s,X=new c;function _(e,t,n,o,a,l,i,d,m,g){let y,f=s.angleBetween(s.subtract(t,e,S),s.subtract(n,e,D)),p=o===h.BEVELED?0:Math.ceil(f/u.toRadians(5)),w;if(w=a?c.fromQuaternion(r.fromAxisAngle(s.negate(e,S),f/(p+1),C),X):c.fromQuaternion(r.fromAxisAngle(e,f/(p+1),C),X),t=s.clone(t,J),p>0){let r=g?2:1;for(let n=0;n<p;n++)t=c.multiplyByVector(w,t,t),y=s.subtract(t,e,S),y=s.normalize(y,y),a||(y=s.negate(y,y)),i=Q(l.scaleToGeodeticSurface(t,D),y,d,i,l,m,1,r)}else y=s.subtract(t,e,S),y=s.normalize(y,y),a||(y=s.negate(y,y)),i=Q(l.scaleToGeodeticSurface(t,D),y,d,i,l,m,1,1),n=s.clone(n,J),y=s.subtract(n,e,S),y=s.normalize(y,y),a||(y=s.negate(y,y)),i=Q(l.scaleToGeodeticSurface(n,D),y,d,i,l,m,1,1);return i}P.removeDuplicatesFromShape=function(e){let t=e.length,r=[];for(let n=t-1,o=0;o<t;n=o++){let t=e[n],a=e[o];i.equals(t,a)||r.push(a)}return r},P.angleIsGreaterThanPi=function(e,r,n,o){let a=new t(n,o),l=a.projectPointOntoPlane(s.add(n,e,O),O),i=a.projectPointOntoPlane(s.add(n,r,G),G);return i.x*l.y-i.y*l.x>=0};var Y=new s,Z=new s;P.computePositions=function(t,r,n,o,a){let l,i=o._ellipsoid,c=function(e,t){let r=Array(e.length);for(let n=0;n<e.length;n++){let o=e[n];j=t.cartesianToCartographic(o,j),r[n]=j.height,e[n]=t.scaleToGeodeticSurface(o,o)}return r}(t,i),d=o._granularity,m=o._cornerType,g=a?function(e,t){let r=e.length,n=Array(6*r),o=0,a=t.x+t.width/2,l=t.y+t.height/2,i=e[0];n[o++]=i.x-a,n[o++]=0,n[o++]=i.y-l;for(let t=1;t<r;t++){let r=(i=e[t]).x-a,s=i.y-l;n[o++]=r,n[o++]=0,n[o++]=s,n[o++]=r,n[o++]=0,n[o++]=s}return i=e[0],n[o++]=i.x-a,n[o++]=0,n[o++]=i.y-l,n}(r,n):W(r,n),y=a?W(r,n):void 0,D=n.height/2,O=n.width/2,G=t.length,I=[],H=a?[]:void 0,k=w,M=E,N=x,F=b,L=B,V=A,q=z,C=T,J=R,X=t[0],K=t[1];F=i.geodeticSurfaceNormal(X,F),k=s.subtract(K,X,k),k=s.normalize(k,k),C=s.cross(F,k,C),C=s.normalize(C,C);let $=c[0],ee=c[1];a&&(H=Q(X,C,y,H,i,$+D,1,1)),J=s.clone(X,J),X=K,M=s.negate(k,M);for(let r=1;r<G-1;r++){let n=a?2:1;if(K=t[r+1],X.equals(K)){f("Positions are too close and are considered equivalent with rounding error.");continue}k=s.subtract(K,X,k),k=s.normalize(k,k),F=i.geodeticSurfaceNormal(X,F);let o=s.multiplyByScalar(F,s.dot(k,F),Y);s.subtract(k,o,o),s.normalize(o,o);let y=s.multiplyByScalar(F,s.dot(M,F),Z);if(s.subtract(M,y,y),s.normalize(y,y),u.equalsEpsilon(Math.abs(s.dot(o,y)),1,u.EPSILON7))I=Q(J,C,g,I,i,$+D,1,1),J=X;else{N=s.add(k,M,N),N=s.normalize(N,N),N=s.cross(N,F,N),N=s.cross(F,N,N),N=s.normalize(N,N);let t=1/Math.max(.25,s.magnitude(s.cross(N,M,S))),r=P.angleIsGreaterThanPi(k,M,X,i);r?(L=s.add(X,s.multiplyByScalar(N,t*O,N),L),V=s.add(L,s.multiplyByScalar(C,O,V),V),p[0]=s.clone(J,p[0]),p[1]=s.clone(V,p[1]),l=v(p,$+D,ee+D,d),I=U(e.generateArc({positions:p,granularity:d,ellipsoid:i}),C,g,I,i,l,1),C=s.cross(F,k,C),C=s.normalize(C,C),q=s.add(L,s.multiplyByScalar(C,O,q),q),m===h.ROUNDED||m===h.BEVELED?_(L,V,q,m,r,i,I,g,ee+D,a):I=Q(X,N=s.negate(N,N),g,I,i,ee+D,t,n)):(L=s.add(X,s.multiplyByScalar(N,t*O,N),L),V=s.add(L,s.multiplyByScalar(C,-O,V),V),p[0]=s.clone(J,p[0]),p[1]=s.clone(V,p[1]),l=v(p,$+D,ee+D,d),I=U(e.generateArc({positions:p,granularity:d,ellipsoid:i}),C,g,I,i,l,1),C=s.cross(F,k,C),C=s.normalize(C,C),q=s.add(L,s.multiplyByScalar(C,-O,q),q),m===h.ROUNDED||m===h.BEVELED?_(L,V,q,m,r,i,I,g,ee+D,a):I=Q(X,N,g,I,i,ee+D,t,n)),J=s.clone(q,J),M=s.negate(k,M)}$=ee,ee=c[r+1],X=K}p[0]=s.clone(J,p[0]),p[1]=s.clone(X,p[1]),l=v(p,$+D,ee+D,d),I=U(e.generateArc({positions:p,granularity:d,ellipsoid:i}),C,g,I,i,l,1),a&&(H=Q(X,C,y,H,i,ee+D,1,1)),G=I.length;let et=new Float64Array(a?G+H.length:G);return et.set(I),a&&et.set(H,G),et};var K=P;export{h as a,f as b,K as c};