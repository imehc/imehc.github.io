import{b as e}from"./chunk-BNHFHP3L.js";import{a as t}from"./chunk-ICY67TC6.js";import{a as r,b as n}from"./chunk-G2EMNOST.js";import{a as i}from"./chunk-4VFKVGYI.js";import{a as o,b as a}from"./chunk-3WJNS2B6.js";import{e as s}from"./chunk-XCN226AA.js";var u={};function l(e,t,r){let n=e+t;return i.sign(e)!==i.sign(t)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(t)))<r?0:n}u.computeDiscriminant=function(e,t,r){if("number"!=typeof e)throw new o("a is a required number.");if("number"!=typeof t)throw new o("b is a required number.");if("number"!=typeof r)throw new o("c is a required number.");return t*t-4*e*r},u.computeRealRoots=function(e,t,r){let n;if("number"!=typeof e)throw new o("a is a required number.");if("number"!=typeof t)throw new o("b is a required number.");if("number"!=typeof r)throw new o("c is a required number.");if(0===e)return 0===t?[]:[-r/t];if(0===t){if(0===r)return[0,0];let t=Math.abs(r),o=Math.abs(e);if(t<o&&t/o<i.EPSILON14)return[0,0];if(t>o&&o/t<i.EPSILON14||(n=-r/e)<0)return[];let a=Math.sqrt(n);return[-a,a]}if(0===r)return(n=-t/e)<0?[n,0]:[0,n];let a=l(t*t,-(4*e*r),i.EPSILON14);if(a<0)return[];let s=-.5*l(t,i.sign(t)*Math.sqrt(a),i.EPSILON14);return t>0?[s/e,r/s]:[r/s,s/e]};var f={};function m(e,t,r,n){let i=t/3,o=r/3,a=e*o,s=i*n,u=i*i,l=o*o,f=e*o-u,m=e*n-i*o,c=i*n-l,w=4*f*c-m*m,h,d;if(w<0){let t,r,p;u*s>=a*l?(t=e,r=f,p=-2*i*f+e*m):(t=n,r=c,p=-n*m+2*o*c);let b=-(p<0?-1:1)*Math.abs(t)*Math.sqrt(-w),g=(d=-p+b)/2,q=g<0?-Math.pow(-g,1/3):Math.pow(g,1/3),y=d===b?-q:-r/q;return h=r<=0?q+y:-p/(q*q+y*y+r),u*s>=a*l?[(h-i)/e]:[-n/(h+o)]}let p=Math.sqrt(w),b=Math.sqrt(3)/2,g=Math.abs(Math.atan2(e*p,-(-2*i*f+e*m))/3),q=Math.cos(g);d=(h=2*Math.sqrt(-f))*q;let y=h*(-q/2-b*Math.sin(g)),M=d+y>2*i?d-i:y-i,S=M/e;g=Math.abs(Math.atan2(n*p,-(-n*m+2*o*c))/3),d=(h=2*Math.sqrt(-c))*(q=Math.cos(g)),y=h*(-q/2-b*Math.sin(g));let R=-n,O=d+y<2*o?d+o:y+o,P=R/O,N=-M*O-e*R,L=(o*N-M*R*i)/(-i*N+e*O*o);return S<=L?S<=P?L<=P?[S,L,P]:[S,P,L]:[P,S,L]:S<=P?[L,S,P]:L<=P?[L,P,S]:[P,L,S]}f.computeDiscriminant=function(e,t,r,n){if("number"!=typeof e)throw new o("a is a required number.");if("number"!=typeof t)throw new o("b is a required number.");if("number"!=typeof r)throw new o("c is a required number.");if("number"!=typeof n)throw new o("d is a required number.");let i=t*t,a=r*r;return 18*e*t*r*n+i*a-e*e*27*(n*n)-4*(e*a*r+i*t*n)},f.computeRealRoots=function(e,t,r,n){let i,a;if("number"!=typeof e)throw new o("a is a required number.");if("number"!=typeof t)throw new o("b is a required number.");if("number"!=typeof r)throw new o("c is a required number.");if("number"!=typeof n)throw new o("d is a required number.");if(0===e)return u.computeRealRoots(t,r,n);if(0===t){if(0===r){if(0===n)return[0,0,0];let t=(a=-n/e)<0?-Math.pow(-a,1/3):Math.pow(a,1/3);return[t,t,t]}return 0===n?0===(i=u.computeRealRoots(e,0,r)).Length?[0]:[i[0],0,i[1]]:m(e,0,r,n)}return 0===r?0===n?(a=-t/e)<0?[a,0,0]:[0,0,a]:m(e,t,0,n):0===n?0===(i=u.computeRealRoots(e,t,r)).length?[0]:i[1]<=0?[i[0],i[1],0]:i[0]>=0?[0,i[0],i[1]]:[i[0],0,i[1]]:m(e,t,r,n)};var c={};function w(e,t){t=r.clone(t??r.ZERO),r.equals(t,r.ZERO)||r.normalize(t,t),this.origin=r.clone(e??r.ZERO),this.direction=t}c.computeDiscriminant=function(e,t,r,n,i){if("number"!=typeof e)throw new o("a is a required number.");if("number"!=typeof t)throw new o("b is a required number.");if("number"!=typeof r)throw new o("c is a required number.");if("number"!=typeof n)throw new o("d is a required number.");if("number"!=typeof i)throw new o("e is a required number.");let a=e*e,s=t*t,u=s*t,l=r*r,f=l*r,m=n*n,c=m*n,w=i*i;return s*l*m-4*u*c-4*e*f*m+18*e*t*r*c-27*a*m*m+a*e*256*(w*i)+i*(18*u*r*n-4*s*f+16*e*l*l-80*e*t*l*n-6*e*s*m+144*a*r*m)+w*(144*e*s*r-27*s*s-128*a*l-192*a*t*n)},c.computeRealRoots=function(e,t,r,n,a){if("number"!=typeof e)throw new o("a is a required number.");if("number"!=typeof t)throw new o("b is a required number.");if("number"!=typeof r)throw new o("c is a required number.");if("number"!=typeof n)throw new o("d is a required number.");if("number"!=typeof a)throw new o("e is a required number.");if(Math.abs(e)<i.EPSILON15)return f.computeRealRoots(t,r,n,a);let s=t/e,l=r/e,m=n/e,c=a/e,w=+(s<0);switch(w+=l<0?w+1:w,w+=m<0?w+1:w,w+=c<0?w+1:w){case 0:case 3:case 4:case 6:case 7:case 9:case 10:case 12:case 13:case 14:case 15:return function(e,t,r,n){let o=e*e,a=t-3*o/8,s=r-t*e/2+o*e/8,l=n-r*e/4+t*o/16-3*o*o/256,m=f.computeRealRoots(1,2*a,a*a-4*l,-s*s);if(m.length>0){let t=-e/4,r=m[m.length-1];if(Math.abs(r)<i.EPSILON14){let e=u.computeRealRoots(1,a,l);if(2===e.length){let r=e[0],n=e[1],i;if(r>=0&&n>=0){let e=Math.sqrt(r),i=Math.sqrt(n);return[t-i,t-e,t+e,t+i]}if(r>=0&&n<0)return[t-(i=Math.sqrt(r)),t+i];if(r<0&&n>=0)return[t-(i=Math.sqrt(n)),t+i]}}else if(r>0){let e=Math.sqrt(r),n=u.computeRealRoots(1,e,(a+r-s/e)/2),i=u.computeRealRoots(1,-e,(a+r+s/e)/2);return 0!==n.length?(n[0]+=t,n[1]+=t,0!==i.length?(i[0]+=t,i[1]+=t,n[1]<=i[0]?[n[0],n[1],i[0],i[1]]:i[1]<=n[0]?[i[0],i[1],n[0],n[1]]:n[0]>=i[0]&&n[1]<=i[1]?[i[0],n[0],n[1],i[1]]:i[0]>=n[0]&&i[1]<=n[1]?[n[0],i[0],i[1],n[1]]:n[0]>i[0]&&n[0]<i[1]?[i[0],n[0],i[1],n[1]]:[n[0],i[0],n[1],i[1]]):n):0!==i.length?(i[0]+=t,i[1]+=t,i):[]}}return[]}(s,l,m,c);case 1:case 2:case 5:case 8:case 11:return function(e,t,r,n){let o=e*e,a=f.computeRealRoots(1,-2*t,r*e+t*t-4*n,o*n-r*t*e+r*r);if(a.length>0){let s,l,f,m,c=a[0],w=t-c,h=w*w,d=e/2,p=w/2,b=h-4*n,g=h+4*Math.abs(n),q=o-4*c,y=o+4*Math.abs(c),M,S;if(c<0||b*y<q*g){let t=Math.sqrt(q);M=t/2,S=0===t?0:(e*p-r)/t}else{let t=Math.sqrt(b);M=0===t?0:(e*p-r)/t,S=t/2}0===d&&0===M?(s=0,l=0):i.sign(d)===i.sign(M)?l=c/(s=d+M):s=c/(l=d-M),0===p&&0===S?(f=0,m=0):i.sign(p)===i.sign(S)?m=n/(f=p+S):f=n/(m=p-S);let R=u.computeRealRoots(1,s,f),O=u.computeRealRoots(1,l,m);if(0!==R.length)return 0!==O.length?R[1]<=O[0]?[R[0],R[1],O[0],O[1]]:O[1]<=R[0]?[O[0],O[1],R[0],R[1]]:R[0]>=O[0]&&R[1]<=O[1]?[O[0],R[0],R[1],O[1]]:O[0]>=R[0]&&O[1]<=R[1]?[R[0],O[0],O[1],R[1]]:R[0]>O[0]&&R[0]<O[1]?[O[0],R[0],O[1],R[1]]:[R[0],O[0],R[1],O[1]]:R;if(0!==O.length)return O}return[]}(s,l,m,c);default:return}},w.clone=function(e,t){if(s(e))return s(t)?(t.origin=r.clone(e.origin),t.direction=r.clone(e.direction),t):new w(e.origin,e.direction)},w.getPoint=function(e,t,n){return a.typeOf.object("ray",e),a.typeOf.number("t",t),s(n)||(n=new r),n=r.multiplyByScalar(e.direction,t,n),r.add(e.origin,n,n)};var h=w,d={};d.rayPlane=function(e,t,n){if(!s(e))throw new o("ray is required.");if(!s(t))throw new o("plane is required.");s(n)||(n=new r);let a=e.origin,u=e.direction,l=t.normal,f=r.dot(l,u);if(Math.abs(f)<i.EPSILON15)return;let m=(-t.distance-r.dot(l,a))/f;if(!(m<0))return n=r.multiplyByScalar(u,m,n),r.add(a,n,n)};var p=new r,b=new r,g=new r,q=new r,y=new r;d.rayTriangleParametric=function(e,t,n,a,u){if(!s(e))throw new o("ray is required.");if(!s(t))throw new o("p0 is required.");if(!s(n))throw new o("p1 is required.");if(!s(a))throw new o("p2 is required.");u=u??!1;let l=e.origin,f=e.direction,m=r.subtract(n,t,p),c=r.subtract(a,t,b),w=r.cross(f,c,g),h=r.dot(m,w),d,M,S,R,O;if(u){if(h<i.EPSILON6||(d=r.subtract(l,t,q),(S=r.dot(d,w))<0||S>h)||(M=r.cross(d,m,y),(R=r.dot(f,M))<0||S+R>h))return;O=r.dot(c,M)/h}else{if(Math.abs(h)<i.EPSILON6)return;let e=1/h;if(d=r.subtract(l,t,q),(S=r.dot(d,w)*e)<0||S>1||(M=r.cross(d,m,y),(R=r.dot(f,M)*e)<0||S+R>1))return;O=r.dot(c,M)*e}return O},d.rayTriangle=function(e,t,n,i,o,a){let u=d.rayTriangleParametric(e,t,n,i,o);if(!(!s(u)||u<0))return s(a)||(a=new r),r.multiplyByScalar(e.direction,u,a),r.add(e.origin,a,a)};var M=new h;d.lineSegmentTriangle=function(e,t,n,i,a,u,l){if(!s(e))throw new o("v0 is required.");if(!s(t))throw new o("v1 is required.");if(!s(n))throw new o("p0 is required.");if(!s(i))throw new o("p1 is required.");if(!s(a))throw new o("p2 is required.");r.clone(e,M.origin),r.subtract(t,e,M.direction),r.normalize(M.direction,M.direction);let f=d.rayTriangleParametric(M,n,i,a,u);if(!(!s(f)||f<0||f>r.distance(e,t)))return s(l)||(l=new r),r.multiplyByScalar(M.direction,f,l),r.add(M.origin,l,l)};var S={root0:0,root1:0};function R(t,n,i){s(i)||(i=new e);let o=t.origin,a=t.direction,u=n.center,l=n.radius*n.radius,f=r.subtract(o,u,g),m=function(e,t,r,n){let i=t*t-4*e*r;if(i<0)return;if(i>0){let r=1/(2*e),o=Math.sqrt(i),a=(-t+o)*r,s=(-t-o)*r;return a<s?(n.root0=a,n.root1=s):(n.root0=s,n.root1=a),n}let o=-t/(2*e);if(0!==o)return n.root0=n.root1=o,n}(r.dot(a,a),2*r.dot(a,f),r.magnitudeSquared(f)-l,S);if(s(m))return i.start=m.root0,i.stop=m.root1,i}d.raySphere=function(e,t,r){if(!s(e))throw new o("ray is required.");if(!s(t))throw new o("sphere is required.");if(!(!s(r=R(e,t,r))||r.stop<0))return r.start=Math.max(r.start,0),r};var O=new h;d.lineSegmentSphere=function(e,t,n,i){if(!s(e))throw new o("p0 is required.");if(!s(t))throw new o("p1 is required.");if(!s(n))throw new o("sphere is required.");r.clone(e,O.origin);let a=r.subtract(t,e,O.direction),u=r.magnitude(a);if(r.normalize(a,a),!(!s(i=R(O,n,i))||i.stop<0||i.start>u))return i.start=Math.max(i.start,0),i.stop=Math.min(i.stop,u),i};var P=new r,N=new r;d.rayEllipsoid=function(t,n){if(!s(t))throw new o("ray is required.");if(!s(n))throw new o("ellipsoid is required.");let i=n.oneOverRadii,a=r.multiplyComponents(i,t.origin,P),u=r.multiplyComponents(i,t.direction,N),l=r.magnitudeSquared(a),f=r.dot(a,u),m,c,w,h,d;if(l>1){if(f>=0)return;let t=f*f;if(m=l-1,t<(w=(c=r.magnitudeSquared(u))*m))return;if(t>w){h=f*f-w;let t=(d=-f+Math.sqrt(h))/c,r=m/d;return t<r?new e(t,r):{start:r,stop:t}}let n=Math.sqrt(m/c);return new e(n,n)}return l<1?(m=l-1,h=f*f-(w=(c=r.magnitudeSquared(u))*m),new e(0,(d=-f+Math.sqrt(h))/c)):f<0?new e(0,-f/(c=r.magnitudeSquared(u))):void 0};var L=new e,x=new e,E=new e;function I(e,t,r,n,i){if(i.start=(r-e)/t,i.stop=(n-e)/t,i.stop<i.start){let e=i.stop;i.stop=i.start,i.start=e}return i}function v(e,t,r){let n=e+t;return i.sign(e)!==i.sign(t)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(t)))<r?0:n}d.rayAxisAlignedBoundingBox=function(t,r,n){if(!s(t))throw new o("ray is required.");if(!s(r))throw new o("box is required.");s(n)||(n=new e);let i=I(t.origin.x,t.direction.x,r.minimum.x,r.maximum.x,L),a=I(t.origin.y,t.direction.y,r.minimum.y,r.maximum.y,x),u=I(t.origin.z,t.direction.z,r.minimum.z,r.maximum.z,E);if(n.start=i.start>a.start?i.start:a.start,n.stop=i.stop<a.stop?i.stop:a.stop,!(i.start>a.stop||a.start>i.stop)&&!(n.start>u.stop||u.start>n.stop))return u.start>n.start&&(n.start=u.start),u.stop<n.stop&&(n.stop=u.stop),n},d.quadraticVectorExpression=function(e,t,o,a,s){let l=a*a,f=s*s,m=(e[n.COLUMN1ROW1]-e[n.COLUMN2ROW2])*f,w=s*(a*v(e[n.COLUMN1ROW0],e[n.COLUMN0ROW1],i.EPSILON15)+t.y),h=e[n.COLUMN0ROW0]*l+e[n.COLUMN2ROW2]*f+a*t.x+o,d=f*v(e[n.COLUMN2ROW1],e[n.COLUMN1ROW2],i.EPSILON15),p=s*(a*v(e[n.COLUMN2ROW0],e[n.COLUMN0ROW2])+t.z),b,g=[];if(0===p&&0===d){if(0===(b=u.computeRealRoots(m,w,h)).length)return g;let e=b[0],t=Math.sqrt(Math.max(1-e*e,0));if(g.push(new r(a,s*e,-(s*t))),g.push(new r(a,s*e,s*t)),2===b.length){let e=b[1],t=Math.sqrt(Math.max(1-e*e,0));g.push(new r(a,s*e,-(s*t))),g.push(new r(a,s*e,s*t))}return g}let q=p*p,y=d*d,M=p*d,S=m*m+y,R=2*(w*m+M),O=2*h*m+w*w-y+q,P=2*(h*w-M),N=h*h-q;if(0===S&&0===R&&0===O&&0===P)return g;let L=(b=c.computeRealRoots(S,R,O,P,N)).length;if(0===L)return g;for(let e=0;e<L;++e){let t=b[e],n=t*t,o=Math.sqrt(Math.max(1-n,0)),u=(i.sign(m)===i.sign(h)?v(m*n+h,w*t,i.EPSILON12):i.sign(h)===i.sign(w*t)?v(m*n,w*t+h,i.EPSILON12):v(m*n+w*t,h,i.EPSILON12))*v(d*t,p,i.EPSILON15);u<0?g.push(new r(a,s*t,s*o)):u>0?g.push(new r(a,s*t,-(s*o))):0!==o?(g.push(new r(a,s*t,-(s*o))),g.push(new r(a,s*t,s*o)),++e):g.push(new r(a,s*t,s*o))}return g};var z=new r,C=new r,B=new r,W=new r,T=new r,U=new n,j=new n,V=new n,k=new n,A=new n,Z=new n,D=new n,F=new r,G=new r,H=new t;d.grazingAltitudeLocation=function(e,t){if(!s(e))throw new o("ray is required.");if(!s(t))throw new o("ellipsoid is required.");let a=e.origin,u=e.direction;if(!r.equals(a,r.ZERO)){let e=t.geodeticSurfaceNormal(a,z);if(r.dot(u,e)>=0)return a}let l=s(this.rayEllipsoid(e,t)),f=t.transformPositionToScaledSpace(u,z),m=r.normalize(f,f),c=r.mostOrthogonalAxis(f,W),w=r.normalize(r.cross(c,m,C),C),h=r.normalize(r.cross(m,w,B),B);U[0]=m.x,U[1]=m.y,U[2]=m.z,U[3]=w.x,U[4]=w.y,U[5]=w.z,U[6]=h.x,U[7]=h.y,U[8]=h.z;let p=n.transpose(U,j),b=n.fromScale(t.radii,V),g=n.fromScale(t.oneOverRadii,k);A[0]=0,A[1]=-u.z,A[2]=u.y,A[3]=u.z,A[4]=0,A[5]=-u.x,A[6]=-u.y,A[7]=u.x,A[8]=0;let q=n.multiply(n.multiply(p,g,Z),A,Z),y=n.multiply(n.multiply(q,b,D),U,D),M=n.multiplyByVector(q,a,T),S=d.quadraticVectorExpression(y,r.negate(M,z),0,0,1),R,O,P=S.length;if(P>0){let e=r.clone(r.ZERO,G),o=-1/0;for(let t=0;t<P;++t){R=n.multiplyByVector(b,n.multiplyByVector(U,S[t],F),F);let i=r.normalize(r.subtract(R,a,W),W),s=r.dot(i,u);s>o&&(o=s,e=r.clone(R,e))}let s=t.cartesianToCartographic(e,H);return o=i.clamp(o,0,1),O=r.magnitude(r.subtract(e,a,W))*Math.sqrt(1-o*o),s.height=O=l?-O:O,t.cartographicToCartesian(s,new r)}};var Y=new r;d.lineSegmentPlane=function(e,t,n,a){if(!s(e))throw new o("endPoint0 is required.");if(!s(t))throw new o("endPoint1 is required.");if(!s(n))throw new o("plane is required.");s(a)||(a=new r);let u=r.subtract(t,e,Y),l=n.normal,f=r.dot(l,u);if(Math.abs(f)<i.EPSILON6)return;let m=r.dot(l,e),c=-(n.distance+m)/f;if(!(c<0||c>1))return r.multiplyByScalar(u,c,a),r.add(e,a,a),a},d.trianglePlaneIntersection=function(e,t,n,i){let a,u;if(!s(e)||!s(t)||!s(n)||!s(i))throw new o("p0, p1, p2, and plane are required.");let l=i.normal,f=i.distance,m=r.dot(l,e)+f<0,c=r.dot(l,t)+f<0,w=r.dot(l,n)+f<0,h;if((1==(h=0+(+!!m+ +!!c+ +!!w))||2===h)&&(a=new r,u=new r),1===h){if(m)return d.lineSegmentPlane(e,t,i,a),d.lineSegmentPlane(e,n,i,u),{positions:[e,t,n,a,u],indices:[0,3,4,1,2,4,1,4,3]};if(c)return d.lineSegmentPlane(t,n,i,a),d.lineSegmentPlane(t,e,i,u),{positions:[e,t,n,a,u],indices:[1,3,4,2,0,4,2,4,3]};if(w)return d.lineSegmentPlane(n,e,i,a),d.lineSegmentPlane(n,t,i,u),{positions:[e,t,n,a,u],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===h){if(!m)return d.lineSegmentPlane(t,e,i,a),d.lineSegmentPlane(n,e,i,u),{positions:[e,t,n,a,u],indices:[1,2,4,1,4,3,0,3,4]};else if(!c)return d.lineSegmentPlane(n,t,i,a),d.lineSegmentPlane(e,t,i,u),{positions:[e,t,n,a,u],indices:[2,0,4,2,4,3,1,3,4]};else if(!w)return d.lineSegmentPlane(e,n,i,a),d.lineSegmentPlane(t,n,i,u),{positions:[e,t,n,a,u],indices:[0,1,4,0,4,3,2,3,4]}}};var J=d;export{h as a,J as b};