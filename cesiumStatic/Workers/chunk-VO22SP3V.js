import{h as t}from"./chunk-IB27QQGF.js";import{a as e,b as r}from"./chunk-QDJTHWTA.js";import{a as a}from"./chunk-2YWR3G22.js";var o={},i=new e,l=new e,n=new t,s=new r;function y(a,o,y,c,m,u,h,x,z,f){let _=a+o;e.multiplyByScalar(c,Math.cos(_),i),e.multiplyByScalar(y,Math.sin(_),l),e.add(i,l,i);let p=Math.cos(a);p*=p;let O=Math.sin(a);O*=O;let d=u/Math.sqrt(h*p+m*O)/x;return t.fromAxisAngle(i,d,n),r.fromQuaternion(n,s),r.multiplyByVector(s,z,f),e.normalize(f,f),e.multiplyByScalar(f,x,f),f}var c=new e,m=new e,u=new e,h=new e;o.raisePositionsToHeight=function(t,r,a){let o=r.ellipsoid,i=r.height,l=r.extrudedHeight,n=new Float64Array(3*(a?t.length/3*2:t.length/3)),s=t.length,y=a?s:0;for(let r=0;r<s;r+=3){let s=r+1,x=r+2,z=e.fromArray(t,r,c);o.scaleToGeodeticSurface(z,z);let f=e.clone(z,m),_=o.geodeticSurfaceNormal(z,h),p=e.multiplyByScalar(_,i,u);e.add(z,p,z),a&&(e.multiplyByScalar(_,l,p),e.add(f,p,f),n[r+y]=f.x,n[s+y]=f.y,n[x+y]=f.z),n[r]=z.x,n[s]=z.y,n[x]=z.z}return n};var x=new e,z=new e,f=new e;o.computeEllipsePositions=function(t,r,o){let i=t.semiMinorAxis,l=t.semiMajorAxis,n=t.rotation,s=t.center,h=8*t.granularity,_=i*i,p=l*l,O=l*i,d=e.magnitude(s),P=e.normalize(s,x),T=e.cross(e.UNIT_Z,s,z);T=e.normalize(T,T);let w=e.cross(P,T,f),I=1+Math.ceil(a.PI_OVER_TWO/h),M=a.PI_OVER_TWO/(I-1),g=a.PI_OVER_TWO-I*M;g<0&&(I-=Math.ceil(Math.abs(g)/M));let W=I*(I+2)*2,A=r?Array(3*W):void 0,E=0,R=c,V=m,B=4*I*3,S=B-1,v=0,j=o?Array(B):void 0,Q,k,G,H,F;for(R=y(g=a.PI_OVER_TWO,n,w,T,_,O,p,d,P,R),r&&(A[E++]=R.x,A[E++]=R.y,A[E++]=R.z),o&&(j[S--]=R.z,j[S--]=R.y,j[S--]=R.x),g=a.PI_OVER_TWO-M,Q=1;Q<I+1;++Q){if(R=y(g,n,w,T,_,O,p,d,P,R),V=y(Math.PI-g,n,w,T,_,O,p,d,P,V),r){for(A[E++]=R.x,A[E++]=R.y,A[E++]=R.z,G=2*Q+2,k=1;k<G-1;++k)H=k/(G-1),F=e.lerp(R,V,H,u),A[E++]=F.x,A[E++]=F.y,A[E++]=F.z;A[E++]=V.x,A[E++]=V.y,A[E++]=V.z}o&&(j[S--]=R.z,j[S--]=R.y,j[S--]=R.x,j[v++]=V.x,j[v++]=V.y,j[v++]=V.z),g=a.PI_OVER_TWO-(Q+1)*M}for(Q=I;Q>1;--Q){if(R=y(-(g=a.PI_OVER_TWO-(Q-1)*M),n,w,T,_,O,p,d,P,R),V=y(g+Math.PI,n,w,T,_,O,p,d,P,V),r){for(A[E++]=R.x,A[E++]=R.y,A[E++]=R.z,G=2*(Q-1)+2,k=1;k<G-1;++k)H=k/(G-1),F=e.lerp(R,V,H,u),A[E++]=F.x,A[E++]=F.y,A[E++]=F.z;A[E++]=V.x,A[E++]=V.y,A[E++]=V.z}o&&(j[S--]=R.z,j[S--]=R.y,j[S--]=R.x,j[v++]=V.x,j[v++]=V.y,j[v++]=V.z)}R=y(-(g=a.PI_OVER_TWO),n,w,T,_,O,p,d,P,R);let N={};return r&&(A[E++]=R.x,A[E++]=R.y,A[E++]=R.z,N.positions=A,N.numPts=I),o&&(j[S--]=R.z,j[S--]=R.y,j[S--]=R.x,N.outerPositions=j),N};var _=o;export{_ as a};