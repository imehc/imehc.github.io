import{a as t}from"./chunk-IBQZCWHF.js";import{a as e}from"./chunk-ZXZD7KWX.js";import{a as i}from"./chunk-KSX6TRAS.js";import{a as n}from"./chunk-GMTHOMGW.js";import{b as a,c as r,d as o}from"./chunk-BELR52CD.js";import{c as m}from"./chunk-BNHFHP3L.js";import{a as s}from"./chunk-N6BI774S.js";import{b as c,c as u}from"./chunk-ICY67TC6.js";import{a as l,c as f}from"./chunk-G2EMNOST.js";import{a as p}from"./chunk-4VFKVGYI.js";import{a as h}from"./chunk-3WJNS2B6.js";import{e as _}from"./chunk-XCN226AA.js";var d,k=new l,A=new l,y=new l,w=new l,C=new l,x=new l(1,1,1),P=Math.cos,v=Math.sin;function b(t){let i=(t=t??f.EMPTY_OBJECT).radii??x,n=t.innerRadii??i,a=t.minimumClock??0,r=t.maximumClock??p.TWO_PI,o=t.minimumCone??0,m=t.maximumCone??p.PI,s=Math.round(t.stackPartitions??64),c=Math.round(t.slicePartitions??64),u=t.vertexFormat??e.DEFAULT;if(c<3)throw new h("options.slicePartitions cannot be less than three.");if(s<3)throw new h("options.stackPartitions cannot be less than three.");this._radii=l.clone(i),this._innerRadii=l.clone(n),this._minimumClock=a,this._maximumClock=r,this._minimumCone=o,this._maximumCone=m,this._stackPartitions=s,this._slicePartitions=c,this._vertexFormat=e.clone(u),this._offsetAttribute=t.offsetAttribute,this._workerName="createEllipsoidGeometry"}b.packedLength=2*l.packedLength+e.packedLength+7,b.pack=function(t,i,n){if(!_(t))throw new h("value is required");if(!_(i))throw new h("array is required");return n=n??0,l.pack(t._radii,i,n),n+=l.packedLength,l.pack(t._innerRadii,i,n),n+=l.packedLength,e.pack(t._vertexFormat,i,n),n+=e.packedLength,i[n++]=t._minimumClock,i[n++]=t._maximumClock,i[n++]=t._minimumCone,i[n++]=t._maximumCone,i[n++]=t._stackPartitions,i[n++]=t._slicePartitions,i[n]=t._offsetAttribute??-1,i};var g=new l,T=new l,F=new e,L={radii:g,innerRadii:T,vertexFormat:F,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};b.unpack=function(t,i,n){if(!_(t))throw new h("array is required");i=i??0;let a=l.unpack(t,i,g);i+=l.packedLength;let r=l.unpack(t,i,T);i+=l.packedLength;let o=e.unpack(t,i,F);i+=e.packedLength;let m=t[i++],s=t[i++],c=t[i++],u=t[i++],f=t[i++],p=t[i++],d=t[i];return _(n)?(n._radii=l.clone(a,n._radii),n._innerRadii=l.clone(r,n._innerRadii),n._vertexFormat=e.clone(o,n._vertexFormat),n._minimumClock=m,n._maximumClock=s,n._minimumCone=c,n._maximumCone=u,n._stackPartitions=f,n._slicePartitions=p,n._offsetAttribute=-1===d?void 0:d,n):(L.minimumClock=m,L.maximumClock=s,L.minimumCone=c,L.maximumCone=u,L.stackPartitions=f,L.slicePartitions=p,L.offsetAttribute=-1===d?void 0:d,new b(L))},b.createGeometry=function(e){let f,h,d,x,b=e._radii;if(b.x<=0||b.y<=0||b.z<=0)return;let g=e._innerRadii;if(g.x<=0||g.y<=0||g.z<=0)return;let T=e._minimumClock,F=e._maximumClock,L=e._minimumCone,I=e._maximumCone,O=e._vertexFormat,M=e._slicePartitions+1,N=e._stackPartitions+1;M=Math.round(M*Math.abs(F-T)/p.TWO_PI),N=Math.round(N*Math.abs(I-L)/p.PI),M<2&&(M=2),N<2&&(N=2);let E,j,z=0,D=[L],R=[T];for(E=0;E<N;E++)D.push(L+E*(I-L)/(N-1));for(D.push(I),j=0;j<M;j++)R.push(T+j*(F-T)/(M-1));R.push(F);let S=D.length,G=R.length,B=0,W=1,U=g.x!==b.x||g.y!==b.y||g.z!==b.z,X=!1,Y=!1,H=!1;U&&(W=2,L>0&&(X=!0,B+=M-1),I<Math.PI&&(Y=!0,B+=M-1),(F-T)%p.TWO_PI?(H=!0,B+=(N-1)*2+1):B+=1);let K=G*S*W,Z=new Float64Array(3*K),q=Array(K).fill(!1),J=Array(K).fill(!1),V=M*N*W,Q=6*(V+B+1-(M+N)*W),$=i.createTypedArray(V,Q),tt=O.normal?new Float32Array(3*K):void 0,te=O.tangent?new Float32Array(3*K):void 0,ti=O.bitangent?new Float32Array(3*K):void 0,tn=O.st?new Float32Array(2*K):void 0,ta=Array(S),tr=Array(S);for(E=0;E<S;E++)ta[E]=v(D[E]),tr[E]=P(D[E]);let to=Array(G),tm=Array(G);for(j=0;j<G;j++)tm[j]=P(R[j]),to[j]=v(R[j]);for(E=0;E<S;E++)for(j=0;j<G;j++)Z[z++]=b.x*ta[E]*tm[j],Z[z++]=b.y*ta[E]*to[j],Z[z++]=b.z*tr[E];let ts=K/2;if(U)for(E=0;E<S;E++)for(j=0;j<G;j++)Z[z++]=g.x*ta[E]*tm[j],Z[z++]=g.y*ta[E]*to[j],Z[z++]=g.z*tr[E],q[ts]=!0,E>0&&E!==S-1&&0!==j&&j!==G-1&&(J[ts]=!0),ts++;for(E=1,z=0;E<S-2;E++)for(f=E*G,h=(E+1)*G,j=1;j<G-2;j++)$[z++]=h+j,$[z++]=h+j+1,$[z++]=f+j+1,$[z++]=h+j,$[z++]=f+j+1,$[z++]=f+j;if(U){let t=S*G;for(E=1;E<S-2;E++)for(f=t+E*G,h=t+(E+1)*G,j=1;j<G-2;j++)$[z++]=h+j,$[z++]=f+j,$[z++]=f+j+1,$[z++]=h+j,$[z++]=f+j+1,$[z++]=h+j+1}if(U){if(X)for(x=S*G,E=1;E<G-2;E++)$[z++]=E,$[z++]=E+1,$[z++]=x+E+1,$[z++]=E,$[z++]=x+E+1,$[z++]=x+E;if(Y)for(d=S*G-G,x=S*G*W-G,E=1;E<G-2;E++)$[z++]=d+E+1,$[z++]=d+E,$[z++]=x+E,$[z++]=d+E+1,$[z++]=x+E,$[z++]=x+E+1}if(H){for(E=1;E<S-2;E++)x=G*S+G*E,d=G*E,$[z++]=x,$[z++]=d+G,$[z++]=d,$[z++]=x,$[z++]=x+G,$[z++]=d+G;for(E=1;E<S-2;E++)x=G*S+G*(E+1)-1,d=G*(E+1)-1,$[z++]=d+G,$[z++]=x,$[z++]=d,$[z++]=d+G,$[z++]=x+G,$[z++]=x}let tc=new n;O.position&&(tc.position=new o({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:Z}));let tu=0,tl=0,tf=0,tp=0,th=K/2,t_,td=u.fromCartesian3(b),tk=u.fromCartesian3(g);if(O.st||O.normal||O.tangent||O.bitangent){for(E=0;E<K;E++){t_=q[E]?tk:td;let t=l.fromArray(Z,3*E,k),e=t_.geodeticSurfaceNormal(t,A);if(J[E]&&l.negate(e,e),O.st){let t=c.negate(e,C);tn[tu++]=Math.atan2(t.y,t.x)/p.TWO_PI+.5,tn[tu++]=Math.asin(e.z)/Math.PI+.5}if(O.normal&&(tt[tl++]=e.x,tt[tl++]=e.y,tt[tl++]=e.z),O.tangent||O.bitangent){let t=0,i;if(q[E]&&(t=th),i=!X&&E>=t&&E<t+2*G?l.UNIT_X:l.UNIT_Z,l.cross(i,e,y),l.normalize(y,y),O.tangent&&(te[tf++]=y.x,te[tf++]=y.y,te[tf++]=y.z),O.bitangent){let t=l.cross(e,y,w);l.normalize(t,t),ti[tp++]=t.x,ti[tp++]=t.y,ti[tp++]=t.z}}}O.st&&(tc.st=new o({componentDatatype:s.FLOAT,componentsPerAttribute:2,values:tn})),O.normal&&(tc.normal=new o({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:tt})),O.tangent&&(tc.tangent=new o({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:te})),O.bitangent&&(tc.bitangent=new o({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:ti}))}if(_(e._offsetAttribute)){let i=Z.length,n=+(e._offsetAttribute!==t.NONE),a=new Uint8Array(i/3).fill(n);tc.applyOffset=new o({componentDatatype:s.UNSIGNED_BYTE,componentsPerAttribute:1,values:a})}return new r({attributes:tc,indices:$,primitiveType:a.TRIANGLES,boundingSphere:m.fromEllipsoid(td),offsetAttribute:e._offsetAttribute})},b.getUnitEllipsoid=function(){return _(d)||(d=b.createGeometry(new b({radii:new l(1,1,1),vertexFormat:e.POSITION_ONLY}))),d};var I=b;export{I as a};