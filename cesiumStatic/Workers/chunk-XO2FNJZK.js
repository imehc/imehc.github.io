import{a as e}from"./chunk-CM5O7VPK.js";import{j as t}from"./chunk-IB27QQGF.js";import{b as n}from"./chunk-RGFEE67W.js";import{a as r,c as o}from"./chunk-KCR7AORG.js";import{a as c,b as a}from"./chunk-QDJTHWTA.js";import{a as i}from"./chunk-2YWR3G22.js";import{a as u,b as l}from"./chunk-HTSQLHXI.js";import{e as s}from"./chunk-JDAHMWM5.js";function d(e){this._ellipsoid=e??o.default,this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(d.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),d.prototype.project=function(e,t){let n=this._semimajorAxis,r=e.longitude*n,o=e.latitude*n,a=e.height;return s(t)?(t.x=r,t.y=o,t.z=a,t):new c(r,o,a)},d.prototype.unproject=function(e,t){if(!s(e))throw new u("cartesian is required");let n=this._oneOverSemimajorAxis,o=e.x*n,c=e.y*n,a=e.z;return s(t)?(t.longitude=o,t.latitude=c,t.height=a,t):new r(o,c,a)};var f=d,p=function(e,t){this.start=e??0,this.stop=t??0};function y(e,t){this.center=c.clone(e??c.ZERO),this.radius=t??0}var m=new c,h=new c,x=new c,g=new c,z=new c,w=new c,b=new c,O=new c,j=new c,S=new c,q=new c,R=new c,E=4/3*i.PI;y.fromPoints=function(e,t){if(s(t)||(t=new y),!s(e)||0===e.length)return t.center=c.clone(c.ZERO,t.center),t.radius=0,t;let n=c.clone(e[0],b),r=c.clone(n,m),o=c.clone(n,h),a=c.clone(n,x),i=c.clone(n,g),u=c.clone(n,z),l=c.clone(n,w),d=e.length,f;for(f=1;f<d;f++){c.clone(e[f],n);let t=n.x,s=n.y,d=n.z;t<r.x&&c.clone(n,r),t>i.x&&c.clone(n,i),s<o.y&&c.clone(n,o),s>u.y&&c.clone(n,u),d<a.z&&c.clone(n,a),d>l.z&&c.clone(n,l)}let p=c.magnitudeSquared(c.subtract(i,r,O)),E=c.magnitudeSquared(c.subtract(u,o,O)),v=c.magnitudeSquared(c.subtract(l,a,O)),P=r,T=i,B=p;E>B&&(B=E,P=o,T=u),v>B&&(B=v,P=a,T=l),j.x=(P.x+T.x)*.5,j.y=(P.y+T.y)*.5,j.z=(P.z+T.z)*.5;let D=c.magnitudeSquared(c.subtract(T,j,O)),M=Math.sqrt(D);S.x=r.x,S.y=o.y,S.z=a.z,q.x=i.x,q.y=u.y,q.z=l.z;let _=c.midpoint(S,q,R),k=0;for(f=0;f<d;f++){c.clone(e[f],n);let t=c.magnitude(c.subtract(n,_,O));t>k&&(k=t);let r=c.magnitudeSquared(c.subtract(n,j,O));if(r>D){let e=Math.sqrt(r);D=(M=(M+e)*.5)*M;let t=e-M;j.x=(M*j.x+t*n.x)/e,j.y=(M*j.y+t*n.y)/e,j.z=(M*j.z+t*n.z)/e}}return M<k?(c.clone(j,t.center),t.radius=M):(c.clone(_,t.center),t.radius=k),t};var v=new f,P=new c,T=new c,B=new r,D=new r;y.fromRectangle2D=function(e,t,n){return y.fromRectangleWithHeights2D(e,t,0,0,n)},y.fromRectangleWithHeights2D=function(e,n,r,a,i){if(s(i)||(i=new y),!s(e))return i.center=c.clone(c.ZERO,i.center),i.radius=0,i;v._ellipsoid=o.default,n=n??v,t.southwest(e,B),B.height=r,t.northeast(e,D),D.height=a;let u=n.project(B,P),l=n.project(D,T),d=l.x-u.x,f=l.y-u.y,p=l.z-u.z;i.radius=.5*Math.sqrt(d*d+f*f+p*p);let m=i.center;return m.x=u.x+.5*d,m.y=u.y+.5*f,m.z=u.z+.5*p,i};var M=[];y.fromRectangle3D=function(e,n,r,a){if(n=n??o.default,r=r??0,s(a)||(a=new y),!s(e))return a.center=c.clone(c.ZERO,a.center),a.radius=0,a;let i=t.subsample(e,n,r,M);return y.fromPoints(i,a)},y.fromVertices=function(e,t,n,r){if(s(r)||(r=new y),!s(e)||0===e.length)return r.center=c.clone(c.ZERO,r.center),r.radius=0,r;t=t??c.ZERO,n=n??3,l.typeOf.number.greaterThanOrEquals("stride",n,3),b.x=e[0]+t.x,b.y=e[1]+t.y,b.z=e[2]+t.z;let o=c.clone(b,m),a=c.clone(b,h),i=c.clone(b,x),u=c.clone(b,g),d=c.clone(b,z),f=c.clone(b,w),p=e.length,E;for(E=0;E<p;E+=n){let n=e[E]+t.x,r=e[E+1]+t.y,l=e[E+2]+t.z;b.x=n,b.y=r,b.z=l,n<o.x&&c.clone(b,o),n>u.x&&c.clone(b,u),r<a.y&&c.clone(b,a),r>d.y&&c.clone(b,d),l<i.z&&c.clone(b,i),l>f.z&&c.clone(b,f)}let v=c.magnitudeSquared(c.subtract(u,o,O)),P=c.magnitudeSquared(c.subtract(d,a,O)),T=c.magnitudeSquared(c.subtract(f,i,O)),B=o,D=u,M=v;P>M&&(M=P,B=a,D=d),T>M&&(M=T,B=i,D=f),j.x=(B.x+D.x)*.5,j.y=(B.y+D.y)*.5,j.z=(B.z+D.z)*.5;let _=c.magnitudeSquared(c.subtract(D,j,O)),k=Math.sqrt(_);S.x=o.x,S.y=a.y,S.z=i.z,q.x=u.x,q.y=d.y,q.z=f.z;let Z=c.midpoint(S,q,R),A=0;for(E=0;E<p;E+=n){b.x=e[E]+t.x,b.y=e[E+1]+t.y,b.z=e[E+2]+t.z;let n=c.magnitude(c.subtract(b,Z,O));n>A&&(A=n);let r=c.magnitudeSquared(c.subtract(b,j,O));if(r>_){let e=Math.sqrt(r);_=(k=(k+e)*.5)*k;let t=e-k;j.x=(k*j.x+t*b.x)/e,j.y=(k*j.y+t*b.y)/e,j.z=(k*j.z+t*b.z)/e}}return k<A?(c.clone(j,r.center),r.radius=k):(c.clone(Z,r.center),r.radius=A),r},y.fromEncodedCartesianVertices=function(e,t,n){if(s(n)||(n=new y),!s(e)||!s(t)||e.length!==t.length||0===e.length)return n.center=c.clone(c.ZERO,n.center),n.radius=0,n;b.x=e[0]+t[0],b.y=e[1]+t[1],b.z=e[2]+t[2];let r=c.clone(b,m),o=c.clone(b,h),a=c.clone(b,x),i=c.clone(b,g),u=c.clone(b,z),l=c.clone(b,w),d=e.length,f;for(f=0;f<d;f+=3){let n=e[f]+t[f],s=e[f+1]+t[f+1],d=e[f+2]+t[f+2];b.x=n,b.y=s,b.z=d,n<r.x&&c.clone(b,r),n>i.x&&c.clone(b,i),s<o.y&&c.clone(b,o),s>u.y&&c.clone(b,u),d<a.z&&c.clone(b,a),d>l.z&&c.clone(b,l)}let p=c.magnitudeSquared(c.subtract(i,r,O)),E=c.magnitudeSquared(c.subtract(u,o,O)),v=c.magnitudeSquared(c.subtract(l,a,O)),P=r,T=i,B=p;E>B&&(B=E,P=o,T=u),v>B&&(B=v,P=a,T=l),j.x=(P.x+T.x)*.5,j.y=(P.y+T.y)*.5,j.z=(P.z+T.z)*.5;let D=c.magnitudeSquared(c.subtract(T,j,O)),M=Math.sqrt(D);S.x=r.x,S.y=o.y,S.z=a.z,q.x=i.x,q.y=u.y,q.z=l.z;let _=c.midpoint(S,q,R),k=0;for(f=0;f<d;f+=3){b.x=e[f]+t[f],b.y=e[f+1]+t[f+1],b.z=e[f+2]+t[f+2];let n=c.magnitude(c.subtract(b,_,O));n>k&&(k=n);let r=c.magnitudeSquared(c.subtract(b,j,O));if(r>D){let e=Math.sqrt(r);D=(M=(M+e)*.5)*M;let t=e-M;j.x=(M*j.x+t*b.x)/e,j.y=(M*j.y+t*b.y)/e,j.z=(M*j.z+t*b.z)/e}}return M<k?(c.clone(j,n.center),n.radius=M):(c.clone(_,n.center),n.radius=k),n},y.fromCornerPoints=function(e,t,n){l.typeOf.object("corner",e),l.typeOf.object("oppositeCorner",t),s(n)||(n=new y);let r=c.midpoint(e,t,n.center);return n.radius=c.distance(r,t),n},y.fromEllipsoid=function(e,t){return l.typeOf.object("ellipsoid",e),s(t)||(t=new y),c.clone(c.ZERO,t.center),t.radius=e.maximumRadius,t};var _=new c;y.fromBoundingSpheres=function(e,t){if(s(t)||(t=new y),!s(e)||0===e.length)return t.center=c.clone(c.ZERO,t.center),t.radius=0,t;let n=e.length;if(1===n)return y.clone(e[0],t);if(2===n)return y.union(e[0],e[1],t);let r=[],o;for(o=0;o<n;o++)r.push(e[o].center);let a=(t=y.fromPoints(r,t)).center,i=t.radius;for(o=0;o<n;o++){let t=e[o];i=Math.max(i,c.distance(a,t.center,_)+t.radius)}return t.radius=i,t};var k=new c,Z=new c,A=new c;y.fromOrientedBoundingBox=function(e,t){l.defined("orientedBoundingBox",e),s(t)||(t=new y);let n=e.halfAxes,r=a.getColumn(n,0,k),o=a.getColumn(n,1,Z),i=a.getColumn(n,2,A);return c.add(r,o,r),c.add(r,i,r),t.center=c.clone(e.center,t.center),t.radius=c.magnitude(r),t};var C=new c,I=new c;y.fromTransformation=function(e,t){l.typeOf.object("transformation",e),s(t)||(t=new y);let r=n.getTranslation(e,C),o=n.getScale(e,I),a=.5*c.magnitude(o);return t.center=c.clone(r,t.center),t.radius=a,t},y.clone=function(e,t){if(s(e))return s(t)?(t.center=c.clone(e.center,t.center),t.radius=e.radius,t):new y(e.center,e.radius)},y.packedLength=4,y.pack=function(e,t,n){l.typeOf.object("value",e),l.defined("array",t),n=n??0;let r=e.center;return t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n]=e.radius,t},y.unpack=function(e,t,n){l.defined("array",e),t=t??0,s(n)||(n=new y);let r=n.center;return r.x=e[t++],r.y=e[t++],r.z=e[t++],n.radius=e[t],n};var W=new c,H=new c;y.union=function(e,t,n){l.typeOf.object("left",e),l.typeOf.object("right",t),s(n)||(n=new y);let r=e.center,o=e.radius,a=t.center,i=t.radius,u=c.subtract(a,r,W),d=c.magnitude(u);if(o>=d+i)return e.clone(n),n;if(i>=d+o)return t.clone(n),n;let f=(o+d+i)*.5,p=c.multiplyByScalar(u,(-o+f)/d,H);return c.add(p,r,p),c.clone(p,n.center),n.radius=f,n};var N=new c;y.expand=function(e,t,n){l.typeOf.object("sphere",e),l.typeOf.object("point",t),n=y.clone(e,n);let r=c.magnitude(c.subtract(t,n.center,N));return r>n.radius&&(n.radius=r),n},y.intersectPlane=function(t,n){l.typeOf.object("sphere",t),l.typeOf.object("plane",n);let r=t.center,o=t.radius,a=n.normal,i=c.dot(a,r)+n.distance;return i<-o?e.OUTSIDE:i<o?e.INTERSECTING:e.INSIDE},y.transform=function(e,t,r){return l.typeOf.object("sphere",e),l.typeOf.object("transform",t),s(r)||(r=new y),r.center=n.multiplyByPoint(t,e.center,r.center),r.radius=n.getMaximumScale(t)*e.radius,r};var G=new c;y.distanceSquaredTo=function(e,t){l.typeOf.object("sphere",e),l.typeOf.object("cartesian",t);let n=c.subtract(e.center,t,G),r=c.magnitude(n)-e.radius;return r<=0?0:r*r},y.transformWithoutScale=function(e,t,r){return l.typeOf.object("sphere",e),l.typeOf.object("transform",t),s(r)||(r=new y),r.center=n.multiplyByPoint(t,e.center,r.center),r.radius=e.radius,r};var Q=new c;y.computePlaneDistances=function(e,t,n,r){l.typeOf.object("sphere",e),l.typeOf.object("position",t),l.typeOf.object("direction",n),s(r)||(r=new p);let o=c.subtract(e.center,t,Q),a=c.dot(n,o);return r.start=a-e.radius,r.stop=a+e.radius,r};var V=new c,U=new c,F=new c,J=new c,K=new c,L=new r,X=Array(8);for(let e=0;e<8;++e)X[e]=new c;var Y=new f;y.projectTo2D=function(e,t,n){l.typeOf.object("sphere",e),Y._ellipsoid=o.default;let r=(t=t??Y).ellipsoid,a=e.center,i=e.radius,u;u=c.equals(a,c.ZERO)?c.clone(c.UNIT_X,V):r.geodeticSurfaceNormal(a,V);let s=c.cross(c.UNIT_Z,u,U);c.normalize(s,s);let d=c.cross(u,s,F);c.normalize(d,d),c.multiplyByScalar(u,i,u),c.multiplyByScalar(d,i,d),c.multiplyByScalar(s,i,s);let f=c.negate(d,K),p=c.negate(s,J),m=X[0];c.add(u,d,m),c.add(m,s,m),m=X[1],c.add(u,d,m),c.add(m,p,m),m=X[2],c.add(u,f,m),c.add(m,p,m),m=X[3],c.add(u,f,m),c.add(m,s,m),c.negate(u,u),m=X[4],c.add(u,d,m),c.add(m,s,m),m=X[5],c.add(u,d,m),c.add(m,p,m),m=X[6],c.add(u,f,m),c.add(m,p,m),m=X[7],c.add(u,f,m),c.add(m,s,m);let h=X.length;for(let e=0;e<h;++e){let n=X[e];c.add(a,n,n);let o=r.cartesianToCartographic(n,L);t.project(o,n)}let x=(a=(n=y.fromPoints(X,n)).center).x,g=a.y,z=a.z;return a.x=z,a.y=x,a.z=g,n},y.isOccluded=function(e,t){return l.typeOf.object("sphere",e),l.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},y.equals=function(e,t){return e===t||s(e)&&s(t)&&c.equals(e.center,t.center)&&e.radius===t.radius},y.prototype.intersectPlane=function(e){return y.intersectPlane(this,e)},y.prototype.distanceSquaredTo=function(e){return y.distanceSquaredTo(this,e)},y.prototype.computePlaneDistances=function(e,t,n){return y.computePlaneDistances(this,e,t,n)},y.prototype.isOccluded=function(e){return y.isOccluded(this,e)},y.prototype.equals=function(e){return y.equals(this,e)},y.prototype.clone=function(e){return y.clone(this,e)},y.prototype.volume=function(){let e=this.radius;return E*e*e*e};var $=y;export{f as a,p as b,$ as c};