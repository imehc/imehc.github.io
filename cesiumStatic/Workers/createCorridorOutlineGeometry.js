import{a as t}from"./chunk-7YYII3LO.js";import{a as e}from"./chunk-KSAXP2ON.js";import"./chunk-JZMSTCXO.js";import"./chunk-YX3VGNCD.js";import{a as i}from"./chunk-IBQZCWHF.js";import"./chunk-SI3KZUTO.js";import"./chunk-QM7HI6IF.js";import{b as r}from"./chunk-45FW5IBC.js";import{a as o}from"./chunk-YM5K5MQ6.js";import"./chunk-6L5NM26F.js";import"./chunk-SPC72PTY.js";import"./chunk-HVWI7BO6.js";import{a as s}from"./chunk-KSX6TRAS.js";import{a as n}from"./chunk-GMTHOMGW.js";import{b as a,c as l,d as h}from"./chunk-BELR52CD.js";import{c as u}from"./chunk-BNHFHP3L.js";import"./chunk-4UHVCH4T.js";import"./chunk-4NDD6KRQ.js";import"./chunk-5ELDAYCN.js";import{a as p}from"./chunk-N6BI774S.js";import"./chunk-TI35VBH7.js";import"./chunk-6WLI3422.js";import{c as c}from"./chunk-ICY67TC6.js";import{a as f,c as d}from"./chunk-G2EMNOST.js";import{a as g}from"./chunk-4VFKVGYI.js";import{b as m}from"./chunk-3WJNS2B6.js";import{e as y}from"./chunk-XCN226AA.js";var A=new f,_=new f,b=new f;function k(i,r){let o=[],a=i.positions,l=i.corners,u=i.endPositions,c=new n,d,g=0,m=0,k,T=0,j;for(k=0;k<a.length;k+=2)g+=j=a[k].length-3,T+=j/3*4,m+=a[k+1].length-3;for(g+=3,m+=3,k=0;k<l.length;k++){d=l[k];let t=l[k].leftPositions;y(t)?g+=j=t.length:m+=j=l[k].rightPositions.length,T+=j/3*2}let E=y(u),v;E&&(g+=v=u[0].length-3,m+=v,v/=3,T+=4*v);let w=g+m,N=new Float64Array(w),O=0,H=w-1,I,P,L,D,S,G,B=v/2,C=s.createTypedArray(w/3,T+4),M=0;if(C[M++]=O/3,C[M++]=(H-2)/3,E){o.push(O/3),G=A,S=_;let e=u[0];for(k=0;k<B;k++)G=f.fromArray(e,(B-1-k)*3,G),S=f.fromArray(e,(B+k)*3,S),t.addAttribute(N,S,O),t.addAttribute(N,G,void 0,H),D=(P=O/3)+1,L=(I=(H-2)/3)-1,C[M++]=I,C[M++]=L,C[M++]=P,C[M++]=D,O+=3,H-=3}let x=0,Y=a[x++],F=a[x++];for(N.set(Y,O),N.set(F,H-F.length+1),j=F.length-3,o.push(O/3,(H-2)/3),k=0;k<j;k+=3)D=(P=O/3)+1,L=(I=(H-2)/3)-1,C[M++]=I,C[M++]=L,C[M++]=P,C[M++]=D,O+=3,H-=3;for(k=0;k<l.length;k++){let i,s=(d=l[k]).leftPositions,n=d.rightPositions,h,u=b;if(y(s)){for(H-=3,h=L,o.push(D),i=0;i<s.length/3;i++)u=f.fromArray(s,3*i,u),C[M++]=h-i-1,C[M++]=h-i,t.addAttribute(N,u,void 0,H),H-=3;o.push(h-Math.floor(s.length/6)),r===e.BEVELED&&o.push((H-2)/3+1),O+=3}else{for(O+=3,h=D,o.push(L),i=0;i<n.length/3;i++)u=f.fromArray(n,3*i,u),C[M++]=h+i,C[M++]=h+i+1,t.addAttribute(N,u,O),O+=3;o.push(h+Math.floor(n.length/6)),r===e.BEVELED&&o.push(O/3-1),H-=3}for(Y=a[x++],F=a[x++],Y.splice(0,3),F.splice(F.length-3,3),N.set(Y,O),N.set(F,H-F.length+1),j=F.length-3,i=0;i<F.length;i+=3)P=(D=O/3)-1,I=(L=(H-2)/3)+1,C[M++]=I,C[M++]=L,C[M++]=P,C[M++]=D,O+=3,H-=3;O-=3,H+=3,o.push(O/3,(H-2)/3)}if(E){O+=3,H-=3,G=A,S=_;let e=u[1];for(k=0;k<B;k++)G=f.fromArray(e,(v-k-1)*3,G),S=f.fromArray(e,3*k,S),t.addAttribute(N,G,void 0,H),t.addAttribute(N,S,O),P=(D=O/3)-1,I=(L=(H-2)/3)+1,C[M++]=I,C[M++]=L,C[M++]=P,C[M++]=D,O+=3,H-=3;o.push(O/3)}else o.push(O/3,(H-2)/3);return C[M++]=O/3,C[M++]=(H-2)/3,c.position=new h({componentDatatype:p.DOUBLE,componentsPerAttribute:3,values:N}),{attributes:c,indices:C,wallIndices:o}}function T(t){let i=(t=t??d.EMPTY_OBJECT).positions,r=t.width;m.typeOf.object("options.positions",i),m.typeOf.number("options.width",r);let o=t.height??0,s=t.extrudedHeight??o;this._positions=i,this._ellipsoid=c.clone(t.ellipsoid??c.default),this._width=r,this._height=Math.max(o,s),this._extrudedHeight=Math.min(o,s),this._cornerType=t.cornerType??e.ROUNDED,this._granularity=t.granularity??g.RADIANS_PER_DEGREE,this._offsetAttribute=t.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+i.length*f.packedLength+c.packedLength+6}T.pack=function(t,e,i){m.typeOf.object("value",t),m.typeOf.object("array",e),i=i??0;let r=t._positions,o=r.length;e[i++]=o;for(let t=0;t<o;++t,i+=f.packedLength)f.pack(r[t],e,i);return c.pack(t._ellipsoid,e,i),i+=c.packedLength,e[i++]=t._width,e[i++]=t._height,e[i++]=t._extrudedHeight,e[i++]=t._cornerType,e[i++]=t._granularity,e[i]=t._offsetAttribute??-1,e};var j=c.clone(c.UNIT_SPHERE),E={positions:void 0,ellipsoid:j,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};T.unpack=function(t,e,i){m.typeOf.object("array",t),e=e??0;let r=t[e++],o=Array(r);for(let i=0;i<r;++i,e+=f.packedLength)o[i]=f.unpack(t,e);let s=c.unpack(t,e,j);e+=c.packedLength;let n=t[e++],a=t[e++],l=t[e++],h=t[e++],u=t[e++],p=t[e];return y(i)?(i._positions=o,i._ellipsoid=c.clone(s,i._ellipsoid),i._width=n,i._height=a,i._extrudedHeight=l,i._cornerType=h,i._granularity=u,i._offsetAttribute=-1===p?void 0:p,i):(E.positions=o,E.width=n,E.height=a,E.extrudedHeight=l,E.cornerType=h,E.granularity=u,E.offsetAttribute=-1===p?void 0:p,new T(E))},T.createGeometry=function(e){let n=e._positions,c=e._width,d=e._ellipsoid,m=o(n=function(t,e){for(let i=0;i<t.length;i++)t[i]=e.scaleToGeodeticSurface(t[i],t[i]);return t}(n,d),f.equalsEpsilon);if(m.length<2||c<=0)return;let A=e._height,_=e._extrudedHeight,b=!g.equalsEpsilon(A,_,0,g.EPSILON2),T={ellipsoid:d,positions:m,width:c,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1},j;if(b)T.height=A,T.extrudedHeight=_,T.offsetAttribute=e._offsetAttribute,j=function(e){let o,n,a=e.ellipsoid,l=k(t.computePositions(e),e.cornerType),u=l.wallIndices,c=e.height,f=e.extrudedHeight,d=l.attributes,g=l.indices,m=d.position.values,A=m.length,_=new Float64Array(A);_.set(m);let b=new Float64Array(2*A);if(m=r.scaleToGeodeticHeight(m,c,a),_=r.scaleToGeodeticHeight(_,f,a),b.set(m),b.set(_,A),d.position.values=b,A/=3,y(e.offsetAttribute)){let t=new Uint8Array(2*A);if(e.offsetAttribute===i.TOP)t=t.fill(1,0,A);else{let r=+(e.offsetAttribute!==i.NONE);t=t.fill(r)}d.applyOffset=new h({componentDatatype:p.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let T,j=g.length,E=s.createTypedArray(b.length/3,(j+u.length)*2);E.set(g);let v=j;for(T=0;T<j;T+=2){let t=g[T],e=g[T+1];E[v++]=t+A,E[v++]=e+A}for(T=0;T<u.length;T++)n=(o=u[T])+A,E[v++]=o,E[v++]=n;return{attributes:d,indices:E}}(T);else if((j=k(t.computePositions(T),T.cornerType)).attributes.position.values=r.scaleToGeodeticHeight(j.attributes.position.values,A,d),y(e._offsetAttribute)){let t=j.attributes.position.values.length,r=+(e._offsetAttribute!==i.NONE),o=new Uint8Array(t/3).fill(r);j.attributes.applyOffset=new h({componentDatatype:p.UNSIGNED_BYTE,componentsPerAttribute:1,values:o})}let E=j.attributes,v=u.fromVertices(E.position.values,void 0,3);return new l({attributes:E,indices:j.indices,primitiveType:a.LINES,boundingSphere:v,offsetAttribute:e._offsetAttribute})};var v=function(t,e){return y(e)&&(t=T.unpack(t,e)),t._ellipsoid=c.clone(t._ellipsoid),T.createGeometry(t)};export{v as default};