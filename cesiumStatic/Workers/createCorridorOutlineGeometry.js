import{a as t}from"./chunk-525YMNGT.js";import{a as e}from"./chunk-MRH6LWHV.js";import"./chunk-2A2JFXXO.js";import"./chunk-TULFNR3P.js";import{a as i}from"./chunk-MABAS5D2.js";import"./chunk-33M5C4LG.js";import"./chunk-X2JOWFTB.js";import{b as r}from"./chunk-TN2BIDXM.js";import{a as o}from"./chunk-KF74ULE7.js";import"./chunk-4EHG4BFI.js";import"./chunk-KIJM7B3H.js";import"./chunk-P44F6KLE.js";import{a as s}from"./chunk-GSMLTRAL.js";import{a as n}from"./chunk-IUX576XK.js";import{b as a,c as l,d as h}from"./chunk-UIGT6VOJ.js";import{c as u}from"./chunk-XO2FNJZK.js";import"./chunk-CM5O7VPK.js";import"./chunk-IB27QQGF.js";import"./chunk-RGFEE67W.js";import{a as p}from"./chunk-KXT7EZPS.js";import"./chunk-ZIOQOCPQ.js";import"./chunk-SY2GINYP.js";import{c as c}from"./chunk-KCR7AORG.js";import{a as f,c as d}from"./chunk-QDJTHWTA.js";import{a as g}from"./chunk-2YWR3G22.js";import{b as m}from"./chunk-HTSQLHXI.js";import{e as y}from"./chunk-JDAHMWM5.js";var A=new f,_=new f,b=new f;function k(i,r){let o=[],a=i.positions,l=i.corners,u=i.endPositions,c=new n,d,g=0,m=0,k,T=0,E;for(k=0;k<a.length;k+=2)g+=E=a[k].length-3,T+=E/3*4,m+=a[k+1].length-3;for(g+=3,m+=3,k=0;k<l.length;k++){d=l[k];let t=l[k].leftPositions;y(t)?g+=E=t.length:m+=E=l[k].rightPositions.length,T+=E/3*2}let j=y(u),v;j&&(g+=v=u[0].length-3,m+=v,v/=3,T+=4*v);let w=g+m,O=new Float64Array(w),H=0,P=w-1,G,L,N,I,D,M,S=v/2,B=s.createTypedArray(w/3,T+4),F=0;if(B[F++]=H/3,B[F++]=(P-2)/3,j){o.push(H/3),M=A,D=_;let e=u[0];for(k=0;k<S;k++)M=f.fromArray(e,(S-1-k)*3,M),D=f.fromArray(e,(S+k)*3,D),t.addAttribute(O,D,H),t.addAttribute(O,M,void 0,P),I=(L=H/3)+1,N=(G=(P-2)/3)-1,B[F++]=G,B[F++]=N,B[F++]=L,B[F++]=I,H+=3,P-=3}let R=0,x=a[R++],U=a[R++];for(O.set(x,H),O.set(U,P-U.length+1),E=U.length-3,o.push(H/3,(P-2)/3),k=0;k<E;k+=3)I=(L=H/3)+1,N=(G=(P-2)/3)-1,B[F++]=G,B[F++]=N,B[F++]=L,B[F++]=I,H+=3,P-=3;for(k=0;k<l.length;k++){let i,s=(d=l[k]).leftPositions,n=d.rightPositions,h,u=b;if(y(s)){for(P-=3,h=N,o.push(I),i=0;i<s.length/3;i++)u=f.fromArray(s,3*i,u),B[F++]=h-i-1,B[F++]=h-i,t.addAttribute(O,u,void 0,P),P-=3;o.push(h-Math.floor(s.length/6)),r===e.BEVELED&&o.push((P-2)/3+1),H+=3}else{for(H+=3,h=I,o.push(N),i=0;i<n.length/3;i++)u=f.fromArray(n,3*i,u),B[F++]=h+i,B[F++]=h+i+1,t.addAttribute(O,u,H),H+=3;o.push(h+Math.floor(n.length/6)),r===e.BEVELED&&o.push(H/3-1),P-=3}for(x=a[R++],U=a[R++],x.splice(0,3),U.splice(U.length-3,3),O.set(x,H),O.set(U,P-U.length+1),E=U.length-3,i=0;i<U.length;i+=3)L=(I=H/3)-1,G=(N=(P-2)/3)+1,B[F++]=G,B[F++]=N,B[F++]=L,B[F++]=I,H+=3,P-=3;H-=3,P+=3,o.push(H/3,(P-2)/3)}if(j){H+=3,P-=3,M=A,D=_;let e=u[1];for(k=0;k<S;k++)M=f.fromArray(e,(v-k-1)*3,M),D=f.fromArray(e,3*k,D),t.addAttribute(O,M,void 0,P),t.addAttribute(O,D,H),L=(I=H/3)-1,G=(N=(P-2)/3)+1,B[F++]=G,B[F++]=N,B[F++]=L,B[F++]=I,H+=3,P-=3;o.push(H/3)}else o.push(H/3,(P-2)/3);return B[F++]=H/3,B[F++]=(P-2)/3,c.position=new h({componentDatatype:p.DOUBLE,componentsPerAttribute:3,values:O}),{attributes:c,indices:B,wallIndices:o}}function T(t){let i=(t=t??d.EMPTY_OBJECT).positions,r=t.width;m.typeOf.object("options.positions",i),m.typeOf.number("options.width",r);let o=t.height??0,s=t.extrudedHeight??o;this._positions=i,this._ellipsoid=c.clone(t.ellipsoid??c.default),this._width=r,this._height=Math.max(o,s),this._extrudedHeight=Math.min(o,s),this._cornerType=t.cornerType??e.ROUNDED,this._granularity=t.granularity??g.RADIANS_PER_DEGREE,this._offsetAttribute=t.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+i.length*f.packedLength+c.packedLength+6}T.pack=function(t,e,i){m.typeOf.object("value",t),m.typeOf.object("array",e),i=i??0;let r=t._positions,o=r.length;e[i++]=o;for(let t=0;t<o;++t,i+=f.packedLength)f.pack(r[t],e,i);return c.pack(t._ellipsoid,e,i),i+=c.packedLength,e[i++]=t._width,e[i++]=t._height,e[i++]=t._extrudedHeight,e[i++]=t._cornerType,e[i++]=t._granularity,e[i]=t._offsetAttribute??-1,e};var E=c.clone(c.UNIT_SPHERE),j={positions:void 0,ellipsoid:E,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};T.unpack=function(t,e,i){m.typeOf.object("array",t),e=e??0;let r=t[e++],o=Array(r);for(let i=0;i<r;++i,e+=f.packedLength)o[i]=f.unpack(t,e);let s=c.unpack(t,e,E);e+=c.packedLength;let n=t[e++],a=t[e++],l=t[e++],h=t[e++],u=t[e++],p=t[e];return y(i)?(i._positions=o,i._ellipsoid=c.clone(s,i._ellipsoid),i._width=n,i._height=a,i._extrudedHeight=l,i._cornerType=h,i._granularity=u,i._offsetAttribute=-1===p?void 0:p,i):(j.positions=o,j.width=n,j.height=a,j.extrudedHeight=l,j.cornerType=h,j.granularity=u,j.offsetAttribute=-1===p?void 0:p,new T(j))},T.createGeometry=function(e){let n=e._positions,c=e._width,d=e._ellipsoid,m=o(n=function(t,e){for(let i=0;i<t.length;i++)t[i]=e.scaleToGeodeticSurface(t[i],t[i]);return t}(n,d),f.equalsEpsilon);if(m.length<2||c<=0)return;let A=e._height,_=e._extrudedHeight,b=!g.equalsEpsilon(A,_,0,g.EPSILON2),T={ellipsoid:d,positions:m,width:c,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1},E;if(b)T.height=A,T.extrudedHeight=_,T.offsetAttribute=e._offsetAttribute,E=function(e){let o,n,a=e.ellipsoid,l=k(t.computePositions(e),e.cornerType),u=l.wallIndices,c=e.height,f=e.extrudedHeight,d=l.attributes,g=l.indices,m=d.position.values,A=m.length,_=new Float64Array(A);_.set(m);let b=new Float64Array(2*A);if(m=r.scaleToGeodeticHeight(m,c,a),_=r.scaleToGeodeticHeight(_,f,a),b.set(m),b.set(_,A),d.position.values=b,A/=3,y(e.offsetAttribute)){let t=new Uint8Array(2*A);if(e.offsetAttribute===i.TOP)t=t.fill(1,0,A);else{let r=+(e.offsetAttribute!==i.NONE);t=t.fill(r)}d.applyOffset=new h({componentDatatype:p.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let T,E=g.length,j=s.createTypedArray(b.length/3,(E+u.length)*2);j.set(g);let v=E;for(T=0;T<E;T+=2){let t=g[T],e=g[T+1];j[v++]=t+A,j[v++]=e+A}for(T=0;T<u.length;T++)n=(o=u[T])+A,j[v++]=o,j[v++]=n;return{attributes:d,indices:j}}(T);else if((E=k(t.computePositions(T),T.cornerType)).attributes.position.values=r.scaleToGeodeticHeight(E.attributes.position.values,A,d),y(e._offsetAttribute)){let t=E.attributes.position.values.length,r=+(e._offsetAttribute!==i.NONE),o=new Uint8Array(t/3).fill(r);E.attributes.applyOffset=new h({componentDatatype:p.UNSIGNED_BYTE,componentsPerAttribute:1,values:o})}let j=E.attributes,v=u.fromVertices(j.position.values,void 0,3);return new l({attributes:j,indices:E.indices,primitiveType:a.LINES,boundingSphere:v,offsetAttribute:e._offsetAttribute})};var v=function(t,e){return y(e)&&(t=T.unpack(t,e)),t._ellipsoid=c.clone(t._ellipsoid),T.createGeometry(t)};export{v as default};