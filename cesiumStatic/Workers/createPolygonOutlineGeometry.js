import{a as e}from"./chunk-UILVE4UW.js";import{a as t}from"./chunk-MCM3P7ZC.js";import{a as i}from"./chunk-3QPLNPJT.js";import{a as r}from"./chunk-UPV7RDUS.js";import"./chunk-NPKIHRIX.js";import"./chunk-MUKCYY2X.js";import{a as o}from"./chunk-MABAS5D2.js";import{a as n}from"./chunk-33M5C4LG.js";import"./chunk-X2JOWFTB.js";import{a as s,b as a}from"./chunk-TN2BIDXM.js";import"./chunk-KF74ULE7.js";import"./chunk-4EHG4BFI.js";import"./chunk-KIJM7B3H.js";import"./chunk-P44F6KLE.js";import{a as p}from"./chunk-GSMLTRAL.js";import{a as u}from"./chunk-IUX576XK.js";import{b as h,c as l,d as c}from"./chunk-UIGT6VOJ.js";import{c as f}from"./chunk-XO2FNJZK.js";import"./chunk-CM5O7VPK.js";import"./chunk-IB27QQGF.js";import"./chunk-RGFEE67W.js";import{a as m}from"./chunk-KXT7EZPS.js";import"./chunk-ZIOQOCPQ.js";import"./chunk-SY2GINYP.js";import{c as y}from"./chunk-KCR7AORG.js";import{a as d,c as g}from"./chunk-QDJTHWTA.js";import{a as _}from"./chunk-2YWR3G22.js";import{a as H,b as b}from"./chunk-HTSQLHXI.js";import{e as E}from"./chunk-JDAHMWM5.js";var k=[],P=[];function A(i){if(b.typeOf.object("options",i),b.typeOf.object("options.polygonHierarchy",i.polygonHierarchy),i.perPositionHeight&&E(i.height))throw new H("Cannot use both options.perPositionHeight and options.height");if(E(i.arcType)&&i.arcType!==t.GEODESIC&&i.arcType!==t.RHUMB)throw new H("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");let r=i.polygonHierarchy,o=i.ellipsoid??y.default,n=i.granularity??_.RADIANS_PER_DEGREE,s=i.perPositionHeight??!1,a=s&&E(i.extrudedHeight),p=i.arcType??t.GEODESIC,u=i.height??0,h=i.extrudedHeight??u;if(!a){let e=Math.max(u,h);h=Math.min(u,h),u=e}this._ellipsoid=y.clone(o),this._granularity=n,this._height=u,this._extrudedHeight=h,this._arcType=p,this._polygonHierarchy=r,this._perPositionHeight=s,this._perPositionHeightExtrude=a,this._offsetAttribute=i.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=e.computeHierarchyPackedLength(r,d)+y.packedLength+8}A.pack=function(t,i,r){return b.typeOf.object("value",t),b.defined("array",i),r=r??0,r=e.packPolygonHierarchy(t._polygonHierarchy,i,r,d),y.pack(t._ellipsoid,i,r),r+=y.packedLength,i[r++]=t._height,i[r++]=t._extrudedHeight,i[r++]=t._granularity,i[r++]=+!!t._perPositionHeightExtrude,i[r++]=+!!t._perPositionHeight,i[r++]=t._arcType,i[r++]=t._offsetAttribute??-1,i[r]=t.packedLength,i};var T=y.clone(y.UNIT_SPHERE),O={polygonHierarchy:{}};A.unpack=function(t,i,r){b.defined("array",t),i=i??0;let o=e.unpackPolygonHierarchy(t,i,d);i=o.startingIndex,delete o.startingIndex;let n=y.unpack(t,i,T);i+=y.packedLength;let s=t[i++],a=t[i++],p=t[i++],u=1===t[i++],h=1===t[i++],l=t[i++],c=t[i++],f=t[i];return E(r)||(r=new A(O)),r._polygonHierarchy=o,r._ellipsoid=y.clone(n,r._ellipsoid),r._height=s,r._extrudedHeight=a,r._granularity=p,r._perPositionHeight=h,r._perPositionHeightExtrude=u,r._arcType=l,r._offsetAttribute=-1===c?void 0:c,r.packedLength=f,r},A.fromPositions=function(e){return e=e??g.EMPTY_OBJECT,b.defined("options.positions",e.positions),new A({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},A.createGeometry=function(y){let d=y._ellipsoid,g=y._granularity,H=y._polygonHierarchy,b=y._perPositionHeight,A=y._arcType,T=e.polygonOutlinesFromHierarchy(H,!b,d);if(0===T.length)return;let O,j=[],I=_.chordLength(g,d.maximumRadius),v=y._height,L=y._extrudedHeight,w,C;if(y._perPositionHeightExtrude||!_.equalsEpsilon(v,L,0,_.EPSILON2))for(C=0;C<T.length;C++){if((O=function(r,o,f,y,d){let g=n.fromPoints(o,r).projectPointsOntoPlane(o,k);a.computeWindingOrder2D(g)===s.CLOCKWISE&&(g.reverse(),o=o.slice().reverse());let _,H,b=o.length,E=Array(b),A=0;if(y)for(_=new Float64Array(2*b*6),H=0;H<b;++H){E[H]=A/3;let e=o[H],t=o[(H+1)%b];_[A++]=e.x,_[A++]=e.y,_[A++]=e.z,_[A++]=t.x,_[A++]=t.y,_[A++]=t.z}else{let i=0;if(d===t.GEODESIC)for(H=0;H<b;H++)i+=e.subdivideLineCount(o[H],o[(H+1)%b],f);else if(d===t.RHUMB)for(H=0;H<b;H++)i+=e.subdivideRhumbLineCount(r,o[H],o[(H+1)%b],f);for(_=new Float64Array(3*i*2),H=0;H<b;++H){let i;E[H]=A/3,d===t.GEODESIC?i=e.subdivideLine(o[H],o[(H+1)%b],f,P):d===t.RHUMB&&(i=e.subdivideRhumbLine(r,o[H],o[(H+1)%b],f,P));let n=i.length;for(let e=0;e<n;++e)_[A++]=i[e]}}b=_.length/6;let T=E.length,O=(2*b+T)*2,j=p.createTypedArray(b+T,O);for(A=0,H=0;H<b;++H)j[A++]=H,j[A++]=(H+1)%b,j[A++]=H+b,j[A++]=(H+1)%b+b;for(H=0;H<T;H++){let e=E[H];j[A++]=e,j[A++]=e+b}return new i({geometry:new l({attributes:new u({position:new c({componentDatatype:m.DOUBLE,componentsPerAttribute:3,values:_})}),indices:j,primitiveType:h.LINES})})}(d,T[C],I,b,A)).geometry=e.scaleToGeodeticHeightExtruded(O.geometry,v,L,d,b),E(y._offsetAttribute)){let e=O.geometry.attributes.position.values.length/3,t=new Uint8Array(e);y._offsetAttribute===o.TOP?t=t.fill(1,0,e/2):(w=+(y._offsetAttribute!==o.NONE),t=t.fill(w)),O.geometry.attributes.applyOffset=new c({componentDatatype:m.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}j.push(O)}else for(C=0;C<T.length;C++){if((O=function(r,o,f,y,d){let g=n.fromPoints(o,r).projectPointsOntoPlane(o,k);a.computeWindingOrder2D(g)===s.CLOCKWISE&&(g.reverse(),o=o.slice().reverse());let _,H,b=o.length,E=0;if(y)for(_=new Float64Array(2*b*3),H=0;H<b;H++){let e=o[H],t=o[(H+1)%b];_[E++]=e.x,_[E++]=e.y,_[E++]=e.z,_[E++]=t.x,_[E++]=t.y,_[E++]=t.z}else{let i=0;if(d===t.GEODESIC)for(H=0;H<b;H++)i+=e.subdivideLineCount(o[H],o[(H+1)%b],f);else if(d===t.RHUMB)for(H=0;H<b;H++)i+=e.subdivideRhumbLineCount(r,o[H],o[(H+1)%b],f);for(_=new Float64Array(3*i),H=0;H<b;H++){let i;d===t.GEODESIC?i=e.subdivideLine(o[H],o[(H+1)%b],f,P):d===t.RHUMB&&(i=e.subdivideRhumbLine(r,o[H],o[(H+1)%b],f,P));let n=i.length;for(let e=0;e<n;++e)_[E++]=i[e]}}let A=2*(b=_.length/3),T=p.createTypedArray(b,A);for(E=0,H=0;H<b-1;H++)T[E++]=H,T[E++]=H+1;return T[E++]=b-1,T[E++]=0,new i({geometry:new l({attributes:new u({position:new c({componentDatatype:m.DOUBLE,componentsPerAttribute:3,values:_})}),indices:T,primitiveType:h.LINES})})}(d,T[C],I,b,A)).geometry.attributes.position.values=a.scaleToGeodeticHeight(O.geometry.attributes.position.values,v,d,!b),E(y._offsetAttribute)){let e=O.geometry.attributes.position.values.length;w=+(y._offsetAttribute!==o.NONE);let t=new Uint8Array(e/3).fill(w);O.geometry.attributes.applyOffset=new c({componentDatatype:m.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}j.push(O)}let D=r.combineInstances(j)[0],G=f.fromVertices(D.attributes.position.values);return new l({attributes:D.attributes,indices:D.indices,primitiveType:D.primitiveType,boundingSphere:G,offsetAttribute:y._offsetAttribute})};var j=function(e,t){return E(t)&&(e=A.unpack(e,t)),e._ellipsoid=y.clone(e._ellipsoid),A.createGeometry(e)};export{j as default};