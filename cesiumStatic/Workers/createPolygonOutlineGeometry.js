import{a as e}from"./chunk-LFYJT7PG.js";import{a as t}from"./chunk-XQCNGPKC.js";import{a as i}from"./chunk-SYTPJOV4.js";import{a as r}from"./chunk-YJI7JXLA.js";import"./chunk-DAX2P4DI.js";import"./chunk-RKB2XVMW.js";import{a as o}from"./chunk-IBQZCWHF.js";import{a as n}from"./chunk-SI3KZUTO.js";import"./chunk-QM7HI6IF.js";import{a as s,b as a}from"./chunk-45FW5IBC.js";import"./chunk-YM5K5MQ6.js";import"./chunk-6L5NM26F.js";import"./chunk-SPC72PTY.js";import"./chunk-HVWI7BO6.js";import{a as p}from"./chunk-KSX6TRAS.js";import{a as u}from"./chunk-GMTHOMGW.js";import{b as h,c as l,d as c}from"./chunk-BELR52CD.js";import{c as f}from"./chunk-BNHFHP3L.js";import"./chunk-4UHVCH4T.js";import"./chunk-4NDD6KRQ.js";import"./chunk-5ELDAYCN.js";import{a as m}from"./chunk-N6BI774S.js";import"./chunk-TI35VBH7.js";import"./chunk-6WLI3422.js";import{c as y}from"./chunk-ICY67TC6.js";import{a as d,c as g}from"./chunk-G2EMNOST.js";import{a as H}from"./chunk-4VFKVGYI.js";import{a as _,b as b}from"./chunk-3WJNS2B6.js";import{e as k}from"./chunk-XCN226AA.js";var E=[],P=[];function T(i){if(b.typeOf.object("options",i),b.typeOf.object("options.polygonHierarchy",i.polygonHierarchy),i.perPositionHeight&&k(i.height))throw new _("Cannot use both options.perPositionHeight and options.height");if(k(i.arcType)&&i.arcType!==t.GEODESIC&&i.arcType!==t.RHUMB)throw new _("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");let r=i.polygonHierarchy,o=i.ellipsoid??y.default,n=i.granularity??H.RADIANS_PER_DEGREE,s=i.perPositionHeight??!1,a=s&&k(i.extrudedHeight),p=i.arcType??t.GEODESIC,u=i.height??0,h=i.extrudedHeight??u;if(!a){let e=Math.max(u,h);h=Math.min(u,h),u=e}this._ellipsoid=y.clone(o),this._granularity=n,this._height=u,this._extrudedHeight=h,this._arcType=p,this._polygonHierarchy=r,this._perPositionHeight=s,this._perPositionHeightExtrude=a,this._offsetAttribute=i.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=e.computeHierarchyPackedLength(r,d)+y.packedLength+8}T.pack=function(t,i,r){return b.typeOf.object("value",t),b.defined("array",i),r=r??0,r=e.packPolygonHierarchy(t._polygonHierarchy,i,r,d),y.pack(t._ellipsoid,i,r),r+=y.packedLength,i[r++]=t._height,i[r++]=t._extrudedHeight,i[r++]=t._granularity,i[r++]=+!!t._perPositionHeightExtrude,i[r++]=+!!t._perPositionHeight,i[r++]=t._arcType,i[r++]=t._offsetAttribute??-1,i[r]=t.packedLength,i};var A=y.clone(y.UNIT_SPHERE),j={polygonHierarchy:{}};T.unpack=function(t,i,r){b.defined("array",t),i=i??0;let o=e.unpackPolygonHierarchy(t,i,d);i=o.startingIndex,delete o.startingIndex;let n=y.unpack(t,i,A);i+=y.packedLength;let s=t[i++],a=t[i++],p=t[i++],u=1===t[i++],h=1===t[i++],l=t[i++],c=t[i++],f=t[i];return k(r)||(r=new T(j)),r._polygonHierarchy=o,r._ellipsoid=y.clone(n,r._ellipsoid),r._height=s,r._extrudedHeight=a,r._granularity=p,r._perPositionHeight=h,r._perPositionHeightExtrude=u,r._arcType=l,r._offsetAttribute=-1===c?void 0:c,r.packedLength=f,r},T.fromPositions=function(e){return e=e??g.EMPTY_OBJECT,b.defined("options.positions",e.positions),new T({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},T.createGeometry=function(y){let d=y._ellipsoid,g=y._granularity,_=y._polygonHierarchy,b=y._perPositionHeight,T=y._arcType,A=e.polygonOutlinesFromHierarchy(_,!b,d);if(0===A.length)return;let j,I=[],O=H.chordLength(g,d.maximumRadius),v=y._height,L=y._extrudedHeight,C,D;if(y._perPositionHeightExtrude||!H.equalsEpsilon(v,L,0,H.EPSILON2))for(D=0;D<A.length;D++){if((j=function(r,o,f,y,d){let g=n.fromPoints(o,r).projectPointsOntoPlane(o,E);a.computeWindingOrder2D(g)===s.CLOCKWISE&&(g.reverse(),o=o.slice().reverse());let H,_,b=o.length,k=Array(b),T=0;if(y)for(H=new Float64Array(2*b*6),_=0;_<b;++_){k[_]=T/3;let e=o[_],t=o[(_+1)%b];H[T++]=e.x,H[T++]=e.y,H[T++]=e.z,H[T++]=t.x,H[T++]=t.y,H[T++]=t.z}else{let i=0;if(d===t.GEODESIC)for(_=0;_<b;_++)i+=e.subdivideLineCount(o[_],o[(_+1)%b],f);else if(d===t.RHUMB)for(_=0;_<b;_++)i+=e.subdivideRhumbLineCount(r,o[_],o[(_+1)%b],f);for(H=new Float64Array(3*i*2),_=0;_<b;++_){let i;k[_]=T/3,d===t.GEODESIC?i=e.subdivideLine(o[_],o[(_+1)%b],f,P):d===t.RHUMB&&(i=e.subdivideRhumbLine(r,o[_],o[(_+1)%b],f,P));let n=i.length;for(let e=0;e<n;++e)H[T++]=i[e]}}b=H.length/6;let A=k.length,j=(2*b+A)*2,I=p.createTypedArray(b+A,j);for(T=0,_=0;_<b;++_)I[T++]=_,I[T++]=(_+1)%b,I[T++]=_+b,I[T++]=(_+1)%b+b;for(_=0;_<A;_++){let e=k[_];I[T++]=e,I[T++]=e+b}return new i({geometry:new l({attributes:new u({position:new c({componentDatatype:m.DOUBLE,componentsPerAttribute:3,values:H})}),indices:I,primitiveType:h.LINES})})}(d,A[D],O,b,T)).geometry=e.scaleToGeodeticHeightExtruded(j.geometry,v,L,d,b),k(y._offsetAttribute)){let e=j.geometry.attributes.position.values.length/3,t=new Uint8Array(e);y._offsetAttribute===o.TOP?t=t.fill(1,0,e/2):(C=+(y._offsetAttribute!==o.NONE),t=t.fill(C)),j.geometry.attributes.applyOffset=new c({componentDatatype:m.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}I.push(j)}else for(D=0;D<A.length;D++){if((j=function(r,o,f,y,d){let g=n.fromPoints(o,r).projectPointsOntoPlane(o,E);a.computeWindingOrder2D(g)===s.CLOCKWISE&&(g.reverse(),o=o.slice().reverse());let H,_,b=o.length,k=0;if(y)for(H=new Float64Array(2*b*3),_=0;_<b;_++){let e=o[_],t=o[(_+1)%b];H[k++]=e.x,H[k++]=e.y,H[k++]=e.z,H[k++]=t.x,H[k++]=t.y,H[k++]=t.z}else{let i=0;if(d===t.GEODESIC)for(_=0;_<b;_++)i+=e.subdivideLineCount(o[_],o[(_+1)%b],f);else if(d===t.RHUMB)for(_=0;_<b;_++)i+=e.subdivideRhumbLineCount(r,o[_],o[(_+1)%b],f);for(H=new Float64Array(3*i),_=0;_<b;_++){let i;d===t.GEODESIC?i=e.subdivideLine(o[_],o[(_+1)%b],f,P):d===t.RHUMB&&(i=e.subdivideRhumbLine(r,o[_],o[(_+1)%b],f,P));let n=i.length;for(let e=0;e<n;++e)H[k++]=i[e]}}let T=2*(b=H.length/3),A=p.createTypedArray(b,T);for(k=0,_=0;_<b-1;_++)A[k++]=_,A[k++]=_+1;return A[k++]=b-1,A[k++]=0,new i({geometry:new l({attributes:new u({position:new c({componentDatatype:m.DOUBLE,componentsPerAttribute:3,values:H})}),indices:A,primitiveType:h.LINES})})}(d,A[D],O,b,T)).geometry.attributes.position.values=a.scaleToGeodeticHeight(j.geometry.attributes.position.values,v,d,!b),k(y._offsetAttribute)){let e=j.geometry.attributes.position.values.length;C=+(y._offsetAttribute!==o.NONE);let t=new Uint8Array(e/3).fill(C);j.geometry.attributes.applyOffset=new c({componentDatatype:m.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}I.push(j)}let S=r.combineInstances(I)[0],w=f.fromVertices(S.attributes.position.values);return new l({attributes:S.attributes,indices:S.indices,primitiveType:S.primitiveType,boundingSphere:w,offsetAttribute:y._offsetAttribute})};var I=function(e,t){return k(t)&&(e=T.unpack(e,t)),e._ellipsoid=y.clone(e._ellipsoid),T.createGeometry(e)};export{I as default};