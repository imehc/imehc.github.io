import{a as t}from"./chunk-R47RPQGH.js";import{a as e}from"./chunk-IBQZCWHF.js";import{b as i}from"./chunk-45FW5IBC.js";import"./chunk-6L5NM26F.js";import{a as r}from"./chunk-KSX6TRAS.js";import{a as o}from"./chunk-GMTHOMGW.js";import{b as n,c as a,d as s}from"./chunk-BELR52CD.js";import{c as l}from"./chunk-BNHFHP3L.js";import"./chunk-4UHVCH4T.js";import{j as u}from"./chunk-4NDD6KRQ.js";import"./chunk-5ELDAYCN.js";import{a as c}from"./chunk-N6BI774S.js";import"./chunk-TI35VBH7.js";import"./chunk-6WLI3422.js";import{a as h,c as p}from"./chunk-ICY67TC6.js";import{a as f,c as g}from"./chunk-G2EMNOST.js";import{a as d}from"./chunk-4VFKVGYI.js";import{a as m}from"./chunk-3WJNS2B6.js";import{e as _}from"./chunk-XCN226AA.js";var k=new l,b=new l,w=new f,y=new u;function A(e,i){let l=e._ellipsoid,u=i.height,h=i.width,p=i.northCap,f=i.southCap,g=u,d=2,m=0,_=4;p&&(d-=1,g-=1,m+=1,_-=2),f&&(d-=1,g-=1,m+=1,_-=2);let k=new Float64Array(3*(m+=d*h+2*g-_)),b=0,y=0,A;if(p)t.computePosition(i,l,!1,y,0,w),k[b++]=w.x,k[b++]=w.y,k[b++]=w.z;else for(A=0;A<h;A++)t.computePosition(i,l,!1,y,A,w),k[b++]=w.x,k[b++]=w.y,k[b++]=w.z;for(A=h-1,y=1;y<u;y++)t.computePosition(i,l,!1,y,A,w),k[b++]=w.x,k[b++]=w.y,k[b++]=w.z;if(y=u-1,!f)for(A=h-2;A>=0;A--)t.computePosition(i,l,!1,y,A,w),k[b++]=w.x,k[b++]=w.y,k[b++]=w.z;for(A=0,y=u-2;y>0;y--)t.computePosition(i,l,!1,y,A,w),k[b++]=w.x,k[b++]=w.y,k[b++]=w.z;let E=k.length/3*2,v=r.createTypedArray(k.length/3,E),H=0;for(let t=0;t<k.length/3-1;t++)v[H++]=t,v[H++]=t+1;v[H++]=k.length/3-1,v[H++]=0;let N=new a({attributes:new o,primitiveType:n.LINES});return N.attributes.position=new s({componentDatatype:c.DOUBLE,componentsPerAttribute:3,values:k}),N.indices=v,N}function E(t){let e=(t=t??g.EMPTY_OBJECT).rectangle,i=t.granularity??d.RADIANS_PER_DEGREE,r=t.ellipsoid??p.default,o=t.rotation??0;if(!_(e))throw new m("rectangle is required.");if(u._validate(e),e.north<e.south)throw new m("options.rectangle.north must be greater than options.rectangle.south");let n=t.height??0,a=t.extrudedHeight??n;this._rectangle=u.clone(e),this._granularity=i,this._ellipsoid=r,this._surfaceHeight=Math.max(n,a),this._rotation=o,this._extrudedHeight=Math.min(n,a),this._offsetAttribute=t.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}E.packedLength=u.packedLength+p.packedLength+5,E.pack=function(t,e,i){if(!_(t))throw new m("value is required");if(!_(e))throw new m("array is required");return i=i??0,u.pack(t._rectangle,e,i),i+=u.packedLength,p.pack(t._ellipsoid,e,i),i+=p.packedLength,e[i++]=t._granularity,e[i++]=t._surfaceHeight,e[i++]=t._rotation,e[i++]=t._extrudedHeight,e[i]=t._offsetAttribute??-1,e};var v=new u,H=p.clone(p.UNIT_SPHERE),N={rectangle:v,ellipsoid:H,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};E.unpack=function(t,e,i){if(!_(t))throw new m("array is required");e=e??0;let r=u.unpack(t,e,v);e+=u.packedLength;let o=p.unpack(t,e,H);e+=p.packedLength;let n=t[e++],a=t[e++],s=t[e++],l=t[e++],c=t[e];return _(i)?(i._rectangle=u.clone(r,i._rectangle),i._ellipsoid=p.clone(o,i._ellipsoid),i._surfaceHeight=a,i._rotation=s,i._extrudedHeight=l,i._offsetAttribute=-1===c?void 0:c,i):(N.granularity=n,N.height=a,N.rotation=s,N.extrudedHeight=l,N.offsetAttribute=-1===c?void 0:c,new E(N))};var j=new h;E.createGeometry=function(o){let u=o._rectangle,h=o._ellipsoid,p=t.computeOptions(u,o._granularity,o._rotation,0,y,j),f,g;if(d.equalsEpsilon(u.north,u.south,d.EPSILON10)||d.equalsEpsilon(u.east,u.west,d.EPSILON10))return;let m=o._surfaceHeight,w=o._extrudedHeight,E;if(d.equalsEpsilon(m,w,0,d.EPSILON2)){if((f=A(o,p)).attributes.position.values=i.scaleToGeodeticHeight(f.attributes.position.values,m,h,!1),_(o._offsetAttribute)){let t=f.attributes.position.values.length;E=+(o._offsetAttribute!==e.NONE);let i=new Uint8Array(t/3).fill(E);f.attributes.applyOffset=new s({componentDatatype:c.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}g=l.fromRectangle3D(u,h,m)}else{if(f=function(t,e){let o,n=t._surfaceHeight,a=t._extrudedHeight,s=t._ellipsoid,l=A(t,e),u=e.height,c=e.width,h=i.scaleToGeodeticHeight(l.attributes.position.values,n,s,!1),p=h.length,f=new Float64Array(2*p);f.set(h);let g=i.scaleToGeodeticHeight(l.attributes.position.values,a,s);f.set(g,p),l.attributes.position.values=f;let d=e.northCap,m=e.southCap,_=4;d&&(_-=1),m&&(_-=1);let k=(f.length/3+_)*2,b=r.createTypedArray(f.length/3,k);p=f.length/6;let w=0;for(let t=0;t<p-1;t++)b[w++]=t,b[w++]=t+1,b[w++]=t+p,b[w++]=t+p+1;if(b[w++]=p-1,b[w++]=0,b[w++]=p+p-1,b[w++]=p,b[w++]=0,b[w++]=p,d)o=u-1;else{let t=c-1;b[w++]=t,b[w++]=t+p,o=c+u-2}if(b[w++]=o,b[w++]=o+p,!m){let t=c+o-1;b[w++]=t,b[w]=t+p}return l.indices=b,l}(o,p),_(o._offsetAttribute)){let t=f.attributes.position.values.length/3,i=new Uint8Array(t);o._offsetAttribute===e.TOP?i=i.fill(1,0,t/2):(E=+(o._offsetAttribute!==e.NONE),i=i.fill(E)),f.attributes.applyOffset=new s({componentDatatype:c.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}let t=l.fromRectangle3D(u,h,m,b),n=l.fromRectangle3D(u,h,w,k);g=l.union(t,n)}return new a({attributes:f.attributes,indices:f.indices,primitiveType:n.LINES,boundingSphere:g,offsetAttribute:o._offsetAttribute})};var T=function(t,e){return _(e)&&(t=E.unpack(t,e)),t._ellipsoid=p.clone(t._ellipsoid),t._rectangle=u.clone(t._rectangle),E.createGeometry(t)};export{T as default};