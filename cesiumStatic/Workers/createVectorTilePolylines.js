import{a as e}from"./chunk-ITDFUUP5.js";import{a as r}from"./chunk-DAX2P4DI.js";import{a as t}from"./chunk-KSX6TRAS.js";import{c as n,j as a}from"./chunk-4NDD6KRQ.js";import"./chunk-5ELDAYCN.js";import"./chunk-N6BI774S.js";import"./chunk-TI35VBH7.js";import"./chunk-6WLI3422.js";import{a as o,c as s}from"./chunk-ICY67TC6.js";import{a as u}from"./chunk-G2EMNOST.js";import{a as f}from"./chunk-4VFKVGYI.js";import"./chunk-3WJNS2B6.js";import"./chunk-XCN226AA.js";var i=new o,c=new u,p=function(e,t,n,a,s){let p=e.length/3,l=e.subarray(0,p),k=e.subarray(p,2*p),h=e.subarray(2*p,3*p);r.zigZagDeltaDecode(l,k,h);let d=new Float64Array(e.length);for(let e=0;e<p;++e){let r=l[e],p=k[e],m=h[e],b=f.lerp(t.west,t.east,r/32767),w=f.lerp(t.south,t.north,p/32767),A=f.lerp(n,a,m/32767),y=o.fromRadians(b,w,A,i),j=s.cartographicToCartesian(y,c);u.pack(j,d,3*e)}return d},l=new a,k=new s,h=new u,d={min:void 0,max:void 0},m=new u,b=new u,w=new u,A=new u,y=new u,j=e(function(e,r){var o;let f,i=new Uint16Array(e.positions),c=new Uint16Array(e.widths),j=new Uint32Array(e.counts),I=new Uint16Array(e.batchIds);o=new Float64Array(o=e.packedBuffer),f=0,d.min=o[f++],d.max=o[f++],a.unpack(o,f,l),f+=a.packedLength,s.unpack(o,f,k),f+=s.packedLength,u.unpack(o,f,h);let D=p(i,l,d.min,d.max,k),N=D.length/3,T=4*N-4,g=new Float32Array(3*T),U=new Float32Array(3*T),E=new Float32Array(3*T),P=new Float32Array(2*T),S=new Uint16Array(T),F=0,x=0,v=0,B,C=0,L=j.length;for(B=0;B<L;++B){let e=j[B],r=c[B],t=I[B];for(let n=0;n<e;++n){let a;if(0===n){let e=u.unpack(D,3*C,m),r=u.unpack(D,(C+1)*3,b);a=u.subtract(e,r,w),u.add(e,a,a)}else a=u.unpack(D,(C+n-1)*3,w);let o=u.unpack(D,(C+n)*3,A),s;if(n===e-1){let r=u.unpack(D,(C+e-1)*3,m),t=u.unpack(D,(C+e-2)*3,b);s=u.subtract(r,t,y),u.add(r,s,s)}else s=u.unpack(D,(C+n+1)*3,y);u.subtract(a,h,a),u.subtract(o,h,o),u.subtract(s,h,s);let f=2*(0===n),i=n===e-1?2:4;for(let e=f;e<i;++e){u.pack(o,g,F),u.pack(a,U,F),u.pack(s,E,F),F+=3;let n=e-2<0?-1:1;P[x++]=e%2*2-1,P[x++]=n*r,S[v++]=t}}C+=e}let R=t.createTypedArray(T,6*N-6),G=0,Y=0;for(L=N-1,B=0;B<L;++B)R[Y++]=G,R[Y++]=G+2,R[Y++]=G+1,R[Y++]=G+1,R[Y++]=G+2,R[Y++]=G+3,G+=4;r.push(g.buffer,U.buffer,E.buffer),r.push(P.buffer,S.buffer,R.buffer);let _={indexDatatype:2===R.BYTES_PER_ELEMENT?t.UNSIGNED_SHORT:t.UNSIGNED_INT,currentPositions:g.buffer,previousPositions:U.buffer,nextPositions:E.buffer,expandAndWidth:P.buffer,batchIds:S.buffer,indices:R.buffer};if(e.keepDecodedPositions){let e=function(e){let r=e.length,t=new Uint32Array(r+1),n=0;for(let a=0;a<r;++a)t[a]=n,n+=e[a];return t[r]=n,t}(j);r.push(D.buffer,e.buffer),_=n(_,{decodedPositions:D.buffer,decodedPositionOffsets:e.buffer})}return _});export{j as default};