import{a as e}from"./chunk-ILB4KG4E.js";import{a as r}from"./chunk-NPKIHRIX.js";import{a as t}from"./chunk-GSMLTRAL.js";import{c as n,j as a}from"./chunk-IB27QQGF.js";import"./chunk-RGFEE67W.js";import"./chunk-KXT7EZPS.js";import"./chunk-ZIOQOCPQ.js";import"./chunk-SY2GINYP.js";import{a as o,c as s}from"./chunk-KCR7AORG.js";import{a as u}from"./chunk-QDJTHWTA.js";import{a as f}from"./chunk-2YWR3G22.js";import"./chunk-HTSQLHXI.js";import"./chunk-JDAHMWM5.js";var i=new o,c=new u,p=function(e,t,n,a,s){let p=e.length/3,l=e.subarray(0,p),k=e.subarray(p,2*p),h=e.subarray(2*p,3*p);r.zigZagDeltaDecode(l,k,h);let d=new Float64Array(e.length);for(let e=0;e<p;++e){let r=l[e],p=k[e],m=h[e],b=f.lerp(t.west,t.east,r/32767),w=f.lerp(t.south,t.north,p/32767),y=f.lerp(n,a,m/32767),A=o.fromRadians(b,w,y,i),j=s.cartographicToCartesian(A,c);u.pack(j,d,3*e)}return d},l=new a,k=new s,h=new u,d={min:void 0,max:void 0},m=new u,b=new u,w=new u,y=new u,A=new u,j=e(function(e,r){var o;let f,i=new Uint16Array(e.positions),c=new Uint16Array(e.widths),j=new Uint32Array(e.counts),I=new Uint16Array(e.batchIds);o=new Float64Array(o=e.packedBuffer),f=0,d.min=o[f++],d.max=o[f++],a.unpack(o,f,l),f+=a.packedLength,s.unpack(o,f,k),f+=s.packedLength,u.unpack(o,f,h);let E=p(i,l,d.min,d.max,k),P=E.length/3,T=4*P-4,g=new Float32Array(3*T),G=new Float32Array(3*T),R=new Float32Array(3*T),D=new Float32Array(2*T),F=new Uint16Array(T),N=0,S=0,U=0,x,L=0,H=j.length;for(x=0;x<H;++x){let e=j[x],r=c[x],t=I[x];for(let n=0;n<e;++n){let a;if(0===n){let e=u.unpack(E,3*L,m),r=u.unpack(E,(L+1)*3,b);a=u.subtract(e,r,w),u.add(e,a,a)}else a=u.unpack(E,(L+n-1)*3,w);let o=u.unpack(E,(L+n)*3,y),s;if(n===e-1){let r=u.unpack(E,(L+e-1)*3,m),t=u.unpack(E,(L+e-2)*3,b);s=u.subtract(r,t,A),u.add(r,s,s)}else s=u.unpack(E,(L+n+1)*3,A);u.subtract(a,h,a),u.subtract(o,h,o),u.subtract(s,h,s);let f=2*(0===n),i=n===e-1?2:4;for(let e=f;e<i;++e){u.pack(o,g,N),u.pack(a,G,N),u.pack(s,R,N),N+=3;let n=e-2<0?-1:1;D[S++]=e%2*2-1,D[S++]=n*r,F[U++]=t}}L+=e}let Q=t.createTypedArray(T,6*P-6),v=0,O=0;for(H=P-1,x=0;x<H;++x)Q[O++]=v,Q[O++]=v+2,Q[O++]=v+1,Q[O++]=v+1,Q[O++]=v+2,Q[O++]=v+3,v+=4;r.push(g.buffer,G.buffer,R.buffer),r.push(D.buffer,F.buffer,Q.buffer);let W={indexDatatype:2===Q.BYTES_PER_ELEMENT?t.UNSIGNED_SHORT:t.UNSIGNED_INT,currentPositions:g.buffer,previousPositions:G.buffer,nextPositions:R.buffer,expandAndWidth:D.buffer,batchIds:F.buffer,indices:Q.buffer};if(e.keepDecodedPositions){let e=function(e){let r=e.length,t=new Uint32Array(r+1),n=0;for(let a=0;a<r;++a)t[a]=n,n+=e[a];return t[r]=n,t}(j);r.push(E.buffer,e.buffer),W=n(W,{decodedPositions:E.buffer,decodedPositionOffsets:e.buffer})}return W});export{j as default};